# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23805 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 0.122612ms GPU, 0.130241ms CPU, 0.50s total GPU, 0.74s total wall, 4080x 
Run:  [2/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=64 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 0.124687ms GPU, 0.133373ms CPU, 0.50s total GPU, 0.72s total wall, 4016x 
Run:  [3/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=128 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 0.164746ms GPU, 0.172661ms CPU, 0.50s total GPU, 0.67s total wall, 3040x 
Run:  [4/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=256 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 0.285266ms GPU, 0.292859ms CPU, 0.50s total GPU, 0.59s total wall, 1753x 
Run:  [5/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=512 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 0.589340ms GPU, 0.598033ms CPU, 0.50s total GPU, 0.55s total wall, 849x 
Run:  [6/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=1024 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 1.210383ms GPU, 1.219206ms CPU, 0.50s total GPU, 0.53s total wall, 416x 
Run:  [7/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=2048 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 2.437689ms GPU, 2.462720ms CPU, 1.72s total GPU, 1.77s total wall, 704x 
Run:  [8/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 4.921545ms GPU, 4.929177ms CPU, 0.50s total GPU, 0.51s total wall, 102x 
Run:  [9/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=8192 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 9.865517ms GPU, 9.872166ms CPU, 0.50s total GPU, 0.51s total wall, 51x 
Run:  [10/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=16384 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Pass: Cold: 19.773794ms GPU, 19.780713ms CPU, 0.51s total GPU, 0.52s total wall, 26x 
Run:  [11/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32768 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
Run:  [12/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=65536 num_heads=32 num_kv_heads=32 head_size=96 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | page_size |    Read     |    Write    | Samples |  CPU Time  | Noise  |  GPU Time  | Noise  | GlobalMem BW | BWUtil |
|----------|---------|-----------|--------------|-----------|-----------|-------------|-------------|---------|------------|--------|------------|--------|--------------|--------|
|       64 |      32 |        32 |           32 |        96 |       256 |  24.375 MiB | 384.000 KiB |   4080x | 130.241 us | 30.82% | 122.612 us | 14.04% | 211.662 GB/s | 22.68% |
|       64 |      64 |        32 |           32 |        96 |       256 |  48.375 MiB | 384.000 KiB |   4016x | 133.373 us | 45.35% | 124.687 us |  0.60% | 409.970 GB/s | 43.94% |
|       64 |     128 |        32 |           32 |        96 |       256 |  96.375 MiB | 384.000 KiB |   3040x | 172.661 us | 30.46% | 164.746 us |  0.52% | 615.793 GB/s | 65.99% |
|       64 |     256 |        32 |           32 |        96 |       256 | 192.375 MiB | 384.000 KiB |   1753x | 292.859 us | 14.01% | 285.266 us |  0.41% | 708.507 GB/s | 75.93% |
|       64 |     512 |        32 |           32 |        96 |       256 | 384.375 MiB | 384.000 KiB |    849x | 598.033 us |  8.67% | 589.340 us |  0.32% | 684.561 GB/s | 73.36% |
|       64 |    1024 |        32 |           32 |        96 |       256 | 768.375 MiB | 384.000 KiB |    416x |   1.219 ms |  3.61% |   1.210 ms |  0.69% | 665.982 GB/s | 71.37% |
|       64 |    2048 |        32 |           32 |        96 |       256 |   1.500 GiB | 384.000 KiB |    704x |   2.463 ms | 14.12% |   2.438 ms |  0.66% | 661.036 GB/s | 70.84% |
|       64 |    4096 |        32 |           32 |        96 |       256 |   3.000 GiB | 384.000 KiB |    102x |   4.929 ms |  0.33% |   4.922 ms |  0.23% | 654.675 GB/s | 70.16% |
|       64 |    8192 |        32 |           32 |        96 |       256 |   6.000 GiB | 384.000 KiB |     51x |   9.872 ms |  0.11% |   9.866 ms |  0.08% | 653.107 GB/s | 69.99% |
|       64 |   16384 |        32 |           32 |        96 |       256 |  12.000 GiB | 384.000 KiB |     26x |  19.781 ms |  0.07% |  19.774 ms |  0.06% | 651.655 GB/s | 69.84% |
