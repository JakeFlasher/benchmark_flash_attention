# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23805 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.048044ms GPU, 0.055233ms CPU, 0.50s total GPU, 1.07s total wall, 10416x 
Run:  [2/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=64 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.052546ms GPU, 0.059746ms CPU, 0.50s total GPU, 1.00s total wall, 9520x 
Run:  [3/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=128 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.071672ms GPU, 0.078311ms CPU, 0.50s total GPU, 0.86s total wall, 6992x 
Run:  [4/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=256 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.114139ms GPU, 0.121422ms CPU, 0.50s total GPU, 0.71s total wall, 4384x 
Run:  [5/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=512 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.193475ms GPU, 0.200825ms CPU, 0.50s total GPU, 0.63s total wall, 2592x 
Run:  [6/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=1024 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.347112ms GPU, 0.360893ms CPU, 0.57s total GPU, 0.66s total wall, 1648x 
Run:  [7/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=2048 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.650797ms GPU, 0.657542ms CPU, 0.50s total GPU, 0.54s total wall, 769x 
Run:  [8/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=4096 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 1.260890ms GPU, 1.269517ms CPU, 0.50s total GPU, 0.52s total wall, 397x 
Run:  [9/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=8192 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 2.484199ms GPU, 2.491379ms CPU, 0.50s total GPU, 0.51s total wall, 202x 
Run:  [10/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=16384 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 4.930962ms GPU, 4.938799ms CPU, 0.50s total GPU, 0.51s total wall, 102x 
Run:  [11/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32768 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
Run:  [12/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=65536 num_heads=64 num_kv_heads=8 head_size=128 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | page_size |    Read     |   Write   | Samples |  CPU Time  | Noise  |  GPU Time  | Noise  | GlobalMem BW | BWUtil |
|----------|---------|-----------|--------------|-----------|-----------|-------------|-----------|---------|------------|--------|------------|--------|--------------|--------|
|       64 |      32 |        64 |            8 |       128 |       256 |   9.000 MiB | 1.000 MiB |  10416x |  55.233 us | 62.05% |  48.044 us | 12.69% | 218.252 GB/s | 23.39% |
|       64 |      64 |        64 |            8 |       128 |       256 |  17.000 MiB | 1.000 MiB |   9520x |  59.746 us | 54.14% |  52.546 us |  1.60% | 359.200 GB/s | 38.49% |
|       64 |     128 |        64 |            8 |       128 |       256 |  33.000 MiB | 1.000 MiB |   6992x |  78.311 us |  9.35% |  71.672 us |  1.42% | 497.425 GB/s | 53.31% |
|       64 |     256 |        64 |            8 |       128 |       256 |  65.000 MiB | 1.000 MiB |   4384x | 121.422 us | 29.10% | 114.139 us |  0.94% | 606.332 GB/s | 64.98% |
|       64 |     512 |        64 |            8 |       128 |       256 | 129.000 MiB | 1.000 MiB |   2592x | 200.825 us | 18.06% | 193.475 us |  0.78% | 704.562 GB/s | 75.51% |
|       64 |    1024 |        64 |            8 |       128 |       256 | 257.000 MiB | 1.000 MiB |   1648x | 360.893 us | 71.91% | 347.112 us |  0.69% | 779.382 GB/s | 83.52% |
|       64 |    2048 |        64 |            8 |       128 |       256 | 513.000 MiB | 1.000 MiB |    769x | 657.542 us |  1.09% | 650.797 us |  0.33% | 828.167 GB/s | 88.75% |
|       64 |    4096 |        64 |            8 |       128 |       256 |   1.001 GiB | 1.000 MiB |    397x |   1.270 ms |  3.00% |   1.261 ms |  0.26% | 853.238 GB/s | 91.44% |
|       64 |    8192 |        64 |            8 |       128 |       256 |   2.001 GiB | 1.000 MiB |    202x |   2.491 ms |  0.37% |   2.484 ms |  0.15% | 865.301 GB/s | 92.73% |
|       64 |   16384 |        64 |            8 |       128 |       256 |   4.001 GiB | 1.000 MiB |    102x |   4.939 ms |  0.29% |   4.931 ms |  0.11% | 871.446 GB/s | 93.39% |
