===== VARIABLE LENGTH ATTENTION BENCHMARKS =====
Testing variable length sequences...
Testing sliding window with variable length...
Profiling: varlen/window-128
==PROF== Connected to process 12473 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23647 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.40s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.40s) before accumulating min_samples (3 < 10)
Pass: Cold: 6131.653320ms GPU, 6131.662467ms CPU, 18.39s total GPU, 18.40s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5580.668783ms GPU, 16.74s total GPU, 16.74s total wall, 3x
Run:  [2/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.12s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.12s) before accumulating min_samples (3 < 10)
Pass: Cold: 5705.331706ms GPU, 5705.341702ms CPU, 17.12s total GPU, 17.12s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.25s) before accumulating min_samples (2 < 10)
Pass: Batch: 8624.518799ms GPU, 17.25s total GPU, 17.25s total wall, 2x
==PROF== Disconnected from process 12473
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.132 s |  inf% |  6.132 s |  inf% | 5.344K | 109.447 MB/s |  0.01% |      3x |   5.581 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.705 s |  inf% |  5.705 s |  inf% | 5.743K | 117.625 MB/s |  0.01% |      2x |   8.625 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/window-128.ncu-rep
Profiling: varlen/window-512
==PROF== Connected to process 12681 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23649 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.00s) before accumulating min_samples (4 < 10)
Pass: Cold: 4999.907837ms GPU, 4999.918654ms CPU, 20.00s total GPU, 20.00s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.87s) before accumulating min_samples (3 < 10)
Pass: Batch: 6290.148926ms GPU, 18.87s total GPU, 18.87s total wall, 3x
Run:  [2/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.98s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.98s) before accumulating min_samples (3 < 10)
Pass: Cold: 6661.307780ms GPU, 6661.318840ms CPU, 19.98s total GPU, 19.98s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.73s) before accumulating min_samples (3 < 10)
Pass: Batch: 5242.904948ms GPU, 15.73s total GPU, 15.73s total wall, 3x
==PROF== Disconnected from process 12681
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    4096 |        32 |            8 |       128 |         512 |          512 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  5.000 s |  inf% |  5.000 s |  inf% | 6.554K | 134.220 MB/s |  0.01% |      3x |   6.290 s |
|        8 |    4096 |        32 |            8 |       128 |         512 |          512 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.661 s |  inf% |  6.661 s |  inf% | 4.919K | 100.744 MB/s |  0.01% |      3x |   5.243 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/window-512.ncu-rep
Profiling: varlen/window-1024
==PROF== Connected to process 12742 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23651 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.01s) before accumulating min_samples (4 < 10)
Pass: Cold: 4502.178345ms GPU, 4502.188664ms CPU, 18.01s total GPU, 18.01s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.65s) before accumulating min_samples (3 < 10)
Pass: Batch: 6217.672689ms GPU, 18.65s total GPU, 18.65s total wall, 3x
Run:  [2/2] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.50s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.50s) before accumulating min_samples (4 < 10)
Pass: Cold: 5125.750000ms GPU, 5125.760108ms CPU, 20.50s total GPU, 20.50s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.50s) before accumulating min_samples (3 < 10)
Pass: Batch: 6167.835124ms GPU, 18.50s total GPU, 18.50s total wall, 3x
==PROF== Disconnected from process 12742
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  4.502 s |  inf% |  4.502 s |  inf% | 7.278K | 149.059 MB/s |  0.02% |      3x |   6.218 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  5.126 s |  inf% |  5.126 s |  inf% | 6.393K | 130.925 MB/s |  0.01% |      3x |   6.168 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/window-1024.ncu-rep
Testing non-causal attention with variable length...
Profiling: varlen/non-causal
==PROF== Connected to process 12931 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23653 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.21s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.21s) before accumulating min_samples (3 < 10)
Pass: Cold: 6403.949870ms GPU, 6403.961042ms CPU, 19.21s total GPU, 19.21s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.58s) before accumulating min_samples (3 < 10)
Pass: Batch: 5527.672201ms GPU, 16.58s total GPU, 16.58s total wall, 3x
Run:  [2/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.55s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.55s) before accumulating min_samples (3 < 10)
Pass: Cold: 6181.920247ms GPU, 6181.931194ms CPU, 18.55s total GPU, 18.55s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.91s) before accumulating min_samples (3 < 10)
Pass: Batch: 6304.963867ms GPU, 18.91s total GPU, 18.91s total wall, 3x
Run:  [3/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.33s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.33s) before accumulating min_samples (3 < 10)
Pass: Cold: 5442.101237ms GPU, 5442.112327ms CPU, 16.33s total GPU, 16.33s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 6808.598796ms GPU, 20.43s total GPU, 20.43s total wall, 3x
Run:  [4/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.56s) before accumulating min_samples (3 < 10)
Pass: Cold: 5853.677246ms GPU, 5853.689646ms CPU, 17.56s total GPU, 17.56s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.21s) before accumulating min_samples (3 < 10)
Pass: Batch: 6402.352214ms GPU, 19.21s total GPU, 19.21s total wall, 3x
Run:  [5/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.22s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.22s) before accumulating min_samples (4 < 10)
Pass: Cold: 5054.411011ms GPU, 5054.421334ms CPU, 20.22s total GPU, 20.22s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.05s) before accumulating min_samples (3 < 10)
Pass: Batch: 5683.034505ms GPU, 17.05s total GPU, 17.05s total wall, 3x
Run:  [6/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.18s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.18s) before accumulating min_samples (3 < 10)
Pass: Cold: 5727.254232ms GPU, 5727.265182ms CPU, 17.18s total GPU, 17.18s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 120: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.35s) before accumulating min_samples (3 < 10)
Pass: Batch: 5782.827637ms GPU, 17.35s total GPU, 17.35s total wall, 3x
Run:  [7/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.34s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.34s) before accumulating min_samples (3 < 10)
Pass: Cold: 6779.853516ms GPU, 6779.867155ms CPU, 20.34s total GPU, 20.34s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.14s) before accumulating min_samples (3 < 10)
Pass: Batch: 6712.338216ms GPU, 20.14s total GPU, 20.14s total wall, 3x
Run:  [8/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.38s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.38s) before accumulating min_samples (3 < 10)
Pass: Cold: 5792.659668ms GPU, 5792.670704ms CPU, 17.38s total GPU, 17.38s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.32s) before accumulating min_samples (3 < 10)
Pass: Batch: 5773.504069ms GPU, 17.32s total GPU, 17.32s total wall, 3x
Run:  [9/9] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 176: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.50s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.50s) before accumulating min_samples (3 < 10)
Pass: Cold: 5834.843099ms GPU, 5834.855095ms CPU, 17.50s total GPU, 17.50s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 179: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.80s) before accumulating min_samples (2 < 10)
Pass: Batch: 7901.157471ms GPU, 15.80s total GPU, 15.80s total wall, 2x
==PROF== Disconnected from process 12931
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.404 s |  inf% |  6.404 s |  inf% | 5.117K | 104.793 MB/s |  0.01% |      3x |   5.528 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.182 s |  inf% |  6.182 s |  inf% | 5.301K | 108.557 MB/s |  0.01% |      3x |   6.305 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.442 s |  inf% |  5.442 s |  inf% | 6.021K | 123.314 MB/s |  0.01% |      3x |   6.809 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.854 s |  inf% |  5.854 s |  inf% | 5.598K | 114.644 MB/s |  0.01% |      3x |   6.402 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  5.054 s |  inf% |  5.054 s |  inf% | 6.483K | 132.773 MB/s |  0.01% |      3x |   5.683 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.727 s |  inf% |  5.727 s |  inf% | 5.721K | 117.175 MB/s |  0.01% |      3x |   5.783 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.780 s |  inf% |  6.780 s |  inf% | 4.833K |  98.983 MB/s |  0.01% |      3x |   6.712 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.793 s |  inf% |  5.793 s |  inf% | 5.657K | 115.852 MB/s |  0.01% |      3x |   5.774 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.835 s |  inf% |  5.835 s |  inf% | 5.616K | 115.014 MB/s |  0.01% |      2x |   7.901 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/non-causal.ncu-rep
Profiling: varlen/typical-mix
==PROF== Connected to process 12965 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23655 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.06s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.06s) before accumulating min_samples (4 < 10)
Pass: Cold: 5514.201050ms GPU, 5514.212562ms CPU, 22.06s total GPU, 22.06s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5247.881185ms GPU, 15.74s total GPU, 15.74s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.01s) before accumulating min_samples (4 < 10)
Pass: Cold: 5003.371887ms GPU, 5003.383138ms CPU, 20.01s total GPU, 20.01s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.32s) before accumulating min_samples (3 < 10)
Pass: Batch: 5772.826660ms GPU, 17.32s total GPU, 17.32s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.94s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.94s) before accumulating min_samples (3 < 10)
Pass: Cold: 6981.427083ms GPU, 6981.439135ms CPU, 20.94s total GPU, 20.94s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.47s) before accumulating min_samples (3 < 10)
Pass: Batch: 6489.450195ms GPU, 19.47s total GPU, 19.47s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.15s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.15s) before accumulating min_samples (3 < 10)
Pass: Cold: 5382.728353ms GPU, 5382.743579ms CPU, 16.15s total GPU, 16.15s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.06s) before accumulating min_samples (3 < 10)
Pass: Batch: 6352.797852ms GPU, 19.06s total GPU, 19.06s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.10s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.10s) before accumulating min_samples (3 < 10)
Pass: Cold: 6365.028320ms GPU, 6365.038797ms CPU, 19.10s total GPU, 19.10s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.40s) before accumulating min_samples (3 < 10)
Pass: Batch: 5465.236165ms GPU, 16.40s total GPU, 16.40s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.73s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.73s) before accumulating min_samples (3 < 10)
Pass: Cold: 6241.969889ms GPU, 6241.981513ms CPU, 18.73s total GPU, 18.73s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 170: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.58s) before accumulating min_samples (4 < 10)
Pass: Batch: 4143.828125ms GPU, 16.58s total GPU, 16.58s total wall, 4x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.41s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.41s) before accumulating min_samples (3 < 10)
Pass: Cold: 5804.592285ms GPU, 5804.603642ms CPU, 17.41s total GPU, 17.41s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 198: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.88s) before accumulating min_samples (3 < 10)
Pass: Batch: 6292.907389ms GPU, 18.88s total GPU, 18.88s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.38s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.38s) before accumulating min_samples (3 < 10)
Pass: Cold: 5791.879395ms GPU, 5791.890389ms CPU, 17.38s total GPU, 17.38s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 226: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.33s) before accumulating min_samples (3 < 10)
Pass: Batch: 5776.413086ms GPU, 17.33s total GPU, 17.33s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.42s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.42s) before accumulating min_samples (3 < 10)
Pass: Cold: 5805.243652ms GPU, 5805.256230ms CPU, 17.42s total GPU, 17.42s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 254: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.13s) before accumulating min_samples (3 < 10)
Pass: Batch: 5708.331380ms GPU, 17.12s total GPU, 17.13s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.93s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.93s) before accumulating min_samples (3 < 10)
Pass: Cold: 5311.152181ms GPU, 5311.163178ms CPU, 15.93s total GPU, 15.93s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 283: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.15s) before accumulating min_samples (4 < 10)
Pass: Batch: 4287.388428ms GPU, 17.15s total GPU, 17.15s total wall, 4x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.45s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.45s) before accumulating min_samples (3 < 10)
Pass: Cold: 5151.335938ms GPU, 5151.346536ms CPU, 15.45s total GPU, 15.45s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 311: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.41s) before accumulating min_samples (3 < 10)
Pass: Batch: 5136.142578ms GPU, 15.41s total GPU, 15.41s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.96s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.96s) before accumulating min_samples (3 < 10)
Pass: Cold: 6320.289062ms GPU, 6320.299775ms CPU, 18.96s total GPU, 18.96s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 339: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.56s) before accumulating min_samples (3 < 10)
Pass: Batch: 6520.101888ms GPU, 19.56s total GPU, 19.56s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.27s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.27s) before accumulating min_samples (3 < 10)
Pass: Cold: 5755.064616ms GPU, 5755.075898ms CPU, 17.27s total GPU, 17.27s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 367: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.30s) before accumulating min_samples (3 < 10)
Pass: Batch: 5765.265299ms GPU, 17.30s total GPU, 17.30s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.63s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.63s) before accumulating min_samples (3 < 10)
Pass: Cold: 5876.225749ms GPU, 5876.237204ms CPU, 17.63s total GPU, 17.63s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 395: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.36s) before accumulating min_samples (3 < 10)
Pass: Batch: 5788.112793ms GPU, 17.36s total GPU, 17.36s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.43s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.43s) before accumulating min_samples (4 < 10)
Pass: Cold: 4606.834290ms GPU, 4606.844921ms CPU, 18.43s total GPU, 18.43s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 425: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.52s) before accumulating min_samples (4 < 10)
Pass: Batch: 4629.354736ms GPU, 18.52s total GPU, 18.52s total wall, 4x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 449: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.08s) before accumulating min_samples (3 < 10)
Pass: Cold: 5693.958496ms GPU, 5693.969618ms CPU, 17.08s total GPU, 17.08s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 454: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.04s) before accumulating min_samples (4 < 10)
Pass: Batch: 5010.391418ms GPU, 20.04s total GPU, 20.04s total wall, 4x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 478: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.52s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.52s) before accumulating min_samples (3 < 10)
Pass: Cold: 5174.285645ms GPU, 5174.296663ms CPU, 15.52s total GPU, 15.52s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 483: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.12s) before accumulating min_samples (4 < 10)
Pass: Batch: 4529.044800ms GPU, 18.12s total GPU, 18.12s total wall, 4x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 502: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 505: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 506: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 507: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.53s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.53s) before accumulating min_samples (3 < 10)
Pass: Cold: 5843.270671ms GPU, 5843.281991ms CPU, 17.53s total GPU, 17.53s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 508: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 509: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 510: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 511: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.85s) before accumulating min_samples (3 < 10)
Pass: Batch: 6283.163574ms GPU, 18.85s total GPU, 18.85s total wall, 3x
==PROF== Disconnected from process 12965
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|--------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|       16 |    2048 |        32 |            8 |       128 |          -1 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      4x |  5.514 s |  inf% |  5.514 s |  inf% | 5.942K | 121.702 MB/s |  0.01% |      3x |   5.248 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      4x |  5.003 s |  inf% |  5.003 s |  inf% | 6.549K | 134.127 MB/s |  0.01% |      3x |   5.773 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  6.981 s |  inf% |  6.981 s |  inf% | 4.694K |  96.125 MB/s |  0.01% |      3x |   6.489 s |
|       16 |    2048 |        32 |            8 |       128 |          -1 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.383 s |  inf% |  5.383 s |  inf% | 6.088K | 124.674 MB/s |  0.01% |      3x |   6.353 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  6.365 s |  inf% |  6.365 s |  inf% | 5.148K | 105.434 MB/s |  0.01% |      3x |   5.465 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  6.242 s |  inf% |  6.242 s |  inf% | 5.250K | 107.512 MB/s |  0.01% |      4x |   4.144 s |
|       16 |    2048 |        32 |            8 |       128 |          -1 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.805 s |  inf% |  5.805 s |  inf% | 5.645K | 115.613 MB/s |  0.01% |      3x |   6.293 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.792 s |  inf% |  5.792 s |  inf% | 5.658K | 115.867 MB/s |  0.01% |      3x |   5.776 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.805 s |  inf% |  5.805 s |  inf% | 5.645K | 115.600 MB/s |  0.01% |      3x |   5.708 s |
|       16 |    2048 |        32 |            8 |       128 |          -1 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.311 s |  inf% |  5.311 s |  inf% | 6.170K | 126.355 MB/s |  0.01% |      4x |   4.287 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.151 s |  inf% |  5.151 s |  inf% | 6.361K | 130.275 MB/s |  0.01% |      3x |   5.136 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  6.320 s |  inf% |  6.320 s |  inf% | 5.185K | 106.180 MB/s |  0.01% |      3x |   6.520 s |
|       16 |    2048 |        32 |            8 |       128 |          -1 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.755 s |  inf% |  5.755 s |  inf% | 5.694K | 116.608 MB/s |  0.01% |      3x |   5.765 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.876 s |  inf% |  5.876 s |  inf% | 5.576K | 114.204 MB/s |  0.01% |      3x |   5.788 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      4x |  4.607 s |  inf% |  4.607 s |  inf% | 7.113K | 145.672 MB/s |  0.02% |      4x |   4.629 s |
|       16 |    2048 |        32 |            8 |       128 |          -1 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.694 s |  inf% |  5.694 s |  inf% | 5.755K | 117.860 MB/s |  0.01% |      4x |   5.010 s |
|       16 |    2048 |        32 |            8 |       128 |         128 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.174 s |  inf% |  5.174 s |  inf% | 6.333K | 129.697 MB/s |  0.01% |      4x |   4.529 s |
|       16 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 549755813888 |          640 |      3x |  5.843 s |  inf% |  5.843 s |  inf% | 5.608K | 114.848 MB/s |  0.01% |      3x |   6.283 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/typical-mix.ncu-rep
Testing GQA ratio impact with variable length...
Profiling: varlen/gqa-1
==PROF== Connected to process 13349 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23657 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.08s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.08s) before accumulating min_samples (3 < 10)
Pass: Cold: 6359.682292ms GPU, 6359.694601ms CPU, 19.08s total GPU, 19.08s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.15s) before accumulating min_samples (3 < 10)
Pass: Batch: 6381.804525ms GPU, 19.15s total GPU, 19.15s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.61s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.61s) before accumulating min_samples (3 < 10)
Pass: Cold: 6203.875000ms GPU, 6203.886706ms CPU, 18.61s total GPU, 18.61s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.99s) before accumulating min_samples (3 < 10)
Pass: Batch: 6330.736654ms GPU, 18.99s total GPU, 18.99s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.49s) before accumulating min_samples (3 < 10)
Pass: Cold: 5829.317708ms GPU, 5829.328376ms CPU, 17.49s total GPU, 17.49s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.90s) before accumulating min_samples (3 < 10)
Pass: Batch: 6301.294922ms GPU, 18.90s total GPU, 18.90s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.43s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.43s) before accumulating min_samples (3 < 10)
Pass: Cold: 6142.888997ms GPU, 6142.901350ms CPU, 18.43s total GPU, 18.43s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.61s) before accumulating min_samples (3 < 10)
Pass: Batch: 6202.655436ms GPU, 18.61s total GPU, 18.61s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.06s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.06s) before accumulating min_samples (3 < 10)
Pass: Cold: 5687.996745ms GPU, 5688.007894ms CPU, 17.06s total GPU, 17.06s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.60s) before accumulating min_samples (3 < 10)
Pass: Batch: 6198.797201ms GPU, 18.60s total GPU, 18.60s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.84s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.84s) before accumulating min_samples (3 < 10)
Pass: Cold: 5947.993815ms GPU, 5948.006139ms CPU, 17.84s total GPU, 17.84s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.67s) before accumulating min_samples (3 < 10)
Pass: Batch: 5891.164551ms GPU, 17.67s total GPU, 17.67s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.54s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.54s) before accumulating min_samples (3 < 10)
Pass: Cold: 5845.861654ms GPU, 5845.873407ms CPU, 17.54s total GPU, 17.54s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.89s) before accumulating min_samples (3 < 10)
Pass: Batch: 6295.731934ms GPU, 18.89s total GPU, 18.89s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.13s) before accumulating min_samples (3 < 10)
Pass: Cold: 6376.373210ms GPU, 6376.385560ms CPU, 19.13s total GPU, 19.13s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.07s) before accumulating min_samples (3 < 10)
Pass: Batch: 5023.283529ms GPU, 15.07s total GPU, 15.07s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.21s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.21s) before accumulating min_samples (3 < 10)
Pass: Cold: 6071.365560ms GPU, 6071.378041ms CPU, 18.21s total GPU, 18.21s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.97s) before accumulating min_samples (3 < 10)
Pass: Batch: 5990.096191ms GPU, 17.97s total GPU, 17.97s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.72s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.72s) before accumulating min_samples (3 < 10)
Pass: Cold: 5904.975749ms GPU, 5904.988300ms CPU, 17.71s total GPU, 17.72s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.25s) before accumulating min_samples (3 < 10)
Pass: Batch: 5751.563639ms GPU, 17.25s total GPU, 17.25s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.57s) before accumulating min_samples (3 < 10)
Pass: Cold: 6190.545247ms GPU, 6190.556156ms CPU, 18.57s total GPU, 18.57s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.38s) before accumulating min_samples (3 < 10)
Pass: Batch: 5793.100260ms GPU, 17.38s total GPU, 17.38s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.67s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.67s) before accumulating min_samples (3 < 10)
Pass: Cold: 5890.922526ms GPU, 5890.934569ms CPU, 17.67s total GPU, 17.67s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.19s) before accumulating min_samples (3 < 10)
Pass: Batch: 5061.949544ms GPU, 15.19s total GPU, 15.19s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.63s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.63s) before accumulating min_samples (3 < 10)
Pass: Cold: 5542.813314ms GPU, 5542.825152ms CPU, 16.63s total GPU, 16.63s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.92s) before accumulating min_samples (3 < 10)
Pass: Batch: 5974.521159ms GPU, 17.92s total GPU, 17.92s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.27s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.27s) before accumulating min_samples (3 < 10)
Pass: Cold: 5757.081217ms GPU, 5757.092965ms CPU, 17.27s total GPU, 17.27s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.82s) before accumulating min_samples (3 < 10)
Pass: Batch: 5272.825684ms GPU, 15.82s total GPU, 15.82s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 415: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.72s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.72s) before accumulating min_samples (3 < 10)
Pass: Cold: 5906.233561ms GPU, 5906.245383ms CPU, 17.72s total GPU, 17.72s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.24s) before accumulating min_samples (3 < 10)
Pass: Batch: 5414.298014ms GPU, 16.24s total GPU, 16.24s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 443: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.37s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.37s) before accumulating min_samples (3 < 10)
Pass: Cold: 6123.541829ms GPU, 6123.553994ms CPU, 18.37s total GPU, 18.37s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.40s) before accumulating min_samples (3 < 10)
Pass: Batch: 6132.877604ms GPU, 18.40s total GPU, 18.40s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 471: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.05s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.05s) before accumulating min_samples (3 < 10)
Pass: Cold: 5684.086589ms GPU, 5684.120173ms CPU, 17.05s total GPU, 17.05s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 474: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.87s) before accumulating min_samples (2 < 10)
Pass: Batch: 7933.285156ms GPU, 15.87s total GPU, 15.87s total wall, 2x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=32 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 498: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.07s) before accumulating min_samples (3 < 10)
Pass: Cold: 6024.012858ms GPU, 6024.024361ms CPU, 18.07s total GPU, 18.07s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 502: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.22s) before accumulating min_samples (3 < 10)
Pass: Batch: 5740.370931ms GPU, 17.22s total GPU, 17.22s total wall, 3x
==PROF== Disconnected from process 13349
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |           32 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.360 s |  inf% |  6.360 s |  inf% | 10.305K | 337.672 MB/s |  0.04% |      3x |   6.382 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |           -1 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.204 s |  inf% |  6.204 s |  inf% | 10.564K | 346.152 MB/s |  0.04% |      3x |   6.331 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.829 s |  inf% |  5.829 s |  inf% | 11.242K | 368.394 MB/s |  0.04% |      3x |   6.301 s |
|       16 |    4096 |        32 |           32 |       128 |          -1 |          128 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.143 s |  inf% |  6.143 s |  inf% | 10.669K | 349.589 MB/s |  0.04% |      3x |   6.203 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |          128 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.688 s |  inf% |  5.688 s |  inf% | 11.522K | 377.547 MB/s |  0.04% |      3x |   6.199 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |          128 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.948 s |  inf% |  5.948 s |  inf% | 11.018K | 361.043 MB/s |  0.04% |      3x |   5.891 s |
|       16 |    4096 |        32 |           32 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.846 s |  inf% |  5.846 s |  inf% | 11.211K | 367.351 MB/s |  0.04% |      3x |   6.296 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |         1024 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.376 s |  inf% |  6.376 s |  inf% | 10.278K | 336.788 MB/s |  0.04% |      3x |   5.023 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.071 s |  inf% |  6.071 s |  inf% | 10.794K | 353.707 MB/s |  0.04% |      3x |   5.990 s |
|       16 |    4096 |        32 |           32 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.905 s |  inf% |  5.905 s |  inf% | 11.098K | 363.674 MB/s |  0.04% |      3x |   5.752 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |           -1 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.191 s |  inf% |  6.191 s |  inf% | 10.586K | 346.897 MB/s |  0.04% |      3x |   5.793 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.891 s |  inf% |  5.891 s |  inf% | 11.125K | 364.541 MB/s |  0.04% |      3x |   5.062 s |
|       16 |    4096 |        32 |           32 |       128 |          -1 |          128 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.543 s |  inf% |  5.543 s |  inf% | 11.824K | 387.436 MB/s |  0.04% |      3x |   5.975 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |          128 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.757 s |  inf% |  5.757 s |  inf% | 11.384K | 373.016 MB/s |  0.04% |      3x |   5.273 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |          128 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.906 s |  inf% |  5.906 s |  inf% | 11.096K | 363.596 MB/s |  0.04% |      3x |   5.414 s |
|       16 |    4096 |        32 |           32 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.124 s |  inf% |  6.124 s |  inf% | 10.702K | 350.693 MB/s |  0.04% |      3x |   6.133 s |
|       16 |    4096 |        32 |           32 |       128 |         128 |         1024 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  5.684 s |  inf% |  5.684 s |  inf% | 11.530K | 377.806 MB/s |  0.04% |      2x |   7.933 s |
|       16 |    4096 |        32 |           32 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 512.000 MiB | 512.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         2048 |      3x |  6.024 s |  inf% |  6.024 s |  inf% | 10.879K | 356.487 MB/s |  0.04% |      3x |   5.740 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/gqa-1.ncu-rep
Profiling: varlen/gqa-4
==PROF== Connected to process 13366 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23659 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.35s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.35s) before accumulating min_samples (2 < 10)
Pass: Cold: 9176.025635ms GPU, 9176.042973ms CPU, 18.35s total GPU, 18.35s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.96s) before accumulating min_samples (1 < 10)
Pass: Batch: 18961.957031ms GPU, 18.96s total GPU, 18.96s total wall, 1x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.79s) before accumulating min_samples (3 < 10)
Pass: Cold: 6596.374186ms GPU, 6596.384638ms CPU, 19.79s total GPU, 19.79s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.31s) before accumulating min_samples (2 < 10)
Pass: Batch: 8156.104492ms GPU, 16.31s total GPU, 16.31s total wall, 2x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.16s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.16s) before accumulating min_samples (3 < 10)
Pass: Cold: 6385.563802ms GPU, 6385.575328ms CPU, 19.16s total GPU, 19.16s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.09s) before accumulating min_samples (3 < 10)
Pass: Batch: 7028.708984ms GPU, 21.09s total GPU, 21.09s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.13s) before accumulating min_samples (2 < 10)
Pass: Cold: 7564.758789ms GPU, 7564.772424ms CPU, 15.13s total GPU, 15.13s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.40s) before accumulating min_samples (2 < 10)
Pass: Batch: 7702.475342ms GPU, 15.40s total GPU, 15.40s total wall, 2x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.52s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.52s) before accumulating min_samples (2 < 10)
Pass: Cold: 10261.748779ms GPU, 10261.760965ms CPU, 20.52s total GPU, 20.52s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.51s) before accumulating min_samples (3 < 10)
Pass: Batch: 6503.844889ms GPU, 19.51s total GPU, 19.51s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.79s) before accumulating min_samples (4 < 10)
Pass: Cold: 5196.771545ms GPU, 5196.782809ms CPU, 20.79s total GPU, 20.79s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.28s) before accumulating min_samples (3 < 10)
Pass: Batch: 6427.479167ms GPU, 19.28s total GPU, 19.28s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 186: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.24s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.24s) before accumulating min_samples (4 < 10)
Pass: Cold: 4560.200989ms GPU, 4560.212957ms CPU, 18.24s total GPU, 18.24s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.29s) before accumulating min_samples (3 < 10)
Pass: Batch: 5431.331868ms GPU, 16.29s total GPU, 16.29s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.73s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.73s) before accumulating min_samples (3 < 10)
Pass: Cold: 5911.533203ms GPU, 5911.546064ms CPU, 17.73s total GPU, 17.73s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.73s) before accumulating min_samples (4 < 10)
Pass: Batch: 5183.554688ms GPU, 20.73s total GPU, 20.73s total wall, 4x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 243: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.49s) before accumulating min_samples (3 < 10)
Pass: Cold: 5497.253581ms GPU, 5497.265192ms CPU, 16.49s total GPU, 16.49s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.67s) before accumulating min_samples (3 < 10)
Pass: Batch: 6558.238281ms GPU, 19.67s total GPU, 19.67s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 271: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.18s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.18s) before accumulating min_samples (3 < 10)
Pass: Cold: 5059.213704ms GPU, 5059.225784ms CPU, 15.18s total GPU, 15.18s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.31s) before accumulating min_samples (3 < 10)
Pass: Batch: 6435.325684ms GPU, 19.31s total GPU, 19.31s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.23s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.23s) before accumulating min_samples (3 < 10)
Pass: Cold: 5743.487630ms GPU, 5743.499279ms CPU, 17.23s total GPU, 17.23s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 5810.640788ms GPU, 17.43s total GPU, 17.43s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 327: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.75s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.75s) before accumulating min_samples (3 < 10)
Pass: Cold: 5915.109049ms GPU, 5915.120436ms CPU, 17.75s total GPU, 17.75s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.94s) before accumulating min_samples (4 < 10)
Pass: Batch: 6233.841370ms GPU, 24.94s total GPU, 24.94s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 356: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.05s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.05s) before accumulating min_samples (3 < 10)
Pass: Cold: 6017.263997ms GPU, 6017.275487ms CPU, 18.05s total GPU, 18.05s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.92s) before accumulating min_samples (3 < 10)
Pass: Batch: 5972.000000ms GPU, 17.92s total GPU, 17.92s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 384: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.81s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.81s) before accumulating min_samples (3 < 10)
Pass: Cold: 5270.030599ms GPU, 5270.042206ms CPU, 15.81s total GPU, 15.81s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.73s) before accumulating min_samples (3 < 10)
Pass: Batch: 5241.799967ms GPU, 15.73s total GPU, 15.73s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 391: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 411: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.94s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.94s) before accumulating min_samples (2 < 10)
Pass: Cold: 7969.939453ms GPU, 7969.950912ms CPU, 15.94s total GPU, 15.94s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 415: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.35s) before accumulating min_samples (3 < 10)
Pass: Batch: 5781.698242ms GPU, 17.35s total GPU, 17.35s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 439: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.03s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.03s) before accumulating min_samples (3 < 10)
Pass: Cold: 6009.379883ms GPU, 6009.392052ms CPU, 18.03s total GPU, 18.03s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 443: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.60s) before accumulating min_samples (3 < 10)
Pass: Batch: 5532.328939ms GPU, 16.60s total GPU, 16.60s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 467: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.11s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.11s) before accumulating min_samples (3 < 10)
Pass: Cold: 5703.825521ms GPU, 5703.836606ms CPU, 17.11s total GPU, 17.11s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 471: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.21s) before accumulating min_samples (3 < 10)
Pass: Batch: 5737.063151ms GPU, 17.21s total GPU, 17.21s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 495: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.07s) before accumulating min_samples (3 < 10)
Pass: Cold: 6357.064453ms GPU, 6357.075414ms CPU, 19.07s total GPU, 19.07s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 499: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5914.211751ms GPU, 17.74s total GPU, 17.74s total wall, 3x
==PROF== Disconnected from process 13366
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      2x |  9.176 s |  inf% |  9.176 s |  inf% |  7.142K | 146.270 MB/s |  0.02% |      1x |  18.962 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.596 s |  inf% |  6.596 s |  inf% |  9.935K | 203.472 MB/s |  0.02% |      2x |   8.156 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.386 s |  inf% |  6.386 s |  inf% | 10.263K | 210.189 MB/s |  0.02% |      3x |   7.029 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      2x |  7.565 s |  inf% |  7.565 s |  inf% |  8.663K | 177.425 MB/s |  0.02% |      2x |   7.702 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      2x | 10.262 s |  inf% | 10.262 s |  inf% |  6.386K | 130.794 MB/s |  0.01% |      3x |   6.504 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  5.197 s |  inf% |  5.197 s |  inf% | 12.611K | 258.271 MB/s |  0.03% |      3x |   6.427 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.560 s |  inf% |  4.560 s |  inf% | 14.371K | 294.324 MB/s |  0.03% |      3x |   5.431 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.912 s |  inf% |  5.912 s |  inf% | 11.086K | 227.044 MB/s |  0.02% |      4x |   5.184 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.497 s |  inf% |  5.497 s |  inf% | 11.922K | 244.154 MB/s |  0.03% |      3x |   6.558 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.059 s |  inf% |  5.059 s |  inf% | 12.954K | 265.294 MB/s |  0.03% |      3x |   6.435 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.743 s |  inf% |  5.743 s |  inf% | 11.410K | 233.687 MB/s |  0.03% |      3x |   5.811 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.915 s |  inf% |  5.915 s |  inf% | 11.079K | 226.907 MB/s |  0.02% |      4x |   6.234 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.017 s |  inf% |  6.017 s |  inf% | 10.891K | 223.054 MB/s |  0.02% |      3x |   5.972 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.270 s |  inf% |  5.270 s |  inf% | 12.436K | 254.681 MB/s |  0.03% |      3x |   5.242 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      2x |  7.970 s |  inf% |  7.970 s |  inf% |  8.223K | 168.405 MB/s |  0.02% |      3x |   5.782 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.009 s |  inf% |  6.009 s |  inf% | 10.906K | 223.347 MB/s |  0.02% |      3x |   5.532 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.704 s |  inf% |  5.704 s |  inf% | 11.490K | 235.312 MB/s |  0.03% |      3x |   5.737 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.357 s |  inf% |  6.357 s |  inf% | 10.309K | 211.132 MB/s |  0.02% |      3x |   5.914 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/gqa-4.ncu-rep
Profiling: varlen/gqa-8
==PROF== Connected to process 13417 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23661 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.85s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.85s) before accumulating min_samples (3 < 10)
Pass: Cold: 6282.506999ms GPU, 6282.519021ms CPU, 18.85s total GPU, 18.85s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.22s) before accumulating min_samples (3 < 10)
Pass: Batch: 6406.111165ms GPU, 19.22s total GPU, 19.22s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.38s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.38s) before accumulating min_samples (3 < 10)
Pass: Cold: 6125.187337ms GPU, 6125.200312ms CPU, 18.38s total GPU, 18.38s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.94s) before accumulating min_samples (3 < 10)
Pass: Batch: 5648.304525ms GPU, 16.94s total GPU, 16.94s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.20s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.20s) before accumulating min_samples (3 < 10)
Pass: Cold: 6398.754720ms GPU, 6398.769049ms CPU, 19.20s total GPU, 19.20s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.32s) before accumulating min_samples (2 < 10)
Pass: Batch: 8661.396729ms GPU, 17.32s total GPU, 17.32s total wall, 2x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.03s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.03s) before accumulating min_samples (3 < 10)
Pass: Cold: 6677.918783ms GPU, 6677.930488ms CPU, 20.03s total GPU, 20.03s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.01s) before accumulating min_samples (3 < 10)
Pass: Batch: 6668.624512ms GPU, 20.01s total GPU, 20.01s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.35s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.35s) before accumulating min_samples (3 < 10)
Pass: Cold: 5784.133301ms GPU, 5784.144376ms CPU, 17.35s total GPU, 17.35s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.28s) before accumulating min_samples (4 < 10)
Pass: Batch: 4820.085999ms GPU, 19.28s total GPU, 19.28s total wall, 4x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.06s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.06s) before accumulating min_samples (3 < 10)
Pass: Cold: 6018.281250ms GPU, 6018.293198ms CPU, 18.05s total GPU, 18.06s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.96s) before accumulating min_samples (3 < 10)
Pass: Batch: 5987.339681ms GPU, 17.96s total GPU, 17.96s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.29s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.29s) before accumulating min_samples (3 < 10)
Pass: Cold: 6429.716797ms GPU, 6429.728644ms CPU, 19.29s total GPU, 19.29s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.26s) before accumulating min_samples (3 < 10)
Pass: Batch: 6418.947754ms GPU, 19.26s total GPU, 19.26s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.43s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.43s) before accumulating min_samples (3 < 10)
Pass: Cold: 5476.746094ms GPU, 5476.759292ms CPU, 16.43s total GPU, 16.43s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 224: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.80s) before accumulating min_samples (4 < 10)
Pass: Batch: 5198.878906ms GPU, 20.80s total GPU, 20.80s total wall, 4x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.27s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.27s) before accumulating min_samples (3 < 10)
Pass: Cold: 6090.607259ms GPU, 6090.620453ms CPU, 18.27s total GPU, 18.27s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.14s) before accumulating min_samples (3 < 10)
Pass: Batch: 5713.762207ms GPU, 17.14s total GPU, 17.14s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.68s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.68s) before accumulating min_samples (3 < 10)
Pass: Cold: 5561.144043ms GPU, 5561.156666ms CPU, 16.68s total GPU, 16.68s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.86s) before accumulating min_samples (3 < 10)
Pass: Batch: 5952.926595ms GPU, 17.86s total GPU, 17.86s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.28s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.28s) before accumulating min_samples (3 < 10)
Pass: Cold: 5758.939616ms GPU, 5758.951155ms CPU, 17.28s total GPU, 17.28s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 308: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.20s) before accumulating min_samples (3 < 10)
Pass: Batch: 5400.168457ms GPU, 16.20s total GPU, 16.20s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.94s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.94s) before accumulating min_samples (3 < 10)
Pass: Cold: 6313.791667ms GPU, 6313.803702ms CPU, 18.94s total GPU, 18.94s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.60s) before accumulating min_samples (4 < 10)
Pass: Batch: 5150.530151ms GPU, 20.60s total GPU, 20.60s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.70s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.70s) before accumulating min_samples (3 < 10)
Pass: Cold: 6231.719564ms GPU, 6231.731512ms CPU, 18.70s total GPU, 18.70s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.76s) before accumulating min_samples (4 < 10)
Pass: Batch: 4689.056274ms GPU, 18.76s total GPU, 18.76s total wall, 4x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.31s) before accumulating min_samples (3 < 10)
Pass: Cold: 5435.270833ms GPU, 5435.282033ms CPU, 16.31s total GPU, 16.31s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.15s) before accumulating min_samples (3 < 10)
Pass: Batch: 6384.675130ms GPU, 19.15s total GPU, 19.15s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.71s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.71s) before accumulating min_samples (3 < 10)
Pass: Cold: 5902.652832ms GPU, 5902.664424ms CPU, 17.71s total GPU, 17.71s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 422: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.81s) before accumulating min_samples (3 < 10)
Pass: Batch: 5604.010579ms GPU, 16.81s total GPU, 16.81s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.23s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.23s) before accumulating min_samples (3 < 10)
Pass: Cold: 7075.262044ms GPU, 7075.274504ms CPU, 21.23s total GPU, 21.23s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 450: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.23s) before accumulating min_samples (3 < 10)
Pass: Batch: 7076.797119ms GPU, 21.23s total GPU, 21.23s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 474: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.39s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.39s) before accumulating min_samples (3 < 10)
Pass: Cold: 5463.715169ms GPU, 5463.725321ms CPU, 16.39s total GPU, 16.39s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 478: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.80s) before accumulating min_samples (3 < 10)
Pass: Batch: 5931.930013ms GPU, 17.80s total GPU, 17.80s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=4 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 502: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.09s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.09s) before accumulating min_samples (3 < 10)
Pass: Cold: 6030.903646ms GPU, 6030.914782ms CPU, 18.09s total GPU, 18.09s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 505: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 506: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.30s) before accumulating min_samples (3 < 10)
Pass: Batch: 6433.189616ms GPU, 19.30s total GPU, 19.30s total wall, 3x
==PROF== Disconnected from process 13417
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            4 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.283 s |  inf% |  6.283 s |  inf% | 10.432K | 192.273 MB/s |  0.02% |      3x |   6.406 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |           -1 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.125 s |  inf% |  6.125 s |  inf% | 10.699K | 197.212 MB/s |  0.02% |      3x |   5.648 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.399 s |  inf% |  6.399 s |  inf% | 10.242K | 188.780 MB/s |  0.02% |      2x |   8.661 s |
|       16 |    4096 |        32 |            4 |       128 |          -1 |          128 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.678 s |  inf% |  6.678 s |  inf% |  9.814K | 180.889 MB/s |  0.02% |      3x |   6.669 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |          128 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.784 s |  inf% |  5.784 s |  inf% | 11.330K | 208.840 MB/s |  0.02% |      4x |   4.820 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |          128 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.018 s |  inf% |  6.018 s |  inf% | 10.889K | 200.715 MB/s |  0.02% |      3x |   5.987 s |
|       16 |    4096 |        32 |            4 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.430 s |  inf% |  6.430 s |  inf% | 10.193K | 187.871 MB/s |  0.02% |      3x |   6.419 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |         1024 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.477 s |  inf% |  5.477 s |  inf% | 11.966K | 220.562 MB/s |  0.02% |      4x |   5.199 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.091 s |  inf% |  6.091 s |  inf% | 10.760K | 198.332 MB/s |  0.02% |      3x |   5.714 s |
|       16 |    4096 |        32 |            4 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.561 s |  inf% |  5.561 s |  inf% | 11.785K | 217.214 MB/s |  0.02% |      3x |   5.953 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |           -1 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.759 s |  inf% |  5.759 s |  inf% | 11.380K | 209.754 MB/s |  0.02% |      3x |   5.400 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.314 s |  inf% |  6.314 s |  inf% | 10.380K | 191.321 MB/s |  0.02% |      4x |   5.151 s |
|       16 |    4096 |        32 |            4 |       128 |          -1 |          128 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.232 s |  inf% |  6.232 s |  inf% | 10.517K | 193.840 MB/s |  0.02% |      4x |   4.689 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |          128 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.435 s |  inf% |  5.435 s |  inf% | 12.058K | 222.245 MB/s |  0.02% |      3x |   6.385 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |          128 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.903 s |  inf% |  5.903 s |  inf% | 11.103K | 204.647 MB/s |  0.02% |      3x |   5.604 s |
|       16 |    4096 |        32 |            4 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  7.075 s |  inf% |  7.075 s |  inf% |  9.263K | 170.730 MB/s |  0.02% |      3x |   7.077 s |
|       16 |    4096 |        32 |            4 |       128 |         128 |         1024 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  5.464 s |  inf% |  5.464 s |  inf% | 11.995K | 221.088 MB/s |  0.02% |      3x |   5.932 s |
|       16 |    4096 |        32 |            4 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 64.000 MiB | 64.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1152 |      3x |  6.031 s |  inf% |  6.031 s |  inf% | 10.867K | 200.295 MB/s |  0.02% |      3x |   6.433 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/gqa-8.ncu-rep
Profiling: varlen/gqa-32
==PROF== Connected to process 13434 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.00s) before accumulating min_samples (3 < 10)
Pass: Cold: 6666.757487ms GPU, 6666.769341ms CPU, 20.00s total GPU, 20.00s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.24s) before accumulating min_samples (3 < 10)
Pass: Batch: 5412.007324ms GPU, 16.24s total GPU, 16.24s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.31s) before accumulating min_samples (3 < 10)
Pass: Cold: 5771.439453ms GPU, 5771.451040ms CPU, 17.31s total GPU, 17.31s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.68s) before accumulating min_samples (3 < 10)
Pass: Batch: 6225.421224ms GPU, 18.68s total GPU, 18.68s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.42s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.42s) before accumulating min_samples (3 < 10)
Pass: Cold: 5474.206868ms GPU, 5474.218578ms CPU, 16.42s total GPU, 16.42s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.95s) before accumulating min_samples (3 < 10)
Pass: Batch: 7984.170736ms GPU, 23.95s total GPU, 23.95s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.45s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.45s) before accumulating min_samples (4 < 10)
Pass: Cold: 4363.184631ms GPU, 4363.196606ms CPU, 17.45s total GPU, 17.45s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) before accumulating min_samples (3 < 10)
Pass: Batch: 5695.129232ms GPU, 17.09s total GPU, 17.09s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.34s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.34s) before accumulating min_samples (3 < 10)
Pass: Cold: 5780.067708ms GPU, 5780.079460ms CPU, 17.34s total GPU, 17.34s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.84s) before accumulating min_samples (3 < 10)
Pass: Batch: 5278.432454ms GPU, 15.84s total GPU, 15.84s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.69s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.69s) before accumulating min_samples (3 < 10)
Pass: Cold: 6898.171549ms GPU, 6898.183852ms CPU, 20.69s total GPU, 20.69s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.50s) before accumulating min_samples (3 < 10)
Pass: Batch: 5500.510254ms GPU, 16.50s total GPU, 16.50s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.01s) before accumulating min_samples (3 < 10)
Pass: Cold: 5003.021566ms GPU, 5003.033115ms CPU, 15.01s total GPU, 15.01s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5913.307454ms GPU, 17.74s total GPU, 17.74s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.26s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.26s) before accumulating min_samples (3 < 10)
Pass: Cold: 5419.114095ms GPU, 5419.125378ms CPU, 16.26s total GPU, 16.26s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 224: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 5475.652018ms GPU, 16.43s total GPU, 16.43s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.41s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.41s) before accumulating min_samples (4 < 10)
Pass: Cold: 4351.940002ms GPU, 4351.951498ms CPU, 17.41s total GPU, 17.41s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 253: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.63s) before accumulating min_samples (3 < 10)
Pass: Batch: 5210.405436ms GPU, 15.63s total GPU, 15.63s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.89s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.89s) before accumulating min_samples (4 < 10)
Pass: Cold: 4223.444946ms GPU, 4223.456826ms CPU, 16.89s total GPU, 16.89s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.21s) before accumulating min_samples (3 < 10)
Pass: Batch: 6070.621582ms GPU, 18.21s total GPU, 18.21s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.22s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.22s) before accumulating min_samples (4 < 10)
Pass: Cold: 4306.117554ms GPU, 4306.128691ms CPU, 17.22s total GPU, 17.22s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 311: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.48s) before accumulating min_samples (3 < 10)
Pass: Batch: 6825.646647ms GPU, 20.48s total GPU, 20.48s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.14s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.14s) before accumulating min_samples (3 < 10)
Pass: Cold: 5047.986165ms GPU, 5047.998719ms CPU, 15.14s total GPU, 15.14s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.61s) before accumulating min_samples (2 < 10)
Pass: Batch: 8806.927246ms GPU, 17.61s total GPU, 17.61s total wall, 2x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.47s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.47s) before accumulating min_samples (3 < 10)
Pass: Cold: 6489.027995ms GPU, 6489.040206ms CPU, 19.47s total GPU, 19.47s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.23s) before accumulating min_samples (3 < 10)
Pass: Batch: 6408.339193ms GPU, 19.23s total GPU, 19.23s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.51s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.51s) before accumulating min_samples (4 < 10)
Pass: Cold: 4377.097900ms GPU, 4377.108970ms CPU, 17.51s total GPU, 17.51s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 395: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5246.323649ms GPU, 15.74s total GPU, 15.74s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.67s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.67s) before accumulating min_samples (3 < 10)
Pass: Cold: 5890.987467ms GPU, 5890.999401ms CPU, 17.67s total GPU, 17.67s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 423: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.45s) before accumulating min_samples (3 < 10)
Pass: Batch: 6817.742839ms GPU, 20.45s total GPU, 20.45s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.73s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.73s) before accumulating min_samples (3 < 10)
Pass: Cold: 5575.347168ms GPU, 5575.358649ms CPU, 16.73s total GPU, 16.73s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 452: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.18s) before accumulating min_samples (4 < 10)
Pass: Batch: 4543.809937ms GPU, 18.18s total GPU, 18.18s total wall, 4x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 476: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.09s) before accumulating min_samples (3 < 10)
Pass: Cold: 5695.222493ms GPU, 5695.233425ms CPU, 17.09s total GPU, 17.09s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 480: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.81s) before accumulating min_samples (3 < 10)
Pass: Batch: 6268.756185ms GPU, 18.81s total GPU, 18.81s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=1 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 502: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 505: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.95s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.95s) before accumulating min_samples (4 < 10)
Pass: Cold: 4986.496582ms GPU, 4986.507914ms CPU, 19.95s total GPU, 19.95s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 506: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 507: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 508: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 509: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.65s) before accumulating min_samples (3 < 10)
Pass: Batch: 5881.675456ms GPU, 17.65s total GPU, 17.65s total wall, 3x
==PROF== Disconnected from process 13434
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            1 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  6.667 s |  inf% |  6.667 s |  inf% |  9.830K | 166.092 MB/s |  0.02% |      3x |   5.412 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |           -1 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.771 s |  inf% |  5.771 s |  inf% | 11.355K | 191.858 MB/s |  0.02% |      3x |   6.225 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.474 s |  inf% |  5.474 s |  inf% | 11.972K | 202.275 MB/s |  0.02% |      3x |   7.984 s |
|       16 |    4096 |        32 |            1 |       128 |          -1 |          128 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.363 s |  inf% |  4.363 s |  inf% | 15.020K | 253.782 MB/s |  0.03% |      3x |   5.695 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |          128 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.780 s |  inf% |  5.780 s |  inf% | 11.338K | 191.572 MB/s |  0.02% |      3x |   5.278 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |          128 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  6.898 s |  inf% |  6.898 s |  inf% |  9.500K | 160.520 MB/s |  0.02% |      3x |   5.501 s |
|       16 |    4096 |        32 |            1 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.003 s |  inf% |  5.003 s |  inf% | 13.099K | 221.326 MB/s |  0.02% |      3x |   5.913 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |         1024 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.419 s |  inf% |  5.419 s |  inf% | 12.093K | 204.332 MB/s |  0.02% |      3x |   5.476 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.352 s |  inf% |  4.352 s |  inf% | 15.059K | 254.437 MB/s |  0.03% |      3x |   5.210 s |
|       16 |    4096 |        32 |            1 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.223 s |  inf% |  4.223 s |  inf% | 15.517K | 262.178 MB/s |  0.03% |      3x |   6.071 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |           -1 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.306 s |  inf% |  4.306 s |  inf% | 15.219K | 257.145 MB/s |  0.03% |      3x |   6.826 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.048 s |  inf% |  5.048 s |  inf% | 12.983K | 219.354 MB/s |  0.02% |      2x |   8.807 s |
|       16 |    4096 |        32 |            1 |       128 |          -1 |          128 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  6.489 s |  inf% |  6.489 s |  inf% | 10.100K | 170.641 MB/s |  0.02% |      3x |   6.408 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |          128 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.377 s |  inf% |  4.377 s |  inf% | 14.972K | 252.975 MB/s |  0.03% |      3x |   5.246 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |          128 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.891 s |  inf% |  5.891 s |  inf% | 11.125K | 187.964 MB/s |  0.02% |      3x |   6.818 s |
|       16 |    4096 |        32 |            1 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.575 s |  inf% |  5.575 s |  inf% | 11.755K | 198.606 MB/s |  0.02% |      4x |   4.544 s |
|       16 |    4096 |        32 |            1 |       128 |         128 |         1024 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      3x |  5.695 s |  inf% |  5.695 s |  inf% | 11.507K | 194.425 MB/s |  0.02% |      3x |   6.269 s |
|       16 |    4096 |        32 |            1 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 16.000 MiB | 16.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1056 |      4x |  4.987 s |  inf% |  4.986 s |  inf% | 13.143K | 222.059 MB/s |  0.02% |      3x |   5.882 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/gqa-32.ncu-rep
Testing head dimension impact with variable length...
Profiling: varlen/headdim-56
==PROF== Connected to process 13451 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.42s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.42s) before accumulating min_samples (3 < 10)
Pass: Cold: 6139.063965ms GPU, 6139.075473ms CPU, 18.42s total GPU, 18.42s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.76s) before accumulating min_samples (3 < 10)
Pass: Batch: 5251.979655ms GPU, 15.76s total GPU, 15.76s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.30s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.30s) before accumulating min_samples (3 < 10)
Pass: Cold: 6098.591471ms GPU, 6098.603438ms CPU, 18.30s total GPU, 18.30s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.35s) before accumulating min_samples (3 < 10)
Pass: Batch: 6448.996257ms GPU, 19.35s total GPU, 19.35s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.12s) while over noise threshold (16.50% > 0.50%)
Warn: Current measurement timed out (18.12s) before accumulating min_samples (5 < 10)
Pass: Cold: 3624.279883ms GPU, 3624.290800ms CPU, 18.12s total GPU, 18.12s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.86s) before accumulating min_samples (3 < 10)
Pass: Batch: 6618.986979ms GPU, 19.86s total GPU, 19.86s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.56s) before accumulating min_samples (3 < 10)
Pass: Cold: 5520.231283ms GPU, 5520.242340ms CPU, 16.56s total GPU, 16.56s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.24s) before accumulating min_samples (3 < 10)
Pass: Batch: 5079.692871ms GPU, 15.24s total GPU, 15.24s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.56s) before accumulating min_samples (3 < 10)
Pass: Cold: 5185.546224ms GPU, 5185.557154ms CPU, 15.56s total GPU, 15.56s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.90s) before accumulating min_samples (3 < 10)
Pass: Batch: 5298.640625ms GPU, 15.90s total GPU, 15.90s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.47s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.47s) before accumulating min_samples (3 < 10)
Pass: Cold: 5822.949870ms GPU, 5822.961243ms CPU, 17.47s total GPU, 17.47s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.17s) before accumulating min_samples (1 < 10)
Pass: Batch: 17172.765625ms GPU, 17.17s total GPU, 17.17s total wall, 1x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.32s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.32s) before accumulating min_samples (3 < 10)
Pass: Cold: 5106.654622ms GPU, 5106.666110ms CPU, 15.32s total GPU, 15.32s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.53s) before accumulating min_samples (3 < 10)
Pass: Batch: 6511.361816ms GPU, 19.53s total GPU, 19.53s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.40s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.40s) before accumulating min_samples (2 < 10)
Pass: Cold: 8701.311523ms GPU, 8701.323549ms CPU, 17.40s total GPU, 17.40s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 5808.504232ms GPU, 17.43s total GPU, 17.43s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.26s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.26s) before accumulating min_samples (4 < 10)
Pass: Cold: 4815.591064ms GPU, 4815.602744ms CPU, 19.26s total GPU, 19.26s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.01s) before accumulating min_samples (4 < 10)
Pass: Batch: 4501.768188ms GPU, 18.01s total GPU, 18.01s total wall, 4x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.31s) before accumulating min_samples (3 < 10)
Pass: Cold: 5438.118164ms GPU, 5438.130692ms CPU, 16.31s total GPU, 16.31s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.44s) before accumulating min_samples (3 < 10)
Pass: Batch: 5479.402995ms GPU, 16.44s total GPU, 16.44s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.96s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.96s) before accumulating min_samples (4 < 10)
Pass: Cold: 4989.629272ms GPU, 4989.639916ms CPU, 19.96s total GPU, 19.96s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 309: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.22s) before accumulating min_samples (3 < 10)
Pass: Batch: 5738.909993ms GPU, 17.22s total GPU, 17.22s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.29s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.29s) before accumulating min_samples (3 < 10)
Pass: Cold: 5764.184082ms GPU, 5764.194937ms CPU, 17.29s total GPU, 17.29s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.26s) before accumulating min_samples (4 < 10)
Pass: Batch: 4065.768311ms GPU, 16.26s total GPU, 16.26s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.10s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.10s) before accumulating min_samples (3 < 10)
Pass: Cold: 5033.930664ms GPU, 5033.942677ms CPU, 15.10s total GPU, 15.10s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.38s) before accumulating min_samples (3 < 10)
Pass: Batch: 5460.545736ms GPU, 16.38s total GPU, 16.38s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.12s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.12s) before accumulating min_samples (3 < 10)
Pass: Cold: 5704.924479ms GPU, 5704.935269ms CPU, 17.11s total GPU, 17.12s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.84s) before accumulating min_samples (3 < 10)
Pass: Batch: 5281.369466ms GPU, 15.84s total GPU, 15.84s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.76s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.76s) before accumulating min_samples (2 < 10)
Pass: Cold: 8878.185303ms GPU, 8878.197985ms CPU, 17.76s total GPU, 17.76s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.54s) before accumulating min_samples (3 < 10)
Pass: Batch: 5845.252930ms GPU, 17.54s total GPU, 17.54s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 445: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.99s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.99s) before accumulating min_samples (3 < 10)
Pass: Cold: 7330.871257ms GPU, 7330.882898ms CPU, 21.99s total GPU, 21.99s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 448: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.51s) before accumulating min_samples (2 < 10)
Pass: Batch: 8753.390625ms GPU, 17.51s total GPU, 17.51s total wall, 2x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 472: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.94s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.94s) before accumulating min_samples (3 < 10)
Pass: Cold: 6288.058105ms GPU, 6288.068658ms CPU, 18.86s total GPU, 18.94s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 477: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.74s) before accumulating min_samples (4 < 10)
Pass: Batch: 5433.803833ms GPU, 21.74s total GPU, 21.74s total wall, 4x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=56 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 501: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.37s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.37s) before accumulating min_samples (3 < 10)
Pass: Cold: 5790.087565ms GPU, 5790.098912ms CPU, 17.37s total GPU, 17.37s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 502: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 505: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.02s) before accumulating min_samples (3 < 10)
Pass: Batch: 5341.004395ms GPU, 16.02s total GPU, 16.02s total wall, 3x
==PROF== Disconnected from process 13451
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|--------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            8 |        56 |          -1 |           -1 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  6.139 s |   inf% |  6.139 s |   inf% | 10.675K |  95.650 MB/s |  0.01% |      3x |   5.252 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |           -1 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  6.099 s |   inf% |  6.099 s |   inf% | 10.746K |  96.285 MB/s |  0.01% |      3x |   6.449 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |           -1 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      5x |  3.624 s | 16.50% |  3.624 s | 16.50% | 18.082K | 162.019 MB/s |  0.02% |      3x |   6.619 s |
|       16 |    4096 |        32 |            8 |        56 |          -1 |          128 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.520 s |   inf% |  5.520 s |   inf% | 11.872K | 106.373 MB/s |  0.01% |      3x |   5.080 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |          128 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.186 s |   inf% |  5.186 s |   inf% | 12.638K | 113.238 MB/s |  0.01% |      3x |   5.299 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |          128 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.823 s |   inf% |  5.823 s |   inf% | 11.255K | 100.843 MB/s |  0.01% |      1x |  17.173 s |
|       16 |    4096 |        32 |            8 |        56 |          -1 |         1024 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.107 s |   inf% |  5.107 s |   inf% | 12.833K | 114.988 MB/s |  0.01% |      3x |   6.511 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |         1024 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      2x |  8.701 s |   inf% |  8.701 s |   inf% |  7.532K |  67.484 MB/s |  0.01% |      3x |   5.809 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |         1024 |      0 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      4x |  4.816 s |   inf% |  4.816 s |   inf% | 13.609K | 121.938 MB/s |  0.01% |      4x |   4.502 s |
|       16 |    4096 |        32 |            8 |        56 |          -1 |           -1 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.438 s |   inf% |  5.438 s |   inf% | 12.051K | 107.979 MB/s |  0.01% |      3x |   5.479 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |           -1 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      4x |  4.990 s |   inf% |  4.990 s |   inf% | 13.134K | 117.685 MB/s |  0.01% |      3x |   5.739 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |           -1 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.764 s |   inf% |  5.764 s |   inf% | 11.370K | 101.871 MB/s |  0.01% |      4x |   4.066 s |
|       16 |    4096 |        32 |            8 |        56 |          -1 |          128 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.034 s |   inf% |  5.034 s |   inf% | 13.019K | 116.649 MB/s |  0.01% |      3x |   5.461 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |          128 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.705 s |   inf% |  5.705 s |   inf% | 11.488K | 102.929 MB/s |  0.01% |      3x |   5.281 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |          128 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      2x |  8.878 s |   inf% |  8.878 s |   inf% |  7.382K |  66.140 MB/s |  0.01% |      3x |   5.845 s |
|       16 |    4096 |        32 |            8 |        56 |          -1 |         1024 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  7.331 s |   inf% |  7.331 s |   inf% |  8.940K |  80.100 MB/s |  0.01% |      2x |   8.753 s |
|       16 |    4096 |        32 |            8 |        56 |         128 |         1024 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  6.288 s |   inf% |  6.288 s |   inf% | 10.422K |  93.384 MB/s |  0.01% |      4x |   5.434 s |
|       16 |    4096 |        32 |            8 |        56 |        1024 |         1024 |      1 | 224.000 MiB | 56.000 MiB | 56.000 MiB | 224.000 MiB |  65536 | 962072674304 |          560 |      3x |  5.790 s |   inf% |  5.790 s |   inf% | 11.319K | 101.415 MB/s |  0.01% |      3x |   5.341 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/headdim-56.ncu-rep
Profiling: varlen/headdim-80
==PROF== Connected to process 13485 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.99s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.99s) before accumulating min_samples (3 < 10)
Pass: Cold: 6662.140299ms GPU, 6662.151579ms CPU, 19.99s total GPU, 19.99s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.17s) before accumulating min_samples (4 < 10)
Pass: Batch: 5542.451294ms GPU, 22.17s total GPU, 22.17s total wall, 4x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.03s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.03s) before accumulating min_samples (2 < 10)
Pass: Cold: 7514.667725ms GPU, 7514.680752ms CPU, 15.03s total GPU, 15.03s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.60s) before accumulating min_samples (3 < 10)
Pass: Batch: 6534.972005ms GPU, 19.60s total GPU, 19.60s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.25s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.25s) before accumulating min_samples (3 < 10)
Pass: Cold: 5749.857015ms GPU, 5749.868728ms CPU, 17.25s total GPU, 17.25s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.02s) before accumulating min_samples (3 < 10)
Pass: Batch: 7673.743815ms GPU, 23.02s total GPU, 23.02s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.37s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.37s) before accumulating min_samples (3 < 10)
Pass: Cold: 6123.494629ms GPU, 6123.506904ms CPU, 18.37s total GPU, 18.37s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.17s) before accumulating min_samples (3 < 10)
Pass: Batch: 6057.660970ms GPU, 18.17s total GPU, 18.17s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.26s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.26s) before accumulating min_samples (3 < 10)
Pass: Cold: 5754.596680ms GPU, 5754.608196ms CPU, 17.26s total GPU, 17.26s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.72s) before accumulating min_samples (3 < 10)
Pass: Batch: 5240.429199ms GPU, 15.72s total GPU, 15.72s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.79s) before accumulating min_samples (4 < 10)
Pass: Cold: 5196.676575ms GPU, 5196.688037ms CPU, 20.79s total GPU, 20.79s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.28s) before accumulating min_samples (3 < 10)
Pass: Batch: 6425.797363ms GPU, 19.28s total GPU, 19.28s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.42s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.42s) before accumulating min_samples (3 < 10)
Pass: Cold: 7138.940592ms GPU, 7138.952547ms CPU, 21.42s total GPU, 21.42s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.47s) before accumulating min_samples (3 < 10)
Pass: Batch: 6155.327474ms GPU, 18.47s total GPU, 18.47s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.62s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.62s) before accumulating min_samples (3 < 10)
Pass: Cold: 5871.868815ms GPU, 5871.880447ms CPU, 17.62s total GPU, 17.62s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 224: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.59s) before accumulating min_samples (3 < 10)
Pass: Batch: 5862.345540ms GPU, 17.59s total GPU, 17.59s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.27s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.27s) before accumulating min_samples (4 < 10)
Pass: Cold: 5066.689331ms GPU, 5066.701805ms CPU, 20.27s total GPU, 20.27s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 253: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.32s) before accumulating min_samples (3 < 10)
Pass: Batch: 5441.320638ms GPU, 16.32s total GPU, 16.32s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.22s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.22s) before accumulating min_samples (4 < 10)
Pass: Cold: 5303.820557ms GPU, 5303.833133ms CPU, 21.22s total GPU, 21.22s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.16s) before accumulating min_samples (3 < 10)
Pass: Batch: 6386.410482ms GPU, 19.16s total GPU, 19.16s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.07s) before accumulating min_samples (3 < 10)
Pass: Cold: 5690.769368ms GPU, 5690.780138ms CPU, 17.07s total GPU, 17.07s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 311: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.88s) before accumulating min_samples (4 < 10)
Pass: Batch: 3970.480164ms GPU, 15.88s total GPU, 15.88s total wall, 4x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.71s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.71s) before accumulating min_samples (3 < 10)
Pass: Cold: 5904.329264ms GPU, 5904.341065ms CPU, 17.71s total GPU, 17.71s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 339: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.25s) before accumulating min_samples (3 < 10)
Pass: Batch: 5417.778971ms GPU, 16.25s total GPU, 16.25s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.74s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.74s) before accumulating min_samples (3 < 10)
Pass: Cold: 5912.083008ms GPU, 5912.095213ms CPU, 17.74s total GPU, 17.74s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 367: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.94s) before accumulating min_samples (3 < 10)
Pass: Batch: 5979.772624ms GPU, 17.94s total GPU, 17.94s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.54s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.54s) before accumulating min_samples (3 < 10)
Pass: Cold: 5847.050293ms GPU, 5847.060833ms CPU, 17.54s total GPU, 17.54s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 395: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.70s) before accumulating min_samples (3 < 10)
Pass: Batch: 5234.583171ms GPU, 15.70s total GPU, 15.70s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.90s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.90s) before accumulating min_samples (3 < 10)
Pass: Cold: 6299.194661ms GPU, 6299.206061ms CPU, 18.90s total GPU, 18.90s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 423: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.57s) before accumulating min_samples (3 < 10)
Pass: Batch: 5857.496257ms GPU, 17.57s total GPU, 17.57s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 447: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.79s) before accumulating min_samples (3 < 10)
Pass: Cold: 5928.331380ms GPU, 5928.342603ms CPU, 17.78s total GPU, 17.79s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 451: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.92s) before accumulating min_samples (3 < 10)
Pass: Batch: 5974.902669ms GPU, 17.92s total GPU, 17.92s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 476: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.19s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.19s) before accumulating min_samples (4 < 10)
Pass: Cold: 4547.686401ms GPU, 4547.697658ms CPU, 18.19s total GPU, 18.19s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 481: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) before accumulating min_samples (4 < 10)
Pass: Batch: 4270.653320ms GPU, 17.08s total GPU, 17.08s total wall, 4x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=80 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 502: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 505: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 506: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.44s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.44s) before accumulating min_samples (4 < 10)
Pass: Cold: 4359.787720ms GPU, 4359.798947ms CPU, 17.44s total GPU, 17.44s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 507: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 508: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 509: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 510: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 511: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.82s) before accumulating min_samples (4 < 10)
Pass: Batch: 4706.099365ms GPU, 18.82s total GPU, 18.82s total wall, 4x
==PROF== Disconnected from process 13485
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            8 |        80 |          -1 |           -1 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  6.662 s |  inf% |  6.662 s |  inf% |  9.837K | 125.915 MB/s |  0.01% |      4x |   5.542 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |           -1 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      2x |  7.515 s |  inf% |  7.515 s |  inf% |  8.721K | 111.630 MB/s |  0.01% |      3x |   6.535 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |           -1 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.750 s |  inf% |  5.750 s |  inf% | 11.398K | 145.892 MB/s |  0.02% |      3x |   7.674 s |
|       16 |    4096 |        32 |            8 |        80 |          -1 |          128 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  6.124 s |  inf% |  6.123 s |  inf% | 10.702K | 136.991 MB/s |  0.01% |      3x |   6.058 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |          128 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.755 s |  inf% |  5.755 s |  inf% | 11.388K | 145.772 MB/s |  0.02% |      3x |   5.240 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |          128 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      4x |  5.197 s |  inf% |  5.197 s |  inf% | 12.611K | 161.423 MB/s |  0.02% |      3x |   6.426 s |
|       16 |    4096 |        32 |            8 |        80 |          -1 |         1024 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  7.139 s |  inf% |  7.139 s |  inf% |  9.180K | 117.505 MB/s |  0.01% |      3x |   6.155 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |         1024 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.872 s |  inf% |  5.872 s |  inf% | 11.161K | 142.861 MB/s |  0.02% |      3x |   5.862 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |         1024 |      0 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      4x |  5.067 s |  inf% |  5.067 s |  inf% | 12.935K | 165.564 MB/s |  0.02% |      3x |   5.441 s |
|       16 |    4096 |        32 |            8 |        80 |          -1 |           -1 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      4x |  5.304 s |  inf% |  5.304 s |  inf% | 12.356K | 158.162 MB/s |  0.02% |      3x |   6.386 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |           -1 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.691 s |  inf% |  5.691 s |  inf% | 11.516K | 147.407 MB/s |  0.02% |      4x |   3.970 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |           -1 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.904 s |  inf% |  5.904 s |  inf% | 11.100K | 142.076 MB/s |  0.02% |      3x |   5.418 s |
|       16 |    4096 |        32 |            8 |        80 |          -1 |          128 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.912 s |  inf% |  5.912 s |  inf% | 11.085K | 141.889 MB/s |  0.02% |      3x |   5.980 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |          128 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.847 s |  inf% |  5.847 s |  inf% | 11.208K | 143.467 MB/s |  0.02% |      3x |   5.235 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |          128 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  6.299 s |  inf% |  6.299 s |  inf% | 10.404K | 133.170 MB/s |  0.01% |      3x |   5.857 s |
|       16 |    4096 |        32 |            8 |        80 |          -1 |         1024 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      3x |  5.928 s |  inf% |  5.928 s |  inf% | 11.055K | 141.500 MB/s |  0.02% |      3x |   5.975 s |
|       16 |    4096 |        32 |            8 |        80 |         128 |         1024 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      4x |  4.548 s |  inf% |  4.548 s |  inf% | 14.411K | 184.459 MB/s |  0.02% |      4x |   4.271 s |
|       16 |    4096 |        32 |            8 |        80 |        1024 |         1024 |      1 | 320.000 MiB | 80.000 MiB | 80.000 MiB | 320.000 MiB |  65536 | 1374389534720 |          800 |      4x |  4.360 s |  inf% |  4.360 s |  inf% | 15.032K | 192.409 MB/s |  0.02% |      4x |   4.706 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/headdim-80.ncu-rep
Profiling: varlen/headdim-128
==PROF== Connected to process 13519 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.53s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.53s) before accumulating min_samples (1 < 10)
Pass: Cold: 18527.669922ms GPU, 18527.681152ms CPU, 18.53s total GPU, 18.53s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.56s) before accumulating min_samples (3 < 10)
Pass: Batch: 6518.879395ms GPU, 19.56s total GPU, 19.56s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.44s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.44s) before accumulating min_samples (2 < 10)
Pass: Cold: 8219.997559ms GPU, 8220.009034ms CPU, 16.44s total GPU, 16.44s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.67s) before accumulating min_samples (3 < 10)
Pass: Batch: 6221.861165ms GPU, 18.67s total GPU, 18.67s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.79s) before accumulating min_samples (4 < 10)
Pass: Cold: 4196.454224ms GPU, 4196.464496ms CPU, 16.79s total GPU, 16.79s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.27s) before accumulating min_samples (4 < 10)
Pass: Batch: 5317.127930ms GPU, 21.27s total GPU, 21.27s total wall, 4x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.88s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.88s) before accumulating min_samples (4 < 10)
Pass: Cold: 4719.518799ms GPU, 4719.530113ms CPU, 18.88s total GPU, 18.88s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.73s) before accumulating min_samples (3 < 10)
Pass: Batch: 5243.515625ms GPU, 15.73s total GPU, 15.73s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.87s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.87s) before accumulating min_samples (3 < 10)
Pass: Cold: 6289.877767ms GPU, 6289.889923ms CPU, 18.87s total GPU, 18.87s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.89s) before accumulating min_samples (3 < 10)
Pass: Batch: 5296.622721ms GPU, 15.89s total GPU, 15.89s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.54s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.54s) before accumulating min_samples (3 < 10)
Pass: Cold: 5512.029785ms GPU, 5512.041617ms CPU, 16.54s total GPU, 16.54s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.50s) before accumulating min_samples (4 < 10)
Pass: Batch: 4123.765442ms GPU, 16.50s total GPU, 16.50s total wall, 4x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.07s) before accumulating min_samples (1 < 10)
Pass: Cold: 15073.545898ms GPU, 15073.557398ms CPU, 15.07s total GPU, 15.07s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.56s) before accumulating min_samples (3 < 10)
Pass: Batch: 5518.505615ms GPU, 16.56s total GPU, 16.56s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.74s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.74s) before accumulating min_samples (3 < 10)
Pass: Cold: 6914.351725ms GPU, 6914.364930ms CPU, 20.74s total GPU, 20.74s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.57s) before accumulating min_samples (2 < 10)
Pass: Batch: 8784.785156ms GPU, 17.57s total GPU, 17.57s total wall, 2x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.66s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.66s) before accumulating min_samples (3 < 10)
Pass: Cold: 5220.382487ms GPU, 5220.393464ms CPU, 15.66s total GPU, 15.66s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.13s) before accumulating min_samples (3 < 10)
Pass: Batch: 5378.044515ms GPU, 16.13s total GPU, 16.13s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.68s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.68s) before accumulating min_samples (4 < 10)
Pass: Cold: 4919.027222ms GPU, 4919.038996ms CPU, 19.68s total GPU, 19.68s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 6475.510579ms GPU, 19.43s total GPU, 19.43s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.72s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.72s) before accumulating min_samples (4 < 10)
Pass: Cold: 4679.741943ms GPU, 4679.752106ms CPU, 18.72s total GPU, 18.72s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.15s) before accumulating min_samples (3 < 10)
Pass: Batch: 5384.126628ms GPU, 16.15s total GPU, 16.15s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.83s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.83s) before accumulating min_samples (4 < 10)
Pass: Cold: 5207.837769ms GPU, 5207.848649ms CPU, 20.83s total GPU, 20.83s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.47s) before accumulating min_samples (4 < 10)
Pass: Batch: 4866.245972ms GPU, 19.46s total GPU, 19.47s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.85s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.85s) before accumulating min_samples (4 < 10)
Pass: Cold: 4712.697510ms GPU, 4712.708232ms CPU, 18.85s total GPU, 18.85s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 367: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (28.31s) before accumulating min_samples (4 < 10)
Pass: Batch: 7076.907959ms GPU, 28.31s total GPU, 28.31s total wall, 4x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 383: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 387: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 391: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 392: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.31s) before accumulating min_samples (4 < 10)
Pass: Cold: 4326.267700ms GPU, 4326.277755ms CPU, 17.31s total GPU, 17.31s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 398: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.97s) before accumulating min_samples (5 < 10)
Pass: Batch: 3994.724902ms GPU, 19.97s total GPU, 19.97s total wall, 5x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 410: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 414: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 423: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.69s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.69s) before accumulating min_samples (4 < 10)
Pass: Cold: 4422.674561ms GPU, 4422.685535ms CPU, 17.69s total GPU, 17.69s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 428: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.07s) before accumulating min_samples (4 < 10)
Pass: Batch: 4517.252075ms GPU, 18.07s total GPU, 18.07s total wall, 4x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 438: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 442: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 453: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.48s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.48s) before accumulating min_samples (4 < 10)
Pass: Cold: 5621.031128ms GPU, 5621.043911ms CPU, 22.48s total GPU, 22.48s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 457: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.24s) before accumulating min_samples (3 < 10)
Pass: Batch: 5079.508301ms GPU, 15.24s total GPU, 15.24s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 466: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 470: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 481: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.48s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.48s) before accumulating min_samples (3 < 10)
Pass: Cold: 5824.983724ms GPU, 5824.995542ms CPU, 17.47s total GPU, 17.48s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 485: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.96s) before accumulating min_samples (3 < 10)
Pass: Batch: 6320.137207ms GPU, 18.96s total GPU, 18.96s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 495: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 500: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 501: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 502: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 503: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 504: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 505: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 506: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 507: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 508: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 509: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 510: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.91s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.91s) before accumulating min_samples (4 < 10)
Pass: Cold: 4476.830078ms GPU, 4476.841275ms CPU, 17.91s total GPU, 17.91s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 511: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 512: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 513: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 514: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 515: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.20s) before accumulating min_samples (4 < 10)
Pass: Batch: 4051.081421ms GPU, 16.20s total GPU, 16.20s total wall, 4x
==PROF== Disconnected from process 13519
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      1x | 18.528 s |  inf% | 18.528 s |  inf% |  3.537K |  72.442 MB/s |  0.01% |      3x |   6.519 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      2x |  8.220 s |  inf% |  8.220 s |  inf% |  7.973K | 163.282 MB/s |  0.02% |      3x |   6.222 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.196 s |  inf% |  4.196 s |  inf% | 15.617K | 319.836 MB/s |  0.03% |      4x |   5.317 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.720 s |  inf% |  4.720 s |  inf% | 13.886K | 284.389 MB/s |  0.03% |      3x |   5.244 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.290 s |  inf% |  6.290 s |  inf% | 10.419K | 213.387 MB/s |  0.02% |      3x |   5.297 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.512 s |  inf% |  5.512 s |  inf% | 11.890K | 243.500 MB/s |  0.03% |      4x |   4.124 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      1x | 15.074 s |  inf% | 15.074 s |  inf% |  4.348K |  89.042 MB/s |  0.01% |      3x |   5.519 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  6.914 s |  inf% |  6.914 s |  inf% |  9.478K | 194.115 MB/s |  0.02% |      2x |   8.785 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.220 s |  inf% |  5.220 s |  inf% | 12.554K | 257.103 MB/s |  0.03% |      3x |   5.378 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.919 s |  inf% |  4.919 s |  inf% | 13.323K | 272.854 MB/s |  0.03% |      3x |   6.476 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.680 s |  inf% |  4.680 s |  inf% | 14.004K | 286.806 MB/s |  0.03% |      3x |   5.384 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  5.208 s |  inf% |  5.208 s |  inf% | 12.584K | 257.723 MB/s |  0.03% |      4x |   4.866 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.713 s |  inf% |  4.713 s |  inf% | 13.906K | 284.800 MB/s |  0.03% |      4x |   7.077 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.326 s |  inf% |  4.326 s |  inf% | 15.148K | 310.239 MB/s |  0.03% |      5x |   3.995 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.423 s |  inf% |  4.423 s |  inf% | 14.818K | 303.476 MB/s |  0.03% |      4x |   4.517 s |
|       16 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  5.621 s |  inf% |  5.621 s |  inf% | 11.659K | 238.778 MB/s |  0.03% |      3x |   5.080 s |
|       16 |    4096 |        32 |            8 |       128 |         128 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      3x |  5.825 s |  inf% |  5.825 s |  inf% | 11.251K | 230.417 MB/s |  0.02% |      3x |   6.320 s |
|       16 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 2199023255552 |         1280 |      4x |  4.477 s |  inf% |  4.477 s |  inf% | 14.639K | 299.805 MB/s |  0.03% |      4x |   4.051 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/headdim-128.ncu-rep
Profiling: varlen/headdim-160
==PROF== Connected to process 13553 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.12s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.12s) before accumulating min_samples (2 < 10)
Pass: Cold: 11061.707764ms GPU, 11061.719419ms CPU, 22.12s total GPU, 22.12s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.54s) before accumulating min_samples (3 < 10)
Pass: Batch: 6847.428385ms GPU, 20.54s total GPU, 20.54s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.04s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.04s) before accumulating min_samples (3 < 10)
Pass: Cold: 5345.332682ms GPU, 5345.343680ms CPU, 16.04s total GPU, 16.04s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.06s) before accumulating min_samples (3 < 10)
Pass: Batch: 5352.649740ms GPU, 16.06s total GPU, 16.06s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.31s) before accumulating min_samples (2 < 10)
Pass: Cold: 10155.660400ms GPU, 10155.671082ms CPU, 20.31s total GPU, 20.31s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.43s) before accumulating min_samples (3 < 10)
Pass: Batch: 5144.068197ms GPU, 15.43s total GPU, 15.43s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.60s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.60s) before accumulating min_samples (2 < 10)
Pass: Cold: 9799.305176ms GPU, 9799.317515ms CPU, 19.60s total GPU, 19.60s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.18s) before accumulating min_samples (3 < 10)
Pass: Batch: 7726.627767ms GPU, 23.18s total GPU, 23.18s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.00s) before accumulating min_samples (3 < 10)
Pass: Cold: 5332.878418ms GPU, 5332.889547ms CPU, 16.00s total GPU, 16.00s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.09s) before accumulating min_samples (3 < 10)
Pass: Batch: 5364.928223ms GPU, 16.09s total GPU, 16.09s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.49s) before accumulating min_samples (3 < 10)
Pass: Cold: 5496.355143ms GPU, 5496.366997ms CPU, 16.49s total GPU, 16.49s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.54s) before accumulating min_samples (2 < 10)
Pass: Batch: 8768.486816ms GPU, 17.54s total GPU, 17.54s total wall, 2x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 187: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.20s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.20s) before accumulating min_samples (3 < 10)
Pass: Cold: 7067.655924ms GPU, 7067.667862ms CPU, 21.20s total GPU, 21.20s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.97s) before accumulating min_samples (2 < 10)
Pass: Batch: 7983.888428ms GPU, 15.97s total GPU, 15.97s total wall, 2x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.01s) before accumulating min_samples (3 < 10)
Pass: Cold: 5004.558594ms GPU, 5004.569749ms CPU, 15.01s total GPU, 15.01s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.48s) before accumulating min_samples (3 < 10)
Pass: Batch: 5493.715658ms GPU, 16.48s total GPU, 16.48s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 243: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.82s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.82s) before accumulating min_samples (4 < 10)
Pass: Cold: 4453.985046ms GPU, 4453.995793ms CPU, 17.82s total GPU, 17.82s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.93s) before accumulating min_samples (4 < 10)
Pass: Batch: 4733.213379ms GPU, 18.93s total GPU, 18.93s total wall, 4x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 271: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.64s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.64s) before accumulating min_samples (2 < 10)
Pass: Cold: 8317.696045ms GPU, 8317.707228ms CPU, 16.64s total GPU, 16.64s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.38s) before accumulating min_samples (2 < 10)
Pass: Batch: 9688.005127ms GPU, 19.38s total GPU, 19.38s total wall, 2x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 298: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.28s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.28s) before accumulating min_samples (3 < 10)
Pass: Cold: 5760.959473ms GPU, 5760.970102ms CPU, 17.28s total GPU, 17.28s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.50s) before accumulating min_samples (3 < 10)
Pass: Batch: 5833.680827ms GPU, 17.50s total GPU, 17.50s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 327: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.60s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.60s) before accumulating min_samples (4 < 10)
Pass: Cold: 4900.313049ms GPU, 4900.324902ms CPU, 19.60s total GPU, 19.60s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.03s) before accumulating min_samples (3 < 10)
Pass: Batch: 6008.829915ms GPU, 18.03s total GPU, 18.03s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 355: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.98s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.98s) before accumulating min_samples (3 < 10)
Pass: Cold: 6328.032878ms GPU, 6328.044749ms CPU, 18.98s total GPU, 18.98s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.43s) before accumulating min_samples (2 < 10)
Pass: Batch: 7715.332275ms GPU, 15.43s total GPU, 15.43s total wall, 2x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 366: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 371: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 372: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 373: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 374: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 375: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 376: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 377: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 378: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 379: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 380: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 381: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 382: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 383: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.07s) before accumulating min_samples (4 < 10)
Pass: Cold: 4267.434326ms GPU, 4267.444747ms CPU, 17.07s total GPU, 17.07s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 384: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 385: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 386: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 387: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.40s) before accumulating min_samples (3 < 10)
Pass: Batch: 5801.417969ms GPU, 17.40s total GPU, 17.40s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 388: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 389: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 390: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 391: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 392: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 393: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 394: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 395: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 396: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 397: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 398: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 399: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 400: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 401: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 402: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 403: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 404: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 405: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 406: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 407: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 408: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 409: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 410: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.41s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.41s) before accumulating min_samples (2 < 10)
Pass: Cold: 8206.395752ms GPU, 8206.407517ms CPU, 16.41s total GPU, 16.41s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 411: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 412: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 413: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 414: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (27.71s) before accumulating min_samples (3 < 10)
Pass: Batch: 9235.890951ms GPU, 27.71s total GPU, 27.71s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 415: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 416: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 417: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 418: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 419: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 420: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 421: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 422: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 423: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 424: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 425: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 426: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 427: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 428: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 429: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 430: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 431: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 432: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 433: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 434: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 435: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 436: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 437: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 438: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.61s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.61s) before accumulating min_samples (3 < 10)
Pass: Cold: 5868.782715ms GPU, 5868.793021ms CPU, 17.61s total GPU, 17.61s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 439: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 440: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 441: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 442: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.92s) before accumulating min_samples (3 < 10)
Pass: Batch: 5305.759603ms GPU, 15.92s total GPU, 15.92s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 443: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 444: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 445: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 446: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 447: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 448: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 449: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 450: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 451: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 452: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 453: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 454: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 455: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 456: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 457: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 458: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 459: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 460: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 461: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 462: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 463: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 464: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 465: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 466: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.69s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.69s) before accumulating min_samples (3 < 10)
Pass: Cold: 6230.040120ms GPU, 6230.051802ms CPU, 18.69s total GPU, 18.69s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 467: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 468: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 469: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 470: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.05s) before accumulating min_samples (3 < 10)
Pass: Batch: 5349.843424ms GPU, 16.05s total GPU, 16.05s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=16 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=160 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 471: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 472: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 473: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 474: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 475: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 476: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 477: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 478: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 479: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 480: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 481: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 482: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 483: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 484: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 485: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 486: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 487: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 488: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 489: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 490: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 491: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 492: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 493: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 494: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 495: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.00s) before accumulating min_samples (4 < 10)
Pass: Cold: 4499.225098ms GPU, 4499.236164ms CPU, 18.00s total GPU, 18.00s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 496: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 497: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 498: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 499: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 500: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.82s) before accumulating min_samples (4 < 10)
Pass: Batch: 5204.810425ms GPU, 20.82s total GPU, 20.82s total wall, 4x
==PROF== Disconnected from process 13553
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|       16 |    4096 |        32 |            8 |       160 |          -1 |           -1 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      2x | 11.062 s |  inf% | 11.062 s |  inf% |  5.925K | 151.669 MB/s |  0.02% |      3x |   6.847 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |           -1 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.345 s |  inf% |  5.345 s |  inf% | 12.260K | 313.867 MB/s |  0.03% |      3x |   5.353 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |           -1 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      2x | 10.156 s |  inf% | 10.156 s |  inf% |  6.453K | 165.201 MB/s |  0.02% |      3x |   5.144 s |
|       16 |    4096 |        32 |            8 |       160 |          -1 |          128 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      2x |  9.799 s |  inf% |  9.799 s |  inf% |  6.688K | 171.208 MB/s |  0.02% |      3x |   7.727 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |          128 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.333 s |  inf% |  5.333 s |  inf% | 12.289K | 314.600 MB/s |  0.03% |      3x |   5.365 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |          128 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.496 s |  inf% |  5.496 s |  inf% | 11.924K | 305.243 MB/s |  0.03% |      2x |   8.768 s |
|       16 |    4096 |        32 |            8 |       160 |          -1 |         1024 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  7.068 s |  inf% |  7.068 s |  inf% |  9.273K | 237.380 MB/s |  0.03% |      2x |   7.984 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |         1024 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.005 s |  inf% |  5.005 s |  inf% | 13.095K | 335.239 MB/s |  0.04% |      3x |   5.494 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |         1024 |      0 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      4x |  4.454 s |  inf% |  4.454 s |  inf% | 14.714K | 376.679 MB/s |  0.04% |      4x |   4.733 s |
|       16 |    4096 |        32 |            8 |       160 |          -1 |           -1 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      2x |  8.318 s |  inf% |  8.318 s |  inf% |  7.879K | 201.705 MB/s |  0.02% |      2x |   9.688 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |           -1 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.761 s |  inf% |  5.761 s |  inf% | 11.376K | 291.223 MB/s |  0.03% |      3x |   5.834 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |           -1 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      4x |  4.900 s |  inf% |  4.900 s |  inf% | 13.374K | 342.370 MB/s |  0.04% |      3x |   6.009 s |
|       16 |    4096 |        32 |            8 |       160 |          -1 |          128 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  6.328 s |  inf% |  6.328 s |  inf% | 10.356K | 265.125 MB/s |  0.03% |      2x |   7.715 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |          128 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      4x |  4.267 s |  inf% |  4.267 s |  inf% | 15.357K | 393.145 MB/s |  0.04% |      3x |   5.801 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |          128 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      2x |  8.206 s |  inf% |  8.206 s |  inf% |  7.986K | 204.441 MB/s |  0.02% |      3x |   9.236 s |
|       16 |    4096 |        32 |            8 |       160 |          -1 |         1024 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  5.869 s |  inf% |  5.869 s |  inf% | 11.167K | 285.872 MB/s |  0.03% |      3x |   5.306 s |
|       16 |    4096 |        32 |            8 |       160 |         128 |         1024 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      3x |  6.230 s |  inf% |  6.230 s |  inf% | 10.519K | 269.295 MB/s |  0.03% |      3x |   5.350 s |
|       16 |    4096 |        32 |            8 |       160 |        1024 |         1024 |      1 | 640.000 MiB | 160.000 MiB | 160.000 MiB | 640.000 MiB |  65536 | 2748779069440 |         1600 |      4x |  4.499 s |  inf% |  4.499 s |  inf% | 14.566K | 372.891 MB/s |  0.04% |      4x |   5.205 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/headdim-160.ncu-rep
Testing sequence length scaling with variable length...
Profiling: varlen/seqlen-1024
==PROF== Connected to process 13570 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.64s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.64s) before accumulating min_samples (3 < 10)
Pass: Cold: 5213.633626ms GPU, 5213.644138ms CPU, 15.64s total GPU, 15.64s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.20s) before accumulating min_samples (3 < 10)
Pass: Batch: 6734.148438ms GPU, 20.20s total GPU, 20.20s total wall, 3x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (32.75s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (32.75s) before accumulating min_samples (4 < 10)
Pass: Cold: 8186.912476ms GPU, 8186.923564ms CPU, 32.75s total GPU, 32.75s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.13s) before accumulating min_samples (2 < 10)
Pass: Batch: 8566.839355ms GPU, 17.13s total GPU, 17.13s total wall, 2x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.04s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.04s) before accumulating min_samples (4 < 10)
Pass: Cold: 5009.989685ms GPU, 5010.000030ms CPU, 20.04s total GPU, 20.04s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.66s) before accumulating min_samples (3 < 10)
Pass: Batch: 6220.820475ms GPU, 18.66s total GPU, 18.66s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.66s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.66s) before accumulating min_samples (3 < 10)
Pass: Cold: 5219.256999ms GPU, 5219.268009ms CPU, 15.66s total GPU, 15.66s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.64s) before accumulating min_samples (3 < 10)
Pass: Batch: 5212.973307ms GPU, 15.64s total GPU, 15.64s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.16s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.16s) before accumulating min_samples (3 < 10)
Pass: Cold: 6721.176107ms GPU, 6721.186747ms CPU, 20.16s total GPU, 20.16s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.04s) before accumulating min_samples (3 < 10)
Pass: Batch: 5678.418945ms GPU, 17.04s total GPU, 17.04s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.64s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.64s) before accumulating min_samples (3 < 10)
Pass: Cold: 6212.723633ms GPU, 6212.734898ms CPU, 18.64s total GPU, 18.64s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 120: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.53s) before accumulating min_samples (3 < 10)
Pass: Batch: 5843.411947ms GPU, 17.53s total GPU, 17.53s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.09s) before accumulating min_samples (3 < 10)
Pass: Cold: 5696.093424ms GPU, 5696.104352ms CPU, 17.09s total GPU, 17.09s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.81s) before accumulating min_samples (3 < 10)
Pass: Batch: 5270.777832ms GPU, 15.81s total GPU, 15.81s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.57s) before accumulating min_samples (3 < 10)
Pass: Cold: 5190.257324ms GPU, 5190.267182ms CPU, 15.57s total GPU, 15.57s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.61s) before accumulating min_samples (4 < 10)
Pass: Batch: 4151.764038ms GPU, 16.61s total GPU, 16.61s total wall, 4x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 177: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.73s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.73s) before accumulating min_samples (3 < 10)
Pass: Cold: 5908.768066ms GPU, 5908.779093ms CPU, 17.73s total GPU, 17.73s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 180: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.19s) before accumulating min_samples (2 < 10)
Pass: Batch: 8595.670410ms GPU, 17.19s total GPU, 17.19s total wall, 2x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 197: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.71s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.71s) before accumulating min_samples (4 < 10)
Pass: Cold: 4926.757812ms GPU, 4926.767842ms CPU, 19.71s total GPU, 19.71s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 202: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.89s) before accumulating min_samples (4 < 10)
Pass: Batch: 4223.313232ms GPU, 16.89s total GPU, 16.89s total wall, 4x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.51s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.51s) before accumulating min_samples (4 < 10)
Pass: Cold: 4627.974731ms GPU, 4627.985063ms CPU, 18.51s total GPU, 18.51s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 223: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) before accumulating min_samples (3 < 10)
Pass: Batch: 5693.087402ms GPU, 17.08s total GPU, 17.08s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 239: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.56s) before accumulating min_samples (3 < 10)
Pass: Cold: 5185.903971ms GPU, 5185.913606ms CPU, 15.56s total GPU, 15.56s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 243: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.11s) before accumulating min_samples (3 < 10)
Pass: Batch: 5704.631673ms GPU, 17.11s total GPU, 17.11s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 259: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.90s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.90s) before accumulating min_samples (3 < 10)
Pass: Cold: 5633.423014ms GPU, 5633.433105ms CPU, 16.90s total GPU, 16.90s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 264: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.75s) before accumulating min_samples (4 < 10)
Pass: Batch: 4187.696655ms GPU, 16.75s total GPU, 16.75s total wall, 4x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.47s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.47s) before accumulating min_samples (4 < 10)
Pass: Cold: 3867.451416ms GPU, 3867.461518ms CPU, 15.47s total GPU, 15.47s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 286: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.54s) before accumulating min_samples (4 < 10)
Pass: Batch: 4635.971680ms GPU, 18.54s total GPU, 18.54s total wall, 4x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.60s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.60s) before accumulating min_samples (4 < 10)
Pass: Cold: 3899.516724ms GPU, 3899.527337ms CPU, 15.60s total GPU, 15.60s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.66s) before accumulating min_samples (3 < 10)
Pass: Batch: 6219.486165ms GPU, 18.66s total GPU, 18.66s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 323: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.96s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.96s) before accumulating min_samples (3 < 10)
Pass: Cold: 5320.658691ms GPU, 5320.669270ms CPU, 15.96s total GPU, 15.96s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.28s) before accumulating min_samples (5 < 10)
Pass: Batch: 3456.705811ms GPU, 17.28s total GPU, 17.28s total wall, 5x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 346: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.59s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.59s) before accumulating min_samples (4 < 10)
Pass: Cold: 4647.101746ms GPU, 4647.111847ms CPU, 18.59s total GPU, 18.59s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 350: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.90s) before accumulating min_samples (3 < 10)
Pass: Batch: 5298.864258ms GPU, 15.90s total GPU, 15.90s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 366: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.08s) before accumulating min_samples (3 < 10)
Pass: Cold: 5692.904785ms GPU, 5692.914598ms CPU, 17.08s total GPU, 17.08s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 367: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 368: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 369: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 370: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 371: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.20s) before accumulating min_samples (4 < 10)
Pass: Batch: 5049.721924ms GPU, 20.20s total GPU, 20.20s total wall, 4x
==PROF== Disconnected from process 13570
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens | Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|-------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    1024 |        32 |            8 |       128 |          -1 |           -1 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.214 s |  inf% |  5.214 s |  inf% | 1.571K |  32.180 MB/s |  0.00% |      3x |   6.734 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |           -1 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  8.187 s |  inf% |  8.187 s |  inf% | 1.001K |  20.493 MB/s |  0.00% |      2x |   8.567 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |           -1 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  5.010 s |  inf% |  5.010 s |  inf% | 1.635K |  33.488 MB/s |  0.00% |      3x |   6.221 s |
|        8 |    1024 |        32 |            8 |       128 |          -1 |          128 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.219 s |  inf% |  5.219 s |  inf% | 1.570K |  32.145 MB/s |  0.00% |      3x |   5.213 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |          128 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  6.721 s |  inf% |  6.721 s |  inf% | 1.219K |  24.962 MB/s |  0.00% |      3x |   5.678 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |          128 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  6.213 s |  inf% |  6.213 s |  inf% | 1.319K |  27.005 MB/s |  0.00% |      3x |   5.843 s |
|        8 |    1024 |        32 |            8 |       128 |          -1 |         1024 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.696 s |  inf% |  5.696 s |  inf% | 1.438K |  29.454 MB/s |  0.00% |      3x |   5.271 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |         1024 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.190 s |  inf% |  5.190 s |  inf% | 1.578K |  32.324 MB/s |  0.00% |      4x |   4.152 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.909 s |  inf% |  5.909 s |  inf% | 1.386K |  28.394 MB/s |  0.00% |      2x |   8.596 s |
|        8 |    1024 |        32 |            8 |       128 |          -1 |           -1 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  4.927 s |  inf% |  4.927 s |  inf% | 1.663K |  34.053 MB/s |  0.00% |      4x |   4.223 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |           -1 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  4.628 s |  inf% |  4.628 s |  inf% | 1.770K |  36.252 MB/s |  0.00% |      3x |   5.693 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |           -1 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.186 s |  inf% |  5.186 s |  inf% | 1.580K |  32.352 MB/s |  0.00% |      3x |   5.705 s |
|        8 |    1024 |        32 |            8 |       128 |          -1 |          128 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.633 s |  inf% |  5.633 s |  inf% | 1.454K |  29.782 MB/s |  0.00% |      4x |   4.188 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |          128 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  3.867 s |  inf% |  3.867 s |  inf% | 2.118K |  43.381 MB/s |  0.00% |      4x |   4.636 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |          128 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  3.900 s |  inf% |  3.900 s |  inf% | 2.101K |  43.024 MB/s |  0.00% |      3x |   6.219 s |
|        8 |    1024 |        32 |            8 |       128 |          -1 |         1024 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.321 s |  inf% |  5.321 s |  inf% | 1.540K |  31.532 MB/s |  0.00% |      5x |   3.457 s |
|        8 |    1024 |        32 |            8 |       128 |         128 |         1024 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      4x |  4.647 s |  inf% |  4.647 s |  inf% | 1.763K |  36.103 MB/s |  0.00% |      3x |   5.299 s |
|        8 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 68719476736 |          160 |      3x |  5.693 s |  inf% |  5.693 s |  inf% | 1.439K |  29.470 MB/s |  0.00% |      4x |   5.050 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/seqlen-1024.ncu-rep
Profiling: varlen/seqlen-4096
==PROF== Connected to process 13604 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.92s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.92s) before accumulating min_samples (3 < 10)
Pass: Cold: 5638.818197ms GPU, 5638.829285ms CPU, 16.92s total GPU, 16.92s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.75s) before accumulating min_samples (2 < 10)
Pass: Batch: 8374.052979ms GPU, 16.75s total GPU, 16.75s total wall, 2x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.95s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.95s) before accumulating min_samples (3 < 10)
Pass: Cold: 5984.691895ms GPU, 5984.703235ms CPU, 17.95s total GPU, 17.95s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.70s) before accumulating min_samples (4 < 10)
Pass: Batch: 4425.367249ms GPU, 17.70s total GPU, 17.70s total wall, 4x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.74s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.74s) before accumulating min_samples (2 < 10)
Pass: Cold: 8868.262695ms GPU, 8868.277124ms CPU, 17.74s total GPU, 17.74s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.39s) before accumulating min_samples (3 < 10)
Pass: Batch: 6462.385579ms GPU, 19.39s total GPU, 19.39s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.07s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.07s) before accumulating min_samples (2 < 10)
Pass: Cold: 8036.618652ms GPU, 8036.630928ms CPU, 16.07s total GPU, 16.07s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.88s) before accumulating min_samples (4 < 10)
Pass: Batch: 4470.921936ms GPU, 17.88s total GPU, 17.88s total wall, 4x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.46s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.46s) before accumulating min_samples (3 < 10)
Pass: Cold: 5820.327637ms GPU, 5820.337866ms CPU, 17.46s total GPU, 17.46s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.74s) before accumulating min_samples (3 < 10)
Pass: Batch: 5247.702311ms GPU, 15.74s total GPU, 15.74s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.13s) before accumulating min_samples (2 < 10)
Pass: Cold: 8566.968750ms GPU, 8566.980049ms CPU, 17.13s total GPU, 17.13s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.01s) before accumulating min_samples (3 < 10)
Pass: Batch: 5337.063802ms GPU, 16.01s total GPU, 16.01s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.43s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.43s) before accumulating min_samples (3 < 10)
Pass: Cold: 6476.514811ms GPU, 6476.525792ms CPU, 19.43s total GPU, 19.43s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.93s) before accumulating min_samples (4 < 10)
Pass: Batch: 4231.681702ms GPU, 16.93s total GPU, 16.93s total wall, 4x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.91s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.91s) before accumulating min_samples (4 < 10)
Pass: Cold: 3977.215271ms GPU, 3977.225906ms CPU, 15.91s total GPU, 15.91s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.92s) before accumulating min_samples (2 < 10)
Pass: Batch: 7959.370850ms GPU, 15.92s total GPU, 15.92s total wall, 2x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.65s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.65s) before accumulating min_samples (2 < 10)
Pass: Cold: 10324.788086ms GPU, 10324.799657ms CPU, 20.65s total GPU, 20.65s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 177: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.02s) before accumulating min_samples (3 < 10)
Pass: Batch: 6340.220703ms GPU, 19.02s total GPU, 19.02s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.95s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.95s) before accumulating min_samples (3 < 10)
Pass: Cold: 5983.369141ms GPU, 5983.380776ms CPU, 17.95s total GPU, 17.95s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 198: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.35s) before accumulating min_samples (4 < 10)
Pass: Batch: 4838.719482ms GPU, 19.35s total GPU, 19.35s total wall, 4x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.46s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.46s) before accumulating min_samples (3 < 10)
Pass: Cold: 5818.577474ms GPU, 5818.587575ms CPU, 17.46s total GPU, 17.46s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.27s) before accumulating min_samples (4 < 10)
Pass: Batch: 5067.014648ms GPU, 20.27s total GPU, 20.27s total wall, 4x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 236: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.19s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.19s) before accumulating min_samples (4 < 10)
Pass: Cold: 4296.920776ms GPU, 4296.931582ms CPU, 17.19s total GPU, 17.19s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 241: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.12s) before accumulating min_samples (4 < 10)
Pass: Batch: 4281.108521ms GPU, 17.12s total GPU, 17.12s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 258: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.74s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.74s) before accumulating min_samples (4 < 10)
Pass: Cold: 5434.832458ms GPU, 5434.843679ms CPU, 21.74s total GPU, 21.74s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 261: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.17s) before accumulating min_samples (2 < 10)
Pass: Batch: 11584.906982ms GPU, 23.17s total GPU, 23.17s total wall, 2x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.29s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.29s) before accumulating min_samples (4 < 10)
Pass: Cold: 5571.304199ms GPU, 5571.313702ms CPU, 22.29s total GPU, 22.29s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.37s) before accumulating min_samples (3 < 10)
Pass: Batch: 5458.023600ms GPU, 16.37s total GPU, 16.37s total wall, 3x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 298: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.96s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.96s) before accumulating min_samples (3 < 10)
Pass: Cold: 6318.775065ms GPU, 6318.785645ms CPU, 18.96s total GPU, 18.96s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.11s) before accumulating min_samples (2 < 10)
Pass: Batch: 10052.799805ms GPU, 20.11s total GPU, 20.11s total wall, 2x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 317: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.48s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.48s) before accumulating min_samples (3 < 10)
Pass: Cold: 5827.267578ms GPU, 5827.278893ms CPU, 17.48s total GPU, 17.48s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 322: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.79s) before accumulating min_samples (4 < 10)
Pass: Batch: 5196.819702ms GPU, 20.79s total GPU, 20.79s total wall, 4x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.40s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.40s) before accumulating min_samples (3 < 10)
Pass: Cold: 5800.955078ms GPU, 5800.965246ms CPU, 17.40s total GPU, 17.40s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 342: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.83s) before accumulating min_samples (3 < 10)
Pass: Batch: 5278.138997ms GPU, 15.83s total GPU, 15.83s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.49s) before accumulating min_samples (3 < 10)
Pass: Cold: 6163.718262ms GPU, 6163.728923ms CPU, 18.49s total GPU, 18.49s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.37s) before accumulating min_samples (3 < 10)
Pass: Batch: 5788.737793ms GPU, 17.37s total GPU, 17.37s total wall, 3x
==PROF== Disconnected from process 13604
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor  |  V Tensor  |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|------------|------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|--------|--------------|--------|---------|-----------|
|        8 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.639 s |  inf% |  5.639 s |  inf% | 5.811K | 119.012 MB/s |  0.01% |      2x |   8.374 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.985 s |  inf% |  5.985 s |  inf% | 5.475K | 112.134 MB/s |  0.01% |      4x |   4.425 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      2x |  8.868 s |  inf% |  8.868 s |  inf% | 3.695K |  75.673 MB/s |  0.01% |      3x |   6.462 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      2x |  8.037 s |  inf% |  8.037 s |  inf% | 4.077K |  83.504 MB/s |  0.01% |      4x |   4.471 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.820 s |  inf% |  5.820 s |  inf% | 5.630K | 115.301 MB/s |  0.01% |      3x |   5.248 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |          128 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      2x |  8.567 s |  inf% |  8.567 s |  inf% | 3.825K |  78.334 MB/s |  0.01% |      3x |   5.337 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.477 s |  inf% |  6.477 s |  inf% | 5.060K | 103.619 MB/s |  0.01% |      4x |   4.232 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  3.977 s |  inf% |  3.977 s |  inf% | 8.239K | 168.733 MB/s |  0.02% |      2x |   7.959 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      2x | 10.325 s |  inf% | 10.325 s |  inf% | 3.174K |  64.998 MB/s |  0.01% |      3x |   6.340 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.983 s |  inf% |  5.983 s |  inf% | 5.477K | 112.159 MB/s |  0.01% |      4x |   4.839 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.819 s |  inf% |  5.819 s |  inf% | 5.632K | 115.336 MB/s |  0.01% |      4x |   5.067 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |           -1 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  4.297 s |  inf% |  4.297 s |  inf% | 7.626K | 156.179 MB/s |  0.02% |      4x |   4.281 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  5.435 s |  inf% |  5.435 s |  inf% | 6.029K | 123.479 MB/s |  0.01% |      2x |  11.585 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      4x |  5.571 s |  inf% |  5.571 s |  inf% | 5.882K | 120.454 MB/s |  0.01% |      3x |   5.458 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |          128 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.319 s |  inf% |  6.319 s |  inf% | 5.186K | 106.205 MB/s |  0.01% |      2x |  10.053 s |
|        8 |    4096 |        32 |            8 |       128 |          -1 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.827 s |  inf% |  5.827 s |  inf% | 5.623K | 115.164 MB/s |  0.01% |      4x |   5.197 s |
|        8 |    4096 |        32 |            8 |       128 |         128 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  5.801 s |  inf% |  5.801 s |  inf% | 5.649K | 115.686 MB/s |  0.01% |      3x |   5.278 s |
|        8 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 256.000 MiB | 64.000 MiB | 64.000 MiB | 256.000 MiB |  32768 | 1099511627776 |          640 |      3x |  6.164 s |  inf% |  6.164 s |  inf% | 5.316K | 108.877 MB/s |  0.01% |      3x |   5.789 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/seqlen-4096.ncu-rep
Profiling: varlen/seqlen-8192
==PROF== Connected to process 13638 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.93s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.93s) before accumulating min_samples (4 < 10)
Pass: Cold: 4982.270630ms GPU, 4982.281698ms CPU, 19.93s total GPU, 19.93s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.01s) before accumulating min_samples (2 < 10)
Pass: Batch: 11503.293945ms GPU, 23.01s total GPU, 23.01s total wall, 2x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.35s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.35s) before accumulating min_samples (3 < 10)
Pass: Cold: 5782.448893ms GPU, 5782.460657ms CPU, 17.35s total GPU, 17.35s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.18s) before accumulating min_samples (3 < 10)
Pass: Batch: 5726.710531ms GPU, 17.18s total GPU, 17.18s total wall, 3x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.20s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.20s) before accumulating min_samples (3 < 10)
Pass: Cold: 5399.084391ms GPU, 5399.096374ms CPU, 16.20s total GPU, 16.20s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.69s) before accumulating min_samples (3 < 10)
Pass: Batch: 6897.202474ms GPU, 20.69s total GPU, 20.69s total wall, 3x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.12s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.12s) before accumulating min_samples (1 < 10)
Pass: Cold: 18119.931641ms GPU, 18119.943305ms CPU, 18.12s total GPU, 18.12s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.98s) before accumulating min_samples (3 < 10)
Pass: Batch: 6325.597819ms GPU, 18.98s total GPU, 18.98s total wall, 3x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.98s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.98s) before accumulating min_samples (3 < 10)
Pass: Cold: 5328.184408ms GPU, 5328.193051ms CPU, 15.98s total GPU, 15.98s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.03s) before accumulating min_samples (3 < 10)
Pass: Batch: 6676.347493ms GPU, 20.03s total GPU, 20.03s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.02s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.02s) before accumulating min_samples (3 < 10)
Pass: Cold: 5005.862956ms GPU, 5005.873090ms CPU, 15.02s total GPU, 15.02s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.86s) before accumulating min_samples (3 < 10)
Pass: Batch: 5953.782389ms GPU, 17.86s total GPU, 17.86s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.91s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.91s) before accumulating min_samples (3 < 10)
Pass: Cold: 5970.746094ms GPU, 5970.756165ms CPU, 17.91s total GPU, 17.91s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.18s) before accumulating min_samples (3 < 10)
Pass: Batch: 6394.895020ms GPU, 19.18s total GPU, 19.18s total wall, 3x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.29s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.29s) before accumulating min_samples (3 < 10)
Pass: Cold: 5429.269775ms GPU, 5429.280688ms CPU, 16.29s total GPU, 16.29s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.28s) before accumulating min_samples (2 < 10)
Pass: Batch: 11642.433350ms GPU, 23.28s total GPU, 23.28s total wall, 2x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.02s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.02s) before accumulating min_samples (4 < 10)
Pass: Cold: 5006.071350ms GPU, 5006.082850ms CPU, 20.02s total GPU, 20.02s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 178: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.06s) before accumulating min_samples (4 < 10)
Pass: Batch: 4263.850220ms GPU, 17.06s total GPU, 17.06s total wall, 4x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.57s) before accumulating min_samples (3 < 10)
Pass: Cold: 5522.212240ms GPU, 5522.222757ms CPU, 16.57s total GPU, 16.57s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 199: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.69s) before accumulating min_samples (4 < 10)
Pass: Batch: 4673.469910ms GPU, 18.69s total GPU, 18.69s total wall, 4x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.72s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.72s) before accumulating min_samples (3 < 10)
Pass: Cold: 5907.122233ms GPU, 5907.133601ms CPU, 17.72s total GPU, 17.72s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 220: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.14s) before accumulating min_samples (4 < 10)
Pass: Batch: 5035.388794ms GPU, 20.14s total GPU, 20.14s total wall, 4x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 236: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.81s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.81s) before accumulating min_samples (3 < 10)
Pass: Cold: 5936.696777ms GPU, 5936.708820ms CPU, 17.81s total GPU, 17.81s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 240: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.11s) before accumulating min_samples (3 < 10)
Pass: Batch: 6035.855469ms GPU, 18.11s total GPU, 18.11s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 255: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.18s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (24.18s) before accumulating min_samples (2 < 10)
Pass: Cold: 12088.442383ms GPU, 12088.453237ms CPU, 24.18s total GPU, 24.18s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 259: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.69s) before accumulating min_samples (3 < 10)
Pass: Batch: 5898.241374ms GPU, 17.69s total GPU, 17.69s total wall, 3x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.71s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.71s) before accumulating min_samples (4 < 10)
Pass: Cold: 3928.498779ms GPU, 3928.509248ms CPU, 15.71s total GPU, 15.71s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.02s) before accumulating min_samples (5 < 10)
Pass: Batch: 4003.986670ms GPU, 20.02s total GPU, 20.02s total wall, 5x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.13s) before accumulating min_samples (4 < 10)
Pass: Cold: 4782.075195ms GPU, 4782.086145ms CPU, 19.13s total GPU, 19.13s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.06s) before accumulating min_samples (3 < 10)
Pass: Batch: 5020.032308ms GPU, 15.06s total GPU, 15.06s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 319: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.97s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.97s) before accumulating min_samples (3 < 10)
Pass: Cold: 6991.429687ms GPU, 6991.440268ms CPU, 20.97s total GPU, 20.97s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 323: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.01s) before accumulating min_samples (3 < 10)
Pass: Batch: 5004.966960ms GPU, 15.01s total GPU, 15.01s total wall, 3x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 332: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 340: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.80s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.80s) before accumulating min_samples (4 < 10)
Pass: Cold: 4200.276001ms GPU, 4200.286863ms CPU, 16.80s total GPU, 16.80s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 345: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.74s) before accumulating min_samples (4 < 10)
Pass: Batch: 4684.579834ms GPU, 18.74s total GPU, 18.74s total wall, 4x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 353: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 359: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 360: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 361: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.65s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.65s) before accumulating min_samples (3 < 10)
Pass: Cold: 5882.423665ms GPU, 5882.435817ms CPU, 17.65s total GPU, 17.65s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 362: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 363: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 364: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 365: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.57s) before accumulating min_samples (3 < 10)
Pass: Batch: 5521.772949ms GPU, 16.57s total GPU, 16.57s total wall, 3x
==PROF== Disconnected from process 13638
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |  Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|---------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|        8 |    8192 |        32 |            8 |       128 |          -1 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      4x |  4.982 s |  inf% |  4.982 s |  inf% | 13.154K | 269.391 MB/s |  0.03% |      2x |  11.503 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.782 s |  inf% |  5.782 s |  inf% | 11.334K | 232.112 MB/s |  0.02% |      3x |   5.727 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |           -1 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.399 s |  inf% |  5.399 s |  inf% | 12.138K | 248.593 MB/s |  0.03% |      3x |   6.897 s |
|        8 |    8192 |        32 |            8 |       128 |          -1 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      1x | 18.120 s |  inf% | 18.120 s |  inf% |  3.617K |  74.072 MB/s |  0.01% |      3x |   6.326 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.328 s |  inf% |  5.328 s |  inf% | 12.300K | 251.901 MB/s |  0.03% |      3x |   6.676 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |          128 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.006 s |  inf% |  5.006 s |  inf% | 13.092K | 268.121 MB/s |  0.03% |      3x |   5.954 s |
|        8 |    8192 |        32 |            8 |       128 |          -1 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.971 s |  inf% |  5.971 s |  inf% | 10.976K | 224.792 MB/s |  0.02% |      3x |   6.395 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.429 s |  inf% |  5.429 s |  inf% | 12.071K | 247.211 MB/s |  0.03% |      2x |  11.642 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      0 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      4x |  5.006 s |  inf% |  5.006 s |  inf% | 13.091K | 268.110 MB/s |  0.03% |      4x |   4.264 s |
|        8 |    8192 |        32 |            8 |       128 |          -1 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.522 s |  inf% |  5.522 s |  inf% | 11.868K | 243.051 MB/s |  0.03% |      4x |   4.673 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.907 s |  inf% |  5.907 s |  inf% | 11.094K | 227.213 MB/s |  0.02% |      4x |   5.035 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |           -1 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.937 s |  inf% |  5.937 s |  inf% | 11.039K | 226.081 MB/s |  0.02% |      3x |   6.036 s |
|        8 |    8192 |        32 |            8 |       128 |          -1 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      2x | 12.088 s |  inf% | 12.088 s |  inf% |  5.421K | 111.030 MB/s |  0.01% |      3x |   5.898 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      4x |  3.929 s |  inf% |  3.928 s |  inf% | 16.682K | 341.651 MB/s |  0.04% |      5x |   4.004 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |          128 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      4x |  4.782 s |  inf% |  4.782 s |  inf% | 13.705K | 280.668 MB/s |  0.03% |      3x |   5.020 s |
|        8 |    8192 |        32 |            8 |       128 |          -1 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  6.991 s |  inf% |  6.991 s |  inf% |  9.374K | 191.975 MB/s |  0.02% |      3x |   5.005 s |
|        8 |    8192 |        32 |            8 |       128 |         128 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      4x |  4.200 s |  inf% |  4.200 s |  inf% | 15.603K | 319.545 MB/s |  0.03% |      4x |   4.685 s |
|        8 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      1 | 512.000 MiB | 128.000 MiB | 128.000 MiB | 512.000 MiB |  65536 | 4398046511104 |         1280 |      3x |  5.882 s |  inf% |  5.882 s |  inf% | 11.141K | 228.167 MB/s |  0.02% |      3x |   5.522 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/seqlen-8192.ncu-rep
Profiling: varlen/seqlen-16384
==PROF== Connected to process 13655 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.44s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.44s) before accumulating min_samples (2 < 10)
Pass: Cold: 11221.098145ms GPU, 11221.110421ms CPU, 22.44s total GPU, 22.44s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.78s) before accumulating min_samples (2 < 10)
Pass: Batch: 9887.985840ms GPU, 19.78s total GPU, 19.78s total wall, 2x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.00s) before accumulating min_samples (2 < 10)
Pass: Cold: 8001.376709ms GPU, 8001.387452ms CPU, 16.00s total GPU, 16.00s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.94s) before accumulating min_samples (2 < 10)
Pass: Batch: 7970.765381ms GPU, 15.94s total GPU, 15.94s total wall, 2x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.80s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.80s) before accumulating min_samples (2 < 10)
Pass: Cold: 8398.822754ms GPU, 8398.837524ms CPU, 16.80s total GPU, 16.80s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.32s) before accumulating min_samples (2 < 10)
Pass: Batch: 7658.160156ms GPU, 15.32s total GPU, 15.32s total wall, 2x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 68: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.46s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.46s) before accumulating min_samples (2 < 10)
Pass: Cold: 8730.655273ms GPU, 8730.669937ms CPU, 17.46s total GPU, 17.46s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.98s) before accumulating min_samples (2 < 10)
Pass: Batch: 9489.955078ms GPU, 18.98s total GPU, 18.98s total wall, 2x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.89s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.89s) before accumulating min_samples (4 < 10)
Pass: Cold: 5223.544189ms GPU, 5223.557593ms CPU, 20.89s total GPU, 20.89s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.00s) before accumulating min_samples (4 < 10)
Pass: Batch: 3750.020020ms GPU, 15.00s total GPU, 15.00s total wall, 4x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.56s) before accumulating min_samples (4 < 10)
Pass: Cold: 4889.827026ms GPU, 4889.838627ms CPU, 19.56s total GPU, 19.56s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.31s) before accumulating min_samples (4 < 10)
Pass: Batch: 4828.585815ms GPU, 19.31s total GPU, 19.31s total wall, 4x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.88s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.88s) before accumulating min_samples (2 < 10)
Pass: Cold: 8437.865234ms GPU, 8437.879276ms CPU, 16.88s total GPU, 16.88s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.93s) before accumulating min_samples (2 < 10)
Pass: Batch: 8464.281250ms GPU, 16.93s total GPU, 16.93s total wall, 2x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.68s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.68s) before accumulating min_samples (4 < 10)
Pass: Cold: 4919.934692ms GPU, 4919.947857ms CPU, 19.68s total GPU, 19.68s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.66s) before accumulating min_samples (4 < 10)
Pass: Batch: 4914.110840ms GPU, 19.66s total GPU, 19.66s total wall, 4x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 171: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.01s) before accumulating min_samples (3 < 10)
Pass: Cold: 6669.364909ms GPU, 6669.376671ms CPU, 20.01s total GPU, 20.01s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 175: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.34s) before accumulating min_samples (3 < 10)
Pass: Batch: 6779.953451ms GPU, 20.34s total GPU, 20.34s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.36s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.36s) before accumulating min_samples (3 < 10)
Pass: Cold: 7120.122233ms GPU, 7120.134699ms CPU, 21.36s total GPU, 21.36s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.23s) before accumulating min_samples (3 < 10)
Pass: Batch: 7077.098307ms GPU, 21.23s total GPU, 21.23s total wall, 3x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 211: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (26.79s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (26.79s) before accumulating min_samples (4 < 10)
Pass: Cold: 6697.153687ms GPU, 6697.167152ms CPU, 26.79s total GPU, 26.79s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 216: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.27s) before accumulating min_samples (3 < 10)
Pass: Batch: 7091.642741ms GPU, 21.27s total GPU, 21.27s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 229: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 231: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 233: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.57s) before accumulating min_samples (4 < 10)
Pass: Cold: 4393.236877ms GPU, 4393.247640ms CPU, 17.57s total GPU, 17.57s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 238: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.02s) before accumulating min_samples (4 < 10)
Pass: Batch: 4754.287109ms GPU, 19.02s total GPU, 19.02s total wall, 4x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 248: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 254: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.81s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.81s) before accumulating min_samples (3 < 10)
Pass: Cold: 6269.393229ms GPU, 6269.404639ms CPU, 18.81s total GPU, 18.81s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 257: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.35s) before accumulating min_samples (2 < 10)
Pass: Batch: 8676.932129ms GPU, 17.35s total GPU, 17.35s total wall, 2x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 266: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 269: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 274: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.08s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.08s) before accumulating min_samples (4 < 10)
Pass: Cold: 4768.731934ms GPU, 4768.742790ms CPU, 19.07s total GPU, 19.08s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 277: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.78s) before accumulating min_samples (2 < 10)
Pass: Batch: 9391.600586ms GPU, 18.78s total GPU, 18.78s total wall, 2x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 283: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 285: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 292: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.91s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.91s) before accumulating min_samples (2 < 10)
Pass: Cold: 8454.498291ms GPU, 8454.510872ms CPU, 16.91s total GPU, 16.91s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 296: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (30.50s) before accumulating min_samples (3 < 10)
Pass: Batch: 10165.738932ms GPU, 30.50s total GPU, 30.50s total wall, 3x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 302: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 307: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 312: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.56s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.56s) before accumulating min_samples (3 < 10)
Pass: Cold: 7520.286296ms GPU, 7520.298628ms CPU, 22.56s total GPU, 22.56s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 315: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.40s) before accumulating min_samples (2 < 10)
Pass: Batch: 10701.089111ms GPU, 21.40s total GPU, 21.40s total wall, 2x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 323: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 329: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 330: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 331: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 332: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.37s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.37s) before accumulating min_samples (4 < 10)
Pass: Cold: 4341.798645ms GPU, 4341.810053ms CPU, 17.37s total GPU, 17.37s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 333: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 334: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 335: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 336: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.01s) before accumulating min_samples (3 < 10)
Pass: Batch: 6335.983724ms GPU, 19.01s total GPU, 19.01s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 337: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 338: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 339: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 340: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 341: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 342: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 343: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 344: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 345: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 346: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 347: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 348: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 349: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 350: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 351: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 352: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 353: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.19s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.19s) before accumulating min_samples (4 < 10)
Pass: Cold: 4796.418213ms GPU, 4796.428442ms CPU, 19.19s total GPU, 19.19s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 354: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 355: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 356: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 357: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 358: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.20s) before accumulating min_samples (4 < 10)
Pass: Batch: 4800.750366ms GPU, 19.20s total GPU, 19.20s total wall, 4x
==PROF== Disconnected from process 13655
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal | Q Tensor  |  K Tensor   |  V Tensor   |  Output   | Tokens |   Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-----------|-------------|-------------|-----------|--------|----------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|        8 |   16384 |        32 |            8 |       128 |          -1 |           -1 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x | 11.221 s |  inf% | 11.221 s |  inf% | 11.681K | 239.224 MB/s |  0.03% |      2x |   9.888 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |           -1 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x |  8.001 s |  inf% |  8.001 s |  inf% | 16.381K | 335.487 MB/s |  0.04% |      2x |   7.971 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |           -1 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x |  8.399 s |  inf% |  8.399 s |  inf% | 15.606K | 319.611 MB/s |  0.03% |      2x |   7.658 s |
|        8 |   16384 |        32 |            8 |       128 |          -1 |          128 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x |  8.731 s |  inf% |  8.731 s |  inf% | 15.013K | 307.463 MB/s |  0.03% |      2x |   9.490 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |          128 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  5.224 s |  inf% |  5.224 s |  inf% | 25.093K | 513.895 MB/s |  0.06% |      4x |   3.750 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |          128 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.890 s |  inf% |  4.890 s |  inf% | 26.805K | 548.967 MB/s |  0.06% |      4x |   4.829 s |
|        8 |   16384 |        32 |            8 |       128 |          -1 |         1024 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x |  8.438 s |  inf% |  8.438 s |  inf% | 15.534K | 318.132 MB/s |  0.03% |      2x |   8.464 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |         1024 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.920 s |  inf% |  4.920 s |  inf% | 26.641K | 545.608 MB/s |  0.06% |      4x |   4.914 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |         1024 |      0 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      3x |  6.669 s |  inf% |  6.669 s |  inf% | 19.653K | 402.490 MB/s |  0.04% |      3x |   6.780 s |
|        8 |   16384 |        32 |            8 |       128 |          -1 |           -1 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      3x |  7.120 s |  inf% |  7.120 s |  inf% | 18.409K | 377.010 MB/s |  0.04% |      3x |   7.077 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |           -1 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  6.697 s |  inf% |  6.697 s |  inf% | 19.571K | 400.820 MB/s |  0.04% |      3x |   7.092 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |           -1 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.393 s |  inf% |  4.393 s |  inf% | 29.835K | 611.020 MB/s |  0.07% |      4x |   4.754 s |
|        8 |   16384 |        32 |            8 |       128 |          -1 |          128 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      3x |  6.269 s |  inf% |  6.269 s |  inf% | 20.907K | 428.168 MB/s |  0.05% |      2x |   8.677 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |          128 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.769 s |  inf% |  4.769 s |  inf% | 27.486K | 562.907 MB/s |  0.06% |      2x |   9.392 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |          128 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      2x |  8.455 s |  inf% |  8.454 s |  inf% | 15.503K | 317.506 MB/s |  0.03% |      3x |  10.166 s |
|        8 |   16384 |        32 |            8 |       128 |          -1 |         1024 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      3x |  7.520 s |  inf% |  7.520 s |  inf% | 17.429K | 356.948 MB/s |  0.04% |      2x |  10.701 s |
|        8 |   16384 |        32 |            8 |       128 |         128 |         1024 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.342 s |  inf% |  4.342 s |  inf% | 30.188K | 618.259 MB/s |  0.07% |      3x |   6.336 s |
|        8 |   16384 |        32 |            8 |       128 |        1024 |         1024 |      1 | 1.000 GiB | 256.000 MiB | 256.000 MiB | 1.000 GiB | 131072 | 17592186044416 |         2560 |      4x |  4.796 s |  inf% |  4.796 s |  inf% | 27.327K | 559.658 MB/s |  0.06% |      4x |   4.801 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/seqlen-16384.ncu-rep
Profiling: varlen/seqlen-32768
==PROF== Connected to process 13672 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (26.89s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (26.89s) before accumulating min_samples (1 < 10)
Pass: Cold: 26888.142578ms GPU, 26888.179002ms CPU, 26.89s total GPU, 26.89s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (28.18s) before accumulating min_samples (1 < 10)
Pass: Batch: 28177.667969ms GPU, 28.18s total GPU, 28.18s total wall, 1x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 29: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.50s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.50s) before accumulating min_samples (1 < 10)
Pass: Cold: 17500.781250ms GPU, 17500.815486ms CPU, 17.50s total GPU, 17.50s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.02s) before accumulating min_samples (1 < 10)
Pass: Batch: 19019.734375ms GPU, 19.02s total GPU, 19.02s total wall, 1x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.29s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.29s) before accumulating min_samples (1 < 10)
Pass: Cold: 21292.699219ms GPU, 21292.735393ms CPU, 21.29s total GPU, 21.29s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.41s) before accumulating min_samples (1 < 10)
Pass: Batch: 21405.201172ms GPU, 21.41s total GPU, 21.41s total wall, 1x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.01s) before accumulating min_samples (1 < 10)
Pass: Cold: 19008.650391ms GPU, 19008.689633ms CPU, 19.01s total GPU, 19.01s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.00s) before accumulating min_samples (1 < 10)
Pass: Batch: 18999.923828ms GPU, 19.00s total GPU, 19.00s total wall, 1x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.85s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.85s) before accumulating min_samples (3 < 10)
Pass: Cold: 5284.637695ms GPU, 5284.651190ms CPU, 15.85s total GPU, 15.85s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.54s) before accumulating min_samples (3 < 10)
Pass: Batch: 5179.418620ms GPU, 15.54s total GPU, 15.54s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.13s) before accumulating min_samples (3 < 10)
Pass: Cold: 5044.100423ms GPU, 5044.115042ms CPU, 15.13s total GPU, 15.13s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.06s) before accumulating min_samples (3 < 10)
Pass: Batch: 6020.246419ms GPU, 18.06s total GPU, 18.06s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.24s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.24s) before accumulating min_samples (1 < 10)
Pass: Cold: 18235.919922ms GPU, 18235.949183ms CPU, 18.24s total GPU, 18.24s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 119: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.69s) before accumulating min_samples (1 < 10)
Pass: Batch: 19687.552734ms GPU, 19.69s total GPU, 19.69s total wall, 1x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.27s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.27s) before accumulating min_samples (2 < 10)
Pass: Cold: 9135.035400ms GPU, 9135.053641ms CPU, 18.27s total GPU, 18.27s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.86s) before accumulating min_samples (3 < 10)
Pass: Batch: 5951.864095ms GPU, 17.86s total GPU, 17.86s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.00s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.00s) before accumulating min_samples (3 < 10)
Pass: Cold: 6334.118327ms GPU, 6334.131144ms CPU, 19.00s total GPU, 19.00s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.96s) before accumulating min_samples (3 < 10)
Pass: Batch: 6320.085286ms GPU, 18.96s total GPU, 18.96s total wall, 3x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 172: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.57s) before accumulating min_samples (1 < 10)
Pass: Cold: 15571.239258ms GPU, 15571.265866ms CPU, 15.57s total GPU, 15.57s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 174: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.52s) before accumulating min_samples (1 < 10)
Pass: Batch: 15523.132812ms GPU, 15.52s total GPU, 15.52s total wall, 1x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 180: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 182: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.84s) while over noise threshold (18.95% > 0.50%)
Warn: Current measurement timed out (16.84s) before accumulating min_samples (5 < 10)
Pass: Cold: 3367.020068ms GPU, 3367.033584ms CPU, 16.84s total GPU, 16.84s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 196: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.93s) before accumulating min_samples (3 < 10)
Pass: Batch: 5975.361165ms GPU, 17.93s total GPU, 17.93s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 204: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 208: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 209: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 210: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 211: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.65s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (23.65s) before accumulating min_samples (2 < 10)
Pass: Cold: 11822.996094ms GPU, 11823.011973ms CPU, 23.65s total GPU, 23.65s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 212: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 213: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 214: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 215: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.29s) before accumulating min_samples (3 < 10)
Pass: Batch: 6431.348470ms GPU, 19.29s total GPU, 19.29s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 216: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 217: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 218: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 219: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 220: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 221: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 222: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 223: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 224: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 225: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 226: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 227: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 228: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 229: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.50s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.50s) before accumulating min_samples (1 < 10)
Pass: Cold: 15497.760742ms GPU, 15497.785874ms CPU, 15.50s total GPU, 15.50s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 230: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 231: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.48s) before accumulating min_samples (1 < 10)
Pass: Batch: 15479.630859ms GPU, 15.48s total GPU, 15.48s total wall, 1x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 232: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 233: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 234: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 235: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 236: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 237: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 238: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 239: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 240: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 241: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 242: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 243: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 244: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 245: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 246: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 247: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 248: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.39s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.39s) before accumulating min_samples (4 < 10)
Pass: Cold: 4598.373657ms GPU, 4598.388132ms CPU, 18.39s total GPU, 18.39s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 249: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 250: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 251: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.92s) before accumulating min_samples (2 < 10)
Pass: Batch: 10959.654785ms GPU, 21.92s total GPU, 21.92s total wall, 2x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 252: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 253: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 254: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 255: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 256: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 257: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 258: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 259: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 260: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 261: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 262: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 263: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 264: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 265: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 266: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.17s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.17s) before accumulating min_samples (2 < 10)
Pass: Cold: 7583.059814ms GPU, 7583.073497ms CPU, 15.17s total GPU, 15.17s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 267: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 268: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 269: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.07s) before accumulating min_samples (2 < 10)
Pass: Batch: 7536.936523ms GPU, 15.07s total GPU, 15.07s total wall, 2x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 270: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 271: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 272: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 273: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 274: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 275: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 276: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 277: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 278: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 279: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 280: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 281: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 282: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 283: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.30s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.30s) before accumulating min_samples (1 < 10)
Pass: Cold: 18296.220703ms GPU, 18296.247165ms CPU, 18.30s total GPU, 18.30s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 284: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 285: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.92s) before accumulating min_samples (1 < 10)
Pass: Batch: 16921.292969ms GPU, 16.92s total GPU, 16.92s total wall, 1x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 286: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 287: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 288: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 289: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 290: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 291: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 292: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 293: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 294: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 295: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 296: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 297: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 298: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 299: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 300: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 301: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 302: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (18.49s) before accumulating min_samples (4 < 10)
Pass: Cold: 4623.229492ms GPU, 4623.242848ms CPU, 18.49s total GPU, 18.49s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 303: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 304: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 305: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 306: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 307: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.33s) before accumulating min_samples (4 < 10)
Pass: Batch: 4583.514648ms GPU, 18.33s total GPU, 18.33s total wall, 4x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=8 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 308: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 309: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 310: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 311: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 312: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 313: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 314: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 315: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 316: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 317: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 318: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 319: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 320: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 321: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 322: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 323: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.05s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.05s) before accumulating min_samples (3 < 10)
Pass: Cold: 6349.340332ms GPU, 6349.352860ms CPU, 19.05s total GPU, 19.05s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 324: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 325: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 326: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 327: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 328: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.14s) before accumulating min_samples (4 < 10)
Pass: Batch: 5034.650391ms GPU, 20.14s total GPU, 20.14s total wall, 4x
==PROF== Disconnected from process 13672
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal | Q Tensor  |  K Tensor   |  V Tensor   |  Output   | Tokens |   Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-----------|-------------|-------------|-----------|--------|----------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|        8 |   32768 |        32 |            8 |       128 |          -1 |           -1 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 26.888 s |   inf% | 26.888 s |   inf% |  9.749K | 199.668 MB/s |  0.02% |      1x |  28.178 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |           -1 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 17.501 s |   inf% | 17.501 s |   inf% | 14.979K | 306.770 MB/s |  0.03% |      1x |  19.020 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |           -1 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 21.293 s |   inf% | 21.293 s |   inf% | 12.311K | 252.138 MB/s |  0.03% |      1x |  21.405 s |
|        8 |   32768 |        32 |            8 |       128 |          -1 |          128 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 19.009 s |   inf% | 19.009 s |   inf% | 13.791K | 282.435 MB/s |  0.03% |      1x |  19.000 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |          128 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      3x |  5.285 s |   inf% |  5.285 s |   inf% | 49.605K |   1.016 GB/s |  0.11% |      3x |   5.179 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |          128 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      3x |  5.044 s |   inf% |  5.044 s |   inf% | 51.970K |   1.064 GB/s |  0.11% |      3x |   6.020 s |
|        8 |   32768 |        32 |            8 |       128 |          -1 |         1024 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 18.236 s |   inf% | 18.236 s |   inf% | 14.375K | 294.403 MB/s |  0.03% |      1x |  19.688 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |         1024 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      2x |  9.135 s |   inf% |  9.135 s |   inf% | 28.697K | 587.705 MB/s |  0.06% |      3x |   5.952 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |         1024 |      0 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      3x |  6.334 s |   inf% |  6.334 s |   inf% | 41.386K | 847.586 MB/s |  0.09% |      3x |   6.320 s |
|        8 |   32768 |        32 |            8 |       128 |          -1 |           -1 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 15.571 s |   inf% | 15.571 s |   inf% | 16.835K | 344.784 MB/s |  0.04% |      1x |  15.523 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |           -1 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      5x |  3.367 s | 18.95% |  3.367 s | 18.95% | 77.856K |   1.594 GB/s |  0.17% |      3x |   5.975 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |           -1 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      2x | 11.823 s |   inf% | 11.823 s |   inf% | 22.172K | 454.090 MB/s |  0.05% |      3x |   6.431 s |
|        8 |   32768 |        32 |            8 |       128 |          -1 |          128 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 15.498 s |   inf% | 15.498 s |   inf% | 16.915K | 346.418 MB/s |  0.04% |      1x |  15.480 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |          128 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      4x |  4.598 s |   inf% |  4.598 s |   inf% | 57.008K |   1.168 GB/s |  0.13% |      2x |  10.960 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |          128 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      2x |  7.583 s |   inf% |  7.583 s |   inf% | 34.570K | 707.987 MB/s |  0.08% |      2x |   7.537 s |
|        8 |   32768 |        32 |            8 |       128 |          -1 |         1024 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      1x | 18.296 s |   inf% | 18.296 s |   inf% | 14.328K | 293.433 MB/s |  0.03% |      1x |  16.921 s |
|        8 |   32768 |        32 |            8 |       128 |         128 |         1024 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      4x |  4.623 s |   inf% |  4.623 s |   inf% | 56.701K |   1.161 GB/s |  0.12% |      4x |   4.584 s |
|        8 |   32768 |        32 |            8 |       128 |        1024 |         1024 |      1 | 2.000 GiB | 512.000 MiB | 512.000 MiB | 2.000 GiB | 262144 | 70368744177664 |         5120 |      3x |  6.349 s |   inf% |  6.349 s |   inf% | 41.287K | 845.554 MB/s |  0.09% |      4x |   5.035 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/seqlen-32768.ncu-rep
Profiling: varlen/deepseek-extreme
==PROF== Connected to process 13689 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_varlen)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (36.78s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (36.78s) before accumulating min_samples (1 < 10)
Pass: Cold: 36776.867188ms GPU, 36776.947713ms CPU, 36.78s total GPU, 36.78s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (36.85s) before accumulating min_samples (1 < 10)
Pass: Batch: 36853.445312ms GPU, 36.85s total GPU, 36.85s total wall, 1x
Run:  [2/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.57s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (24.57s) before accumulating min_samples (1 < 10)
Pass: Cold: 24571.679688ms GPU, 24571.743591ms CPU, 24.57s total GPU, 24.57s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.02s) before accumulating min_samples (1 < 10)
Pass: Batch: 23016.460938ms GPU, 23.02s total GPU, 23.02s total wall, 1x
Run:  [3/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=-1 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (29.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (29.31s) before accumulating min_samples (1 < 10)
Pass: Cold: 29314.609375ms GPU, 29314.664507ms CPU, 29.31s total GPU, 29.31s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (36.49s) before accumulating min_samples (1 < 10)
Pass: Batch: 36489.332031ms GPU, 36.49s total GPU, 36.49s total wall, 1x
Run:  [4/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.55s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (24.55s) before accumulating min_samples (1 < 10)
Pass: Cold: 24546.601562ms GPU, 24546.654876ms CPU, 24.55s total GPU, 24.55s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.45s) before accumulating min_samples (1 < 10)
Pass: Batch: 24454.007812ms GPU, 24.45s total GPU, 24.45s total wall, 1x
Run:  [5/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.45s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.45s) before accumulating min_samples (3 < 10)
Pass: Cold: 5481.760905ms GPU, 5481.780224ms CPU, 16.45s total GPU, 16.45s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.28s) before accumulating min_samples (3 < 10)
Pass: Batch: 6426.546875ms GPU, 19.28s total GPU, 19.28s total wall, 3x
Run:  [6/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.60s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.60s) before accumulating min_samples (3 < 10)
Pass: Cold: 6534.296224ms GPU, 6534.311498ms CPU, 19.60s total GPU, 19.60s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.38s) before accumulating min_samples (3 < 10)
Pass: Batch: 6460.046061ms GPU, 19.38s total GPU, 19.38s total wall, 3x
Run:  [7/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 68: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (23.60s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (23.60s) before accumulating min_samples (1 < 10)
Pass: Cold: 23600.656250ms GPU, 23600.699463ms CPU, 23.60s total GPU, 23.60s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 70: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (25.06s) before accumulating min_samples (1 < 10)
Pass: Batch: 25058.232422ms GPU, 25.06s total GPU, 25.06s total wall, 1x
Run:  [8/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.90s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.90s) before accumulating min_samples (3 < 10)
Pass: Cold: 5634.067057ms GPU, 5634.086308ms CPU, 16.90s total GPU, 16.90s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.46s) before accumulating min_samples (3 < 10)
Pass: Batch: 5153.713867ms GPU, 15.46s total GPU, 15.46s total wall, 3x
Run:  [9/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.01s) before accumulating min_samples (3 < 10)
Pass: Cold: 5671.254883ms GPU, 5671.270062ms CPU, 17.01s total GPU, 17.01s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.26s) before accumulating min_samples (4 < 10)
Pass: Batch: 4565.358887ms GPU, 18.26s total GPU, 18.26s total wall, 4x
Run:  [10/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (21.01s) before accumulating min_samples (1 < 10)
Pass: Cold: 21011.376953ms GPU, 21011.417179ms CPU, 21.01s total GPU, 21.01s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.98s) before accumulating min_samples (1 < 10)
Pass: Batch: 20982.310547ms GPU, 20.98s total GPU, 20.98s total wall, 1x
Run:  [11/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.26s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.26s) before accumulating min_samples (4 < 10)
Pass: Cold: 4815.271118ms GPU, 4815.290274ms CPU, 19.26s total GPU, 19.26s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 120: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.53s) before accumulating min_samples (3 < 10)
Pass: Batch: 5843.876790ms GPU, 17.53s total GPU, 17.53s total wall, 3x
Run:  [12/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=-1 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.15s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (19.15s) before accumulating min_samples (3 < 10)
Pass: Cold: 6382.091634ms GPU, 6382.105891ms CPU, 19.15s total GPU, 19.15s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.19s) before accumulating min_samples (3 < 10)
Pass: Batch: 6397.633464ms GPU, 19.19s total GPU, 19.19s total wall, 3x
Run:  [13/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.31s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.31s) before accumulating min_samples (1 < 10)
Pass: Cold: 22314.011719ms GPU, 22314.048660ms CPU, 22.31s total GPU, 22.31s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 142: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.39s) before accumulating min_samples (1 < 10)
Pass: Batch: 22388.705078ms GPU, 22.39s total GPU, 22.39s total wall, 1x
Run:  [14/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 153: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.14s) while over noise threshold (20.13% > 0.50%)
Warn: Current measurement timed out (16.14s) before accumulating min_samples (5 < 10)
Pass: Cold: 3227.779346ms GPU, 3227.794244ms CPU, 16.14s total GPU, 16.14s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.54s) before accumulating min_samples (5 < 10)
Pass: Batch: 3507.461279ms GPU, 17.54s total GPU, 17.54s total wall, 5x
Run:  [15/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 162: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.45s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.45s) before accumulating min_samples (3 < 10)
Pass: Cold: 5482.048503ms GPU, 5482.063373ms CPU, 16.45s total GPU, 16.45s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 170: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 171: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 172: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 173: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.87s) before accumulating min_samples (4 < 10)
Pass: Batch: 4967.674927ms GPU, 19.87s total GPU, 19.87s total wall, 4x
Run:  [16/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=-1 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 174: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 175: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 176: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 177: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 178: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 179: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 180: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.93s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.93s) before accumulating min_samples (1 < 10)
Pass: Cold: 20925.931641ms GPU, 20925.971907ms CPU, 20.93s total GPU, 20.93s total wall, 1x 
==PROF== Profiling "flash_fwd_kernel" - 181: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 182: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.87s) before accumulating min_samples (1 < 10)
Pass: Batch: 20868.134766ms GPU, 20.87s total GPU, 20.87s total wall, 1x
Run:  [17/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=128 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 183: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 184: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 185: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 186: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 187: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 188: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 189: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 190: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 191: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.53s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.53s) before accumulating min_samples (3 < 10)
Pass: Cold: 5844.810384ms GPU, 5844.828790ms CPU, 17.53s total GPU, 17.53s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 192: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 193: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 194: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 195: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.60s) before accumulating min_samples (3 < 10)
Pass: Batch: 5865.194499ms GPU, 17.60s total GPU, 17.60s total wall, 3x
Run:  [18/18] run_mha_varlen_fwd [Device=0 num_seqs=1 seq_len=65536 num_heads=128 num_kv_heads=128 head_size=56 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 196: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 197: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 198: 0%....50%....100% - 13 passes
==PROF== Profiling "vectorized_elementwise_kernel" - 199: 0%....50%....100% - 13 passes
==PROF== Profiling "unrolled_elementwise_kernel" - 200: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 201: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 202: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 203: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 204: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.19s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.19s) before accumulating min_samples (3 < 10)
Pass: Cold: 5063.399902ms GPU, 5063.412843ms CPU, 15.19s total GPU, 15.19s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 205: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 206: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 207: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 208: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.11s) before accumulating min_samples (3 < 10)
Pass: Batch: 5036.380697ms GPU, 15.11s total GPU, 15.11s total wall, 3x
==PROF== Disconnected from process 13689
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor   |  K Tensor   |  V Tensor   |   Output    | Tokens |   Est. FLOPS   | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|-------------|-------------|-------------|-------------|--------|----------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|        1 |   65536 |       128 |          128 |        56 |          -1 |           -1 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 36.777 s |   inf% | 36.777 s |   inf% |  1.782K | 102.186 MB/s |  0.01% |      1x |  36.853 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |           -1 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 24.572 s |   inf% | 24.572 s |   inf% |  2.667K | 152.944 MB/s |  0.02% |      1x |  23.016 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |           -1 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 29.315 s |   inf% | 29.315 s |   inf% |  2.236K | 128.199 MB/s |  0.01% |      1x |  36.489 s |
|        1 |   65536 |       128 |          128 |        56 |          -1 |          128 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 24.547 s |   inf% | 24.547 s |   inf% |  2.670K | 153.100 MB/s |  0.02% |      1x |  24.454 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |          128 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.482 s |   inf% |  5.482 s |   inf% | 11.955K | 685.564 MB/s |  0.07% |      3x |   6.427 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |          128 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  6.534 s |   inf% |  6.534 s |   inf% | 10.030K | 575.134 MB/s |  0.06% |      3x |   6.460 s |
|        1 |   65536 |       128 |          128 |        56 |          -1 |         1024 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 23.601 s |   inf% | 23.601 s |   inf% |  2.777K | 159.237 MB/s |  0.02% |      1x |  25.058 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |         1024 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.634 s |   inf% |  5.634 s |   inf% | 11.632K | 667.031 MB/s |  0.07% |      3x |   5.154 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |         1024 |      0 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.671 s |   inf% |  5.671 s |   inf% | 11.556K | 662.657 MB/s |  0.07% |      4x |   4.565 s |
|        1 |   65536 |       128 |          128 |        56 |          -1 |           -1 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 21.011 s |   inf% | 21.011 s |   inf% |  3.119K | 178.860 MB/s |  0.02% |      1x |  20.982 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |           -1 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      4x |  4.815 s |   inf% |  4.815 s |   inf% | 13.610K | 780.454 MB/s |  0.08% |      3x |   5.844 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |           -1 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  6.382 s |   inf% |  6.382 s |   inf% | 10.269K | 588.850 MB/s |  0.06% |      3x |   6.398 s |
|        1 |   65536 |       128 |          128 |        56 |          -1 |          128 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 22.314 s |   inf% | 22.314 s |   inf% |  2.937K | 168.419 MB/s |  0.02% |      1x |  22.389 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |          128 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      5x |  3.228 s | 20.13% |  3.228 s | 20.13% | 20.304K |   1.164 GB/s |  0.12% |      5x |   3.507 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |          128 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.482 s |   inf% |  5.482 s |   inf% | 11.955K | 685.528 MB/s |  0.07% |      4x |   4.968 s |
|        1 |   65536 |       128 |          128 |        56 |          -1 |         1024 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      1x | 20.926 s |   inf% | 20.926 s |   inf% |  3.132K | 179.590 MB/s |  0.02% |      1x |  20.868 s |
|        1 |   65536 |       128 |          128 |        56 |         128 |         1024 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.845 s |   inf% |  5.845 s |   inf% | 11.213K | 642.980 MB/s |  0.07% |      3x |   5.865 s |
|        1 |   65536 |       128 |          128 |        56 |        1024 |         1024 |      1 | 896.000 MiB | 896.000 MiB | 896.000 MiB | 896.000 MiB |  65536 | 61572651155456 |         3584 |      3x |  5.063 s |   inf% |  5.063 s |   inf% | 12.943K | 742.208 MB/s |  0.08% |      3x |   5.036 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./ncu_reports/varlen/deepseek-extreme.ncu-rep

==================================================================
                VARIABLE LENGTH BENCHMARK SUMMARY                 
==================================================================
Start time: Tue Mar  4 10:23:12 UTC 2025
End time:   Tue Mar  4 21:37:00 UTC 2025
----------------------------------------------------------------
Total execution time: 11 hours, 13 minutes, 48 seconds
                    = 40428 seconds
----------------------------------------------------------------
GPU used: CUDA_VISIBLE_DEVICES=5
NCU path: ncu
All profiling data saved to: ./ncu_reports/varlen/
==================================================================
