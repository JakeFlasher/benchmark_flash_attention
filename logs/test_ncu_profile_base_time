
# Export environment variables directly like your working script
export CUDA_VISIBLE_DEVICES=$gpu_id
export LD_LIBRARY_PATH=$(dirname $(python -c 'import torch; print(torch.__file__)'))/lib/

mkdir -p ./results_standard
mkdir -p ./results_varlen
mkdir -p ./results_kvcache
mkdir -p ./test_ncu_reports/standard
mkdir -p ./test_ncu_reports/varlen
mkdir -p ./test_ncu_reports/kvcache

# =====================================================
# STANDARD ATTENTION BENCHMARKS
# =====================================================

echo "===== STANDARD ATTENTION BENCHMARKS ====="
===== STANDARD ATTENTION BENCHMARKS =====

# Modern LLM model configurations
echo "Testing modern LLM configurations..."
Testing modern LLM configurations...
# Window attention tests
echo "Testing sliding window attention..."
Testing sliding window attention...
S=1 Hqo=32 Hkv=8 D=128
for W in 128 512 1024; do
  # Define output files directly without using process substitution
  ncu_file="./test_ncu_reports/standard/window-$W.base.ncu-rep"
  md_file="./test_ncu_reports/standard/window-$W.md"
  
  # Match the exact format and ordering of the working script
  $ncu_path --metrics \
l1tex__t_sector_hit_rate.pct,\
l1tex__t_sector_pipe_lsu_mem_global_op_ld_hit_rate.pct,\
lts__t_sector_hit_rate.pct,\
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum,\
l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum,\
l1tex__t_requests_pipe_lsu_mem_local_op_st.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_ld.sum,\
l1tex__t_requests_pipe_tex_mem_texture.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_st.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_red.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_red.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_atom.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_atom.sum,\
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum,\
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum,\
l1tex__m_xbar2l1tex_read_sectors_mem_lg_op_ld.sum,\
l1tex__m_l1tex2xbar_write_sectors_mem_lg_op_st.sum,\
lts__t_requests_srcunit_tex.sum,\
dram__sectors_read.sum,\
dram__sectors_write.sum,\
dram__bytes.sum.per_second,\
gpc__cycles_elapsed.max,\
sm__cycles_active.avg,\
gpc__cycles_elapsed.avg.per_second,\
dram__cycles_elapsed.avg.per_second,\
gpu__time_duration.sum,\
sm__inst_executed.avg.per_cycle_elapsed,\
smsp__inst_executed.sum,\
gpu__compute_memory_access_throughput.avg.pct_of_peak_sustained_elapsed,\
gpu__compute_memory_request_throughput.avg.pct_of_peak_sustained_elapsed,\
sm__memory_throughput.avg.pct_of_peak_sustained_elapsed,\
launch__occupancy_limit_blocks,\
launch__occupancy_limit_registers,\
launch__occupancy_limit_shared_mem,\
launch__occupancy_limit_warps,\
sm__maximum_warps_avg_per_active_cycle,\
sm__maximum_warps_per_active_cycle_pct,\
sm__warps_active.avg.per_cycle_active,\
sm__warps_active.avg.pct_of_peak_sustained_active \
  --profile-from-start on \
  --export "$ncu_file" \
  --force-overwrite \
  --replay-mode kernel \
  ./build/flash_attention_benchmark_standard \
  -a num_seqs=$S -a num_heads=$Hqo -a num_kv_heads=$Hkv -a head_size=$D \
  -a window_left=$W -a window_right=$W \
  --disable-blocking-kernel --md "$md_file"
done
==PROF== Connected to process 56233 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.73s) while over noise threshold (3.34% > 0.50%)
Warn: Current measurement timed out (16.73s) before accumulating min_samples (6 < 10)
Pass: Cold: 2788.548584ms GPU, 2788.584732ms CPU, 16.73s total GPU, 16.73s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.04s) before accumulating min_samples (5 < 10)
Pass: Batch: 3408.597412ms GPU, 17.04s total GPU, 17.04s total wall, 5x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.01s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (24.01s) before accumulating min_samples (3 < 10)
Pass: Cold: 8002.827962ms GPU, 8002.917640ms CPU, 24.01s total GPU, 24.01s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (30.58s) before accumulating min_samples (3 < 10)
Pass: Batch: 10194.184408ms GPU, 30.58s total GPU, 30.58s total wall, 3x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.45s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.45s) before accumulating min_samples (3 < 10)
Pass: Cold: 5817.549479ms GPU, 5817.617271ms CPU, 17.45s total GPU, 17.45s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.76s) before accumulating min_samples (4 < 10)
Pass: Batch: 4440.610046ms GPU, 17.76s total GPU, 17.76s total wall, 4x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (32.09s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (32.09s) before accumulating min_samples (3 < 10)
Pass: Cold: 10696.061768ms GPU, 10696.180455ms CPU, 32.09s total GPU, 32.09s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.13s) before accumulating min_samples (2 < 10)
Pass: Batch: 10064.934448ms GPU, 20.13s total GPU, 20.13s total wall, 2x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.05s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.05s) before accumulating min_samples (4 < 10)
Pass: Cold: 4013.371155ms GPU, 4013.421843ms CPU, 16.05s total GPU, 16.05s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (21.01s) before accumulating min_samples (2 < 10)
Pass: Batch: 10502.712646ms GPU, 21.01s total GPU, 21.01s total wall, 2x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (22.74s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (22.74s) before accumulating min_samples (4 < 10)
Pass: Cold: 5685.330505ms GPU, 5685.398127ms CPU, 22.74s total GPU, 22.74s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (19.07s) before accumulating min_samples (5 < 10)
Pass: Batch: 3814.036230ms GPU, 19.07s total GPU, 19.07s total wall, 5x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.65s) while over noise threshold (0.88% > 0.50%)
Warn: Current measurement timed out (15.65s) before accumulating min_samples (6 < 10)
Pass: Cold: 2608.951253ms GPU, 2608.987081ms CPU, 15.65s total GPU, 15.65s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (26.96s) before accumulating min_samples (4 < 10)
Pass: Batch: 6739.442505ms GPU, 26.96s total GPU, 26.96s total wall, 4x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.13s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.13s) before accumulating min_samples (4 < 10)
Pass: Cold: 4031.204163ms GPU, 4031.254667ms CPU, 16.12s total GPU, 16.13s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.77s) before accumulating min_samples (6 < 10)
Pass: Batch: 2795.043172ms GPU, 16.77s total GPU, 16.77s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.36s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.36s) before accumulating min_samples (4 < 10)
Pass: Cold: 4089.126404ms GPU, 4089.177943ms CPU, 16.36s total GPU, 16.36s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.55s) before accumulating min_samples (5 < 10)
Pass: Batch: 3109.958203ms GPU, 15.55s total GPU, 15.55s total wall, 5x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.50s) while over noise threshold (24.82% > 0.50%)
Warn: Current measurement timed out (16.50s) before accumulating min_samples (5 < 10)
Pass: Cold: 3299.947510ms GPU, 3299.991911ms CPU, 16.50s total GPU, 16.50s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.28s) before accumulating min_samples (5 < 10)
Pass: Batch: 3456.051123ms GPU, 17.28s total GPU, 17.28s total wall, 5x
==PROF== Disconnected from process 56233
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |         128 |          128 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.789 s |  3.34% |  2.789 s |  3.34% | 183.608 |   3.760 MB/s |  0.00% |      5x |   3.409 s |
|        1 |    1024 |        32 |            8 |       128 |         128 |          128 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      3x |  8.003 s |   inf% |  8.003 s |   inf% | 127.955 |   2.621 MB/s |  0.00% |      3x |  10.194 s |
|        1 |    2048 |        32 |            8 |       128 |         128 |          128 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      3x |  5.818 s |   inf% |  5.818 s |   inf% | 352.038 |   7.210 MB/s |  0.00% |      4x |   4.441 s |
|        1 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      3x | 10.696 s |   inf% | 10.696 s |   inf% | 382.945 |   7.843 MB/s |  0.00% |      2x |  10.065 s |
|        1 |    8192 |        32 |            8 |       128 |         128 |          128 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      4x |  4.013 s |   inf% |  4.013 s |   inf% |  2.041K |  41.803 MB/s |  0.00% |      2x |  10.503 s |
|        1 |     512 |        32 |            8 |       128 |         128 |          128 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      4x |  5.685 s |   inf% |  5.685 s |   inf% |  90.056 |   1.844 MB/s |  0.00% |      5x |   3.814 s |
|        1 |    1024 |        32 |            8 |       128 |         128 |          128 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.609 s |  0.88% |  2.609 s |  0.88% | 392.495 |   8.038 MB/s |  0.00% |      4x |   6.739 s |
|        1 |    2048 |        32 |            8 |       128 |         128 |          128 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      4x |  4.031 s |   inf% |  4.031 s |   inf% | 508.037 |  10.405 MB/s |  0.00% |      6x |   2.795 s |
|        1 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      4x |  4.089 s |   inf% |  4.089 s |   inf% |  1.002K |  20.514 MB/s |  0.00% |      5x |   3.110 s |
|        1 |    8192 |        32 |            8 |       128 |         128 |          128 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      5x |  3.300 s | 24.82% |  3.300 s | 24.82% |  2.482K |  50.841 MB/s |  0.01% |      5x |   3.456 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-128.base.ncu-rep
==PROF== Connected to process 56459 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.41s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.41s) before accumulating min_samples (2 < 10)
Pass: Cold: 8707.134766ms GPU, 8707.233351ms CPU, 17.41s total GPU, 17.41s total wall, 2x 
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.77s) before accumulating min_samples (5 < 10)
Pass: Batch: 3753.341748ms GPU, 18.77s total GPU, 18.77s total wall, 5x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.64s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (17.64s) before accumulating min_samples (3 < 10)
Pass: Cold: 5880.350342ms GPU, 5880.419510ms CPU, 17.64s total GPU, 17.64s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.62s) before accumulating min_samples (3 < 10)
Pass: Batch: 5874.283529ms GPU, 17.62s total GPU, 17.62s total wall, 3x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 29: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.14s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.14s) before accumulating min_samples (3 < 10)
Pass: Cold: 5378.661702ms GPU, 5378.738756ms CPU, 16.14s total GPU, 16.14s total wall, 3x 
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.38s) before accumulating min_samples (4 < 10)
Pass: Batch: 4095.987732ms GPU, 16.38s total GPU, 16.38s total wall, 4x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.41s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.41s) before accumulating min_samples (4 < 10)
Pass: Cold: 4101.352417ms GPU, 4101.404223ms CPU, 16.41s total GPU, 16.41s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.89s) before accumulating min_samples (2 < 10)
Pass: Batch: 7944.676392ms GPU, 15.89s total GPU, 15.89s total wall, 2x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.18s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.18s) before accumulating min_samples (4 < 10)
Pass: Cold: 3795.170471ms GPU, 3795.219188ms CPU, 15.18s total GPU, 15.18s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.86s) before accumulating min_samples (5 < 10)
Pass: Batch: 3371.409961ms GPU, 16.86s total GPU, 16.86s total wall, 5x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 69: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.46s) while over noise threshold (24.70% > 0.50%)
Warn: Current measurement timed out (18.46s) before accumulating min_samples (6 < 10)
Pass: Cold: 3076.485311ms GPU, 3076.526809ms CPU, 18.46s total GPU, 18.46s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.09s) before accumulating min_samples (4 < 10)
Pass: Batch: 5021.508606ms GPU, 20.09s total GPU, 20.09s total wall, 4x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.88s) while over noise threshold (17.45% > 0.50%)
Warn: Current measurement timed out (18.88s) before accumulating min_samples (5 < 10)
Pass: Cold: 3775.251025ms GPU, 3775.299801ms CPU, 18.88s total GPU, 18.88s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.26s) before accumulating min_samples (4 < 10)
Pass: Batch: 4065.615051ms GPU, 16.26s total GPU, 16.26s total wall, 4x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.87s) while over noise threshold (21.07% > 0.50%)
Warn: Current measurement timed out (16.87s) before accumulating min_samples (6 < 10)
Pass: Cold: 2811.416748ms GPU, 2811.455293ms CPU, 16.87s total GPU, 16.87s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.44s) before accumulating min_samples (6 < 10)
Pass: Batch: 2572.779663ms GPU, 15.44s total GPU, 15.44s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.02s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (15.02s) before accumulating min_samples (4 < 10)
Pass: Cold: 3754.139648ms GPU, 3754.187514ms CPU, 15.02s total GPU, 15.02s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 119: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.46s) before accumulating min_samples (5 < 10)
Pass: Batch: 3092.255713ms GPU, 15.46s total GPU, 15.46s total wall, 5x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.24s) while over noise threshold (20.10% > 0.50%)
Warn: Current measurement timed out (17.24s) before accumulating min_samples (5 < 10)
Pass: Cold: 3448.204053ms GPU, 3448.249143ms CPU, 17.24s total GPU, 17.24s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.20s) before accumulating min_samples (4 < 10)
Pass: Batch: 3799.881775ms GPU, 15.20s total GPU, 15.20s total wall, 4x
==PROF== Disconnected from process 56459
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |         512 |          512 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      2x |  8.707 s |   inf% |  8.707 s |   inf% |  58.802 |   1.204 MB/s |  0.00% |      5x |   3.753 s |
|        1 |    1024 |        32 |            8 |       128 |         512 |          512 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      3x |  5.880 s |   inf% |  5.880 s |   inf% | 174.139 |   3.566 MB/s |  0.00% |      3x |   5.874 s |
|        1 |    2048 |        32 |            8 |       128 |         512 |          512 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      3x |  5.379 s |   inf% |  5.379 s |   inf% | 380.764 |   7.798 MB/s |  0.00% |      4x |   4.096 s |
|        1 |    4096 |        32 |            8 |       128 |         512 |          512 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      4x |  4.101 s |   inf% |  4.101 s |   inf% | 998.695 |  20.453 MB/s |  0.00% |      2x |   7.945 s |
|        1 |    8192 |        32 |            8 |       128 |         512 |          512 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      4x |  3.795 s |   inf% |  3.795 s |   inf% |  2.159K |  44.207 MB/s |  0.00% |      5x |   3.371 s |
|        1 |     512 |        32 |            8 |       128 |         512 |          512 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  3.077 s | 24.70% |  3.076 s | 24.70% | 166.424 |   3.408 MB/s |  0.00% |      4x |   5.022 s |
|        1 |    1024 |        32 |            8 |       128 |         512 |          512 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      5x |  3.775 s | 17.45% |  3.775 s | 17.45% | 271.240 |   5.555 MB/s |  0.00% |      4x |   4.066 s |
|        1 |    2048 |        32 |            8 |       128 |         512 |          512 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.811 s | 21.07% |  2.811 s | 21.07% | 728.458 |  14.919 MB/s |  0.00% |      6x |   2.573 s |
|        1 |    4096 |        32 |            8 |       128 |         512 |          512 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      4x |  3.754 s |   inf% |  3.754 s |   inf% |  1.091K |  22.345 MB/s |  0.00% |      5x |   3.092 s |
|        1 |    8192 |        32 |            8 |       128 |         512 |          512 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      5x |  3.448 s | 20.10% |  3.448 s | 20.10% |  2.376K |  48.655 MB/s |  0.01% |      4x |   3.800 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-512.base.ncu-rep
==PROF== Connected to process 56493 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.40s) while over noise threshold (23.17% > 0.50%)
Warn: Current measurement timed out (17.40s) before accumulating min_samples (5 < 10)
Pass: Cold: 3480.520459ms GPU, 3480.565357ms CPU, 17.40s total GPU, 17.40s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.78s) before accumulating min_samples (5 < 10)
Pass: Batch: 3756.181494ms GPU, 18.78s total GPU, 18.78s total wall, 5x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 16: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (24.28s) while over noise threshold (55.38% > 0.50%)
Warn: Current measurement timed out (24.28s) before accumulating min_samples (5 < 10)
Pass: Cold: 4856.536084ms GPU, 4856.594997ms CPU, 24.28s total GPU, 24.28s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (25.46s) before accumulating min_samples (4 < 10)
Pass: Batch: 6364.987000ms GPU, 25.46s total GPU, 25.46s total wall, 4x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 36: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (20.39s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (20.39s) before accumulating min_samples (4 < 10)
Pass: Cold: 5098.033386ms GPU, 5098.095188ms CPU, 20.39s total GPU, 20.39s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (18.98s) before accumulating min_samples (5 < 10)
Pass: Batch: 3796.378271ms GPU, 18.98s total GPU, 18.98s total wall, 5x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 43: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 51: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.67s) while over noise threshold (22.49% > 0.50%)
Warn: Current measurement timed out (17.67s) before accumulating min_samples (5 < 10)
Pass: Cold: 3533.338281ms GPU, 3533.384406ms CPU, 17.67s total GPU, 17.67s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.40s) before accumulating min_samples (4 < 10)
Pass: Batch: 4100.202820ms GPU, 16.40s total GPU, 16.40s total wall, 4x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.18s) while over noise threshold (22.52% > 0.50%)
Warn: Current measurement timed out (17.18s) before accumulating min_samples (6 < 10)
Pass: Cold: 2863.208333ms GPU, 2863.247618ms CPU, 17.18s total GPU, 17.18s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 70: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.18s) before accumulating min_samples (3 < 10)
Pass: Batch: 5061.062500ms GPU, 15.18s total GPU, 15.18s total wall, 3x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.99s) while over noise threshold (24.42% > 0.50%)
Warn: Current measurement timed out (15.99s) before accumulating min_samples (5 < 10)
Pass: Cold: 3197.375879ms GPU, 3197.418522ms CPU, 15.99s total GPU, 15.99s total wall, 5x 
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 86: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) before accumulating min_samples (6 < 10)
Pass: Batch: 2848.908610ms GPU, 17.09s total GPU, 17.09s total wall, 6x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) while over noise threshold (20.49% > 0.50%)
Warn: Current measurement timed out (17.08s) before accumulating min_samples (6 < 10)
Pass: Cold: 2847.331665ms GPU, 2847.370599ms CPU, 17.08s total GPU, 17.08s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 102: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (29.70s) before accumulating min_samples (5 < 10)
Pass: Batch: 5940.385693ms GPU, 29.70s total GPU, 29.70s total wall, 5x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.49s) while over noise threshold (inf% > 0.50%)
Warn: Current measurement timed out (16.49s) before accumulating min_samples (4 < 10)
Pass: Cold: 4122.371643ms GPU, 4122.423551ms CPU, 16.49s total GPU, 16.49s total wall, 4x 
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.82s) before accumulating min_samples (6 < 10)
Pass: Batch: 2802.564250ms GPU, 16.82s total GPU, 16.82s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 118: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.02s) while over noise threshold (1.81% > 0.50%)
Warn: Current measurement timed out (17.02s) before accumulating min_samples (6 < 10)
Pass: Cold: 2837.136027ms GPU, 2837.175688ms CPU, 17.02s total GPU, 17.02s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.86s) before accumulating min_samples (6 < 10)
Pass: Batch: 2809.296875ms GPU, 16.86s total GPU, 16.86s total wall, 6x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 135: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 144: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.95s) while over noise threshold (0.95% > 0.50%)
Warn: Current measurement timed out (16.95s) before accumulating min_samples (6 < 10)
Pass: Cold: 2825.618408ms GPU, 2825.657145ms CPU, 16.95s total GPU, 16.95s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 145: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.90s) before accumulating min_samples (6 < 10)
Pass: Batch: 2817.212077ms GPU, 16.90s total GPU, 16.90s total wall, 6x
==PROF== Disconnected from process 56493
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise  | GPU Time | Noise  | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|--------|----------|--------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |        1024 |         1024 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      5x |  3.481 s | 23.17% |  3.481 s | 23.17% | 147.104 |   3.013 MB/s |  0.00% |      5x |   3.756 s |
|        1 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      5x |  4.857 s | 55.38% |  4.857 s | 55.38% | 210.850 |   4.318 MB/s |  0.00% |      4x |   6.365 s |
|        1 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      4x |  5.098 s |   inf% |  5.098 s |   inf% | 401.724 |   8.227 MB/s |  0.00% |      5x |   3.796 s |
|        1 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      5x |  3.533 s | 22.49% |  3.533 s | 22.49% |  1.159K |  23.741 MB/s |  0.00% |      4x |   4.100 s |
|        1 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.863 s | 22.52% |  2.863 s | 22.52% |  2.861K |  58.596 MB/s |  0.01% |      3x |   5.061 s |
|        1 |     512 |        32 |            8 |       128 |        1024 |         1024 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      5x |  3.197 s | 24.42% |  3.197 s | 24.42% | 160.131 |   3.279 MB/s |  0.00% |      6x |   2.849 s |
|        1 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.847 s | 20.49% |  2.847 s | 20.49% | 359.635 |   7.365 MB/s |  0.00% |      5x |   5.940 s |
|        1 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      4x |  4.122 s |   inf% |  4.122 s |   inf% | 496.801 |  10.174 MB/s |  0.00% |      6x |   2.803 s |
|        1 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.837 s |  1.81% |  2.837 s |  1.81% |  1.444K |  29.567 MB/s |  0.00% |      6x |   2.809 s |
|        1 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.826 s |  0.95% |  2.826 s |  0.95% |  2.899K |  59.375 MB/s |  0.01% |      6x |   2.817 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-1024.base.ncu-rep
# Calculate total execution time
END_TIME=$(date +%s)
DURATION=$((END_TIME - START_TIME))

# Convert to hours, minutes, seconds
HOURS=$((DURATION / 3600))
MINUTES=$(( (DURATION % 3600) / 60 ))
SECONDS=$((DURATION % 60))

echo ""

echo "=================================================================="
==================================================================
echo "                       BENCHMARK SUMMARY                          "
                       BENCHMARK SUMMARY                          
echo "=================================================================="
==================================================================
echo "Start time: $(date -d @$START_TIME)"
Start time: Thu Mar  6 16:31:17 UTC 2025
echo "End time:   $(date -d @$END_TIME)"
End time:   Thu Mar  6 17:01:15 UTC 2025

echo "----------------------------------------------------------------"
----------------------------------------------------------------
echo "Total execution time: $HOURS hours, $MINUTES minutes, $SECONDS seconds"
Total execution time: 0 hours, 29 minutes, 58 seconds
echo "                    = $DURATION seconds"
                    = 1798 seconds

----------------------"
echo "GPU used: CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES"
echo "NCU path: $ncu_path"
echo "All profiling data saved to: ./ncu_reports/"
./test2.sh: line 132: unexpected EOF while looking for matching `"'
