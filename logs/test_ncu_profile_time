
# Export environment variables directly like your working script
export CUDA_VISIBLE_DEVICES=$gpu_id
export LD_LIBRARY_PATH=$(dirname $(python -c 'import torch; print(torch.__file__)'))/lib/

mkdir -p ./results_standard
mkdir -p ./results_varlen
mkdir -p ./results_kvcache
mkdir -p ./test_ncu_reports/standard
mkdir -p ./test_ncu_reports/varlen
mkdir -p ./test_ncu_reports/kvcache

# =====================================================
# STANDARD ATTENTION BENCHMARKS
# =====================================================

echo "===== STANDARD ATTENTION BENCHMARKS ====="
===== STANDARD ATTENTION BENCHMARKS =====

# Modern LLM model configurations
echo "Testing modern LLM configurations..."
Testing modern LLM configurations...
# Window attention tests
echo "Testing sliding window attention..."
Testing sliding window attention...
S=1 Hqo=32 Hkv=8 D=128
for W in 128 512 1024; do
  # Define output files directly without using process substitution
  ncu_file="./test_ncu_reports/standard/window-$W_base.ncu-rep"
  md_file="./test_ncu_reports/standard/window-$W.md"
  
  # Match the exact format and ordering of the working script
  $ncu_path --metrics \
l1tex__t_sector_hit_rate.pct,\
l1tex__t_sector_pipe_lsu_mem_global_op_ld_hit_rate.pct,\
lts__t_sector_hit_rate.pct,\
l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_st.sum,\
l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum,\
l1tex__t_requests_pipe_lsu_mem_local_op_st.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_ld.sum,\
l1tex__t_requests_pipe_tex_mem_texture.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_st.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_red.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_red.sum,\
l1tex__t_requests_pipe_lsu_mem_global_op_atom.sum,\
l1tex__t_requests_pipe_tex_mem_surface_op_atom.sum,\
l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum,\
l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum,\
l1tex__m_xbar2l1tex_read_sectors_mem_lg_op_ld.sum,\
l1tex__m_l1tex2xbar_write_sectors_mem_lg_op_st.sum,\
lts__t_requests_srcunit_tex.sum,\
dram__sectors_read.sum,\
dram__sectors_write.sum,\
dram__bytes.sum.per_second,\
gpc__cycles_elapsed.max,\
sm__cycles_active.avg,\
gpc__cycles_elapsed.avg.per_second,\
dram__cycles_elapsed.avg.per_second,\
gpu__time_duration.sum,\
sm__inst_executed.avg.per_cycle_elapsed,\
smsp__inst_executed.sum,\
gpu__compute_memory_access_throughput.avg.pct_of_peak_sustained_elapsed,\
gpu__compute_memory_request_throughput.avg.pct_of_peak_sustained_elapsed,\
sm__memory_throughput.avg.pct_of_peak_sustained_elapsed,\
launch__occupancy_limit_blocks,\
launch__occupancy_limit_registers,\
launch__occupancy_limit_shared_mem,\
launch__occupancy_limit_warps,\
sm__maximum_warps_avg_per_active_cycle,\
sm__maximum_warps_per_active_cycle_pct,\
sm__warps_active.avg.per_cycle_active,\
sm__warps_active.avg.pct_of_peak_sustained_active \
  --profile-from-start on \
  --export "$ncu_file" \
  --force-overwrite \
  --replay-mode kernel \
  ./build/flash_attention_benchmark_standard \
  -a num_seqs=$S -a num_heads=$Hqo -a num_kv_heads=$Hkv -a head_size=$D \
  -a window_left=$W -a window_right=$W \
  --disable-blocking-kernel --md "$md_file"
done
==PROF== Connected to process 55133 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.79s) while over noise threshold (1.26% > 0.50%)
Warn: Current measurement timed out (16.79s) before accumulating min_samples (6 < 10)
Pass: Cold: 2797.500448ms GPU, 2797.537175ms CPU, 16.79s total GPU, 16.79s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.88s) before accumulating min_samples (6 < 10)
Pass: Batch: 2813.909017ms GPU, 16.88s total GPU, 16.88s total wall, 6x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.00s) while over noise threshold (1.48% > 0.50%)
Warn: Current measurement timed out (17.00s) before accumulating min_samples (6 < 10)
Pass: Cold: 2832.942627ms GPU, 2832.980036ms CPU, 17.00s total GPU, 17.00s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.20s) before accumulating min_samples (6 < 10)
Pass: Batch: 2867.387207ms GPU, 17.20s total GPU, 17.20s total wall, 6x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.89s) while over noise threshold (1.01% > 0.50%)
Warn: Current measurement timed out (16.89s) before accumulating min_samples (6 < 10)
Pass: Cold: 2814.167236ms GPU, 2814.205147ms CPU, 16.89s total GPU, 16.89s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.88s) before accumulating min_samples (6 < 10)
Pass: Batch: 2812.875448ms GPU, 16.88s total GPU, 16.88s total wall, 6x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.85s) while over noise threshold (0.67% > 0.50%)
Warn: Current measurement timed out (16.85s) before accumulating min_samples (6 < 10)
Pass: Cold: 2808.942220ms GPU, 2808.996259ms CPU, 16.85s total GPU, 16.85s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.20s) before accumulating min_samples (6 < 10)
Pass: Batch: 2865.929199ms GPU, 17.20s total GPU, 17.20s total wall, 6x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.89s) while over noise threshold (1.63% > 0.50%)
Warn: Current measurement timed out (16.89s) before accumulating min_samples (6 < 10)
Pass: Cold: 2814.934855ms GPU, 2814.974691ms CPU, 16.89s total GPU, 16.89s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.01s) before accumulating min_samples (6 < 10)
Pass: Batch: 2835.329508ms GPU, 17.01s total GPU, 17.01s total wall, 6x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.03s) while over noise threshold (1.20% > 0.50%)
Warn: Current measurement timed out (17.03s) before accumulating min_samples (6 < 10)
Pass: Cold: 2838.042969ms GPU, 2838.082884ms CPU, 17.03s total GPU, 17.03s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.90s) before accumulating min_samples (6 < 10)
Pass: Batch: 2816.191854ms GPU, 16.90s total GPU, 16.90s total wall, 6x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.98s) while over noise threshold (1.23% > 0.50%)
Warn: Current measurement timed out (16.98s) before accumulating min_samples (6 < 10)
Pass: Cold: 2830.555786ms GPU, 2830.595090ms CPU, 16.98s total GPU, 16.98s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.08s) before accumulating min_samples (6 < 10)
Pass: Batch: 2845.919556ms GPU, 17.08s total GPU, 17.08s total wall, 6x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.07s) while over noise threshold (1.63% > 0.50%)
Warn: Current measurement timed out (17.07s) before accumulating min_samples (6 < 10)
Pass: Cold: 2844.961914ms GPU, 2845.001651ms CPU, 17.07s total GPU, 17.07s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (15.78s) before accumulating min_samples (6 < 10)
Pass: Batch: 2629.870280ms GPU, 15.78s total GPU, 15.78s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 145: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.94s) while over noise threshold (0.84% > 0.50%)
Warn: Current measurement timed out (16.94s) before accumulating min_samples (6 < 10)
Pass: Cold: 2822.500000ms GPU, 2822.539837ms CPU, 16.93s total GPU, 16.94s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.01s) before accumulating min_samples (6 < 10)
Pass: Batch: 2834.165934ms GPU, 17.00s total GPU, 17.01s total wall, 6x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=128 window_right=128 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.25s) while over noise threshold (3.52% > 0.50%)
Warn: Current measurement timed out (17.25s) before accumulating min_samples (6 < 10)
Pass: Cold: 2875.340983ms GPU, 2875.380987ms CPU, 17.25s total GPU, 17.25s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.05s) before accumulating min_samples (6 < 10)
Pass: Batch: 2841.028442ms GPU, 17.05s total GPU, 17.05s total wall, 6x
==PROF== Disconnected from process 55133
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |         128 |          128 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.798 s | 1.26% |  2.798 s | 1.26% | 183.021 |   3.748 MB/s |  0.00% |      6x |   2.814 s |
|        1 |    1024 |        32 |            8 |       128 |         128 |          128 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.833 s | 1.48% |  2.833 s | 1.48% | 361.462 |   7.403 MB/s |  0.00% |      6x |   2.867 s |
|        1 |    2048 |        32 |            8 |       128 |         128 |          128 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.814 s | 1.01% |  2.814 s | 1.01% | 727.746 |  14.904 MB/s |  0.00% |      6x |   2.813 s |
|        1 |    4096 |        32 |            8 |       128 |         128 |          128 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.809 s | 0.67% |  2.809 s | 0.67% |  1.458K |  29.864 MB/s |  0.00% |      6x |   2.866 s |
|        1 |    8192 |        32 |            8 |       128 |         128 |          128 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.815 s | 1.63% |  2.815 s | 1.63% |  2.910K |  59.601 MB/s |  0.01% |      6x |   2.835 s |
|        1 |     512 |        32 |            8 |       128 |         128 |          128 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.838 s | 1.20% |  2.838 s | 1.20% | 180.406 |   3.695 MB/s |  0.00% |      6x |   2.816 s |
|        1 |    1024 |        32 |            8 |       128 |         128 |          128 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.831 s | 1.23% |  2.831 s | 1.23% | 361.766 |   7.409 MB/s |  0.00% |      6x |   2.846 s |
|        1 |    2048 |        32 |            8 |       128 |         128 |          128 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.845 s | 1.63% |  2.845 s | 1.63% | 719.869 |  14.743 MB/s |  0.00% |      6x |   2.630 s |
|        1 |    4096 |        32 |            8 |       128 |         128 |          128 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.823 s | 0.84% |  2.822 s | 0.84% |  1.451K |  29.720 MB/s |  0.00% |      6x |   2.834 s |
|        1 |    8192 |        32 |            8 |       128 |         128 |          128 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.875 s | 3.52% |  2.875 s | 3.52% |  2.849K |  58.349 MB/s |  0.01% |      6x |   2.841 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-.ncu-rep
==PROF== Connected to process 55174 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.93s) while over noise threshold (1.20% > 0.50%)
Warn: Current measurement timed out (16.93s) before accumulating min_samples (6 < 10)
Pass: Cold: 2821.438395ms GPU, 2821.476432ms CPU, 16.93s total GPU, 16.93s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.81s) before accumulating min_samples (6 < 10)
Pass: Batch: 2801.260742ms GPU, 16.81s total GPU, 16.81s total wall, 6x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.98s) while over noise threshold (1.70% > 0.50%)
Warn: Current measurement timed out (16.98s) before accumulating min_samples (6 < 10)
Pass: Cold: 2830.078776ms GPU, 2830.116533ms CPU, 16.98s total GPU, 16.98s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.82s) before accumulating min_samples (6 < 10)
Pass: Batch: 2803.126302ms GPU, 16.82s total GPU, 16.82s total wall, 6x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.91s) while over noise threshold (1.20% > 0.50%)
Warn: Current measurement timed out (16.91s) before accumulating min_samples (6 < 10)
Pass: Cold: 2818.221598ms GPU, 2818.259745ms CPU, 16.91s total GPU, 16.91s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.01s) before accumulating min_samples (6 < 10)
Pass: Batch: 2834.295776ms GPU, 17.01s total GPU, 17.01s total wall, 6x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.92s) while over noise threshold (0.78% > 0.50%)
Warn: Current measurement timed out (16.92s) before accumulating min_samples (6 < 10)
Pass: Cold: 2820.234253ms GPU, 2820.272980ms CPU, 16.92s total GPU, 16.92s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.97s) before accumulating min_samples (6 < 10)
Pass: Batch: 2828.589193ms GPU, 16.97s total GPU, 16.97s total wall, 6x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.12s) before accumulating min_samples (6 < 10)
Pass: Cold: 2852.838582ms GPU, 2852.877413ms CPU, 17.12s total GPU, 17.12s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.11s) before accumulating min_samples (6 < 10)
Pass: Batch: 2851.958130ms GPU, 17.11s total GPU, 17.11s total wall, 6x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.10s) while over noise threshold (1.47% > 0.50%)
Warn: Current measurement timed out (17.10s) before accumulating min_samples (6 < 10)
Pass: Cold: 2850.679118ms GPU, 2850.718404ms CPU, 17.10s total GPU, 17.10s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.95s) before accumulating min_samples (6 < 10)
Pass: Batch: 2824.218262ms GPU, 16.95s total GPU, 16.95s total wall, 6x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.92s) while over noise threshold (0.75% > 0.50%)
Warn: Current measurement timed out (16.92s) before accumulating min_samples (6 < 10)
Pass: Cold: 2819.933187ms GPU, 2819.972372ms CPU, 16.92s total GPU, 16.92s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.97s) before accumulating min_samples (6 < 10)
Pass: Batch: 2827.517619ms GPU, 16.97s total GPU, 16.97s total wall, 6x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.93s) while over noise threshold (1.06% > 0.50%)
Warn: Current measurement timed out (16.93s) before accumulating min_samples (6 < 10)
Pass: Cold: 2820.949015ms GPU, 2820.987821ms CPU, 16.93s total GPU, 16.93s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.16s) before accumulating min_samples (6 < 10)
Pass: Batch: 2859.733195ms GPU, 17.16s total GPU, 17.16s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 145: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.96s) while over noise threshold (1.46% > 0.50%)
Warn: Current measurement timed out (16.96s) before accumulating min_samples (6 < 10)
Pass: Cold: 2826.451904ms GPU, 2826.491065ms CPU, 16.96s total GPU, 16.96s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) before accumulating min_samples (6 < 10)
Pass: Batch: 2848.784383ms GPU, 17.09s total GPU, 17.09s total wall, 6x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=512 window_right=512 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.18s) while over noise threshold (1.00% > 0.50%)
Warn: Current measurement timed out (17.18s) before accumulating min_samples (6 < 10)
Pass: Cold: 2862.834025ms GPU, 2862.873211ms CPU, 17.18s total GPU, 17.18s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.89s) before accumulating min_samples (6 < 10)
Pass: Batch: 2814.844767ms GPU, 16.89s total GPU, 16.89s total wall, 6x
==PROF== Disconnected from process 55174
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |         512 |          512 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.821 s | 1.20% |  2.821 s | 1.20% | 181.468 |   3.716 MB/s |  0.00% |      6x |   2.801 s |
|        1 |    1024 |        32 |            8 |       128 |         512 |          512 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.830 s | 1.70% |  2.830 s | 1.70% | 361.827 |   7.410 MB/s |  0.00% |      6x |   2.803 s |
|        1 |    2048 |        32 |            8 |       128 |         512 |          512 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.818 s | 1.20% |  2.818 s | 1.20% | 726.699 |  14.883 MB/s |  0.00% |      6x |   2.834 s |
|        1 |    4096 |        32 |            8 |       128 |         512 |          512 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.820 s | 0.78% |  2.820 s | 0.78% |  1.452K |  29.744 MB/s |  0.00% |      6x |   2.829 s |
|        1 |    8192 |        32 |            8 |       128 |         512 |          512 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.853 s | 0.35% |  2.853 s | 0.35% |  2.872K |  58.809 MB/s |  0.01% |      6x |   2.852 s |
|        1 |     512 |        32 |            8 |       128 |         512 |          512 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.851 s | 1.47% |  2.851 s | 1.47% | 179.606 |   3.678 MB/s |  0.00% |      6x |   2.824 s |
|        1 |    1024 |        32 |            8 |       128 |         512 |          512 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.820 s | 0.75% |  2.820 s | 0.75% | 363.129 |   7.437 MB/s |  0.00% |      6x |   2.828 s |
|        1 |    2048 |        32 |            8 |       128 |         512 |          512 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.821 s | 1.06% |  2.821 s | 1.06% | 725.997 |  14.868 MB/s |  0.00% |      6x |   2.860 s |
|        1 |    4096 |        32 |            8 |       128 |         512 |          512 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.826 s | 1.46% |  2.826 s | 1.46% |  1.449K |  29.679 MB/s |  0.00% |      6x |   2.849 s |
|        1 |    8192 |        32 |            8 |       128 |         512 |          512 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.863 s | 1.00% |  2.863 s | 1.00% |  2.862K |  58.604 MB/s |  0.01% |      6x |   2.815 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-.ncu-rep
==PROF== Connected to process 55191 (/home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/build/flash_attention_benchmark_standard)
# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23771 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 0: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 1: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 2: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 3: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 4: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 5: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 6: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 7: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 8: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 9: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.62s) while over noise threshold (3.57% > 0.50%)
Warn: Current measurement timed out (16.62s) before accumulating min_samples (6 < 10)
Pass: Cold: 2770.133667ms GPU, 2770.171121ms CPU, 16.62s total GPU, 16.62s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 10: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 11: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 12: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 13: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 14: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 15: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 16: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.67s) before accumulating min_samples (6 < 10)
Pass: Batch: 2778.744222ms GPU, 16.67s total GPU, 16.67s total wall, 6x
Run:  [2/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 17: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 18: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 19: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 20: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 21: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 22: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 23: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 24: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 25: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 26: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.72s) while over noise threshold (1.04% > 0.50%)
Warn: Current measurement timed out (16.72s) before accumulating min_samples (6 < 10)
Pass: Cold: 2785.765299ms GPU, 2785.803400ms CPU, 16.71s total GPU, 16.72s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 27: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 28: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 29: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 30: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 31: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 32: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 33: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.20s) before accumulating min_samples (6 < 10)
Pass: Batch: 2866.706991ms GPU, 17.20s total GPU, 17.20s total wall, 6x
Run:  [3/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 34: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 35: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 36: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 37: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 38: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 39: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 40: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 41: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 42: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 43: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.87s) while over noise threshold (1.25% > 0.50%)
Warn: Current measurement timed out (16.87s) before accumulating min_samples (6 < 10)
Pass: Cold: 2810.820272ms GPU, 2810.858165ms CPU, 16.86s total GPU, 16.87s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 44: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 45: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 46: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 47: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 48: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 49: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 50: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.74s) before accumulating min_samples (6 < 10)
Pass: Batch: 2790.722575ms GPU, 16.74s total GPU, 16.74s total wall, 6x
Run:  [4/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 51: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 52: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 53: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 54: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 55: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 56: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 57: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 58: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 59: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 60: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.09s) while over noise threshold (1.21% > 0.50%)
Warn: Current measurement timed out (17.09s) before accumulating min_samples (6 < 10)
Pass: Cold: 2848.770060ms GPU, 2848.809904ms CPU, 17.09s total GPU, 17.09s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 61: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 62: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 63: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 64: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 65: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 66: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 67: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.98s) before accumulating min_samples (6 < 10)
Pass: Batch: 2829.895671ms GPU, 16.98s total GPU, 16.98s total wall, 6x
Run:  [5/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=0]
==PROF== Profiling "distribution_elementwise_grid..." - 68: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 69: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 70: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 71: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 72: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 73: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 74: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 75: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 76: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 77: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.39s) while over noise threshold (2.80% > 0.50%)
Warn: Current measurement timed out (17.39s) before accumulating min_samples (6 < 10)
Pass: Cold: 2897.767090ms GPU, 2897.807116ms CPU, 17.39s total GPU, 17.39s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 78: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 79: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 80: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 81: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 82: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 83: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 84: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.26s) before accumulating min_samples (6 < 10)
Pass: Batch: 2876.127767ms GPU, 17.26s total GPU, 17.26s total wall, 6x
Run:  [6/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 85: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 86: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 87: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 88: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 89: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 90: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 91: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 92: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 93: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 94: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.86s) while over noise threshold (1.28% > 0.50%)
Warn: Current measurement timed out (16.86s) before accumulating min_samples (6 < 10)
Pass: Cold: 2809.475342ms GPU, 2809.514761ms CPU, 16.86s total GPU, 16.86s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 95: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 96: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 97: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 98: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 99: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 100: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 101: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.81s) before accumulating min_samples (6 < 10)
Pass: Batch: 2800.876221ms GPU, 16.81s total GPU, 16.81s total wall, 6x
Run:  [7/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 102: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 103: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 104: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 105: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 106: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 107: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 108: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 109: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 110: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 111: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.00s) while over noise threshold (2.00% > 0.50%)
Warn: Current measurement timed out (17.00s) before accumulating min_samples (6 < 10)
Pass: Cold: 2833.175578ms GPU, 2833.214605ms CPU, 17.00s total GPU, 17.00s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 112: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 113: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 114: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 115: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 116: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 117: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 118: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (16.95s) before accumulating min_samples (6 < 10)
Pass: Batch: 2824.398356ms GPU, 16.95s total GPU, 16.95s total wall, 6x
Run:  [8/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 119: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 120: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 121: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 122: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 123: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 124: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 125: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 126: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 127: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 128: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.20s) while over noise threshold (2.90% > 0.50%)
Warn: Current measurement timed out (17.20s) before accumulating min_samples (6 < 10)
Pass: Cold: 2866.456421ms GPU, 2866.496648ms CPU, 17.20s total GPU, 17.20s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 129: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 130: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 131: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 132: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 133: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 134: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 135: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.04s) before accumulating min_samples (6 < 10)
Pass: Batch: 2839.296549ms GPU, 17.04s total GPU, 17.04s total wall, 6x
Run:  [9/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 136: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 137: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 138: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 139: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 140: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 141: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 142: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 143: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 144: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 145: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.13s) while over noise threshold (1.14% > 0.50%)
Warn: Current measurement timed out (17.13s) before accumulating min_samples (6 < 10)
Pass: Cold: 2854.266032ms GPU, 2854.305354ms CPU, 17.13s total GPU, 17.13s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 146: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 147: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 148: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 149: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 150: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 151: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 152: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.01s) before accumulating min_samples (6 < 10)
Pass: Batch: 2835.308390ms GPU, 17.01s total GPU, 17.01s total wall, 6x
Run:  [10/10] run_mha_fwd [Device=0 num_seqs=1 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 window_left=1024 window_right=1024 causal=1]
==PROF== Profiling "distribution_elementwise_grid..." - 153: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 154: 0%....50%....100% - 13 passes
==PROF== Profiling "distribution_elementwise_grid..." - 155: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 156: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 157: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 158: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 159: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 160: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 161: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 162: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.26s) while over noise threshold (1.86% > 0.50%)
Warn: Current measurement timed out (17.26s) before accumulating min_samples (6 < 10)
Pass: Cold: 2876.043945ms GPU, 2876.083503ms CPU, 17.26s total GPU, 17.26s total wall, 6x 
==PROF== Profiling "flash_fwd_kernel" - 163: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 164: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 165: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 166: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 167: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 168: 0%....50%....100% - 13 passes
==PROF== Profiling "flash_fwd_kernel" - 169: 0%....50%....100% - 13 passes
Warn: Current measurement timed out (17.19s) before accumulating min_samples (6 < 10)
Pass: Batch: 2864.760864ms GPU, 17.19s total GPU, 17.19s total wall, 6x
==PROF== Disconnected from process 55191
```

# Benchmark Results

## run_mha_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | window_left | window_right | causal |  Q Tensor  |  K Tensor  |  V Tensor  |   Output   | Tokens |  Est. FLOPS  | Memory Usage | Samples | CPU Time | Noise | GPU Time | Noise | Elem/s  | GlobalMem BW | BWUtil | Samples | Batch GPU |
|----------|---------|-----------|--------------|-----------|-------------|--------------|--------|------------|------------|------------|------------|--------|--------------|--------------|---------|----------|-------|----------|-------|---------|--------------|--------|---------|-----------|
|        1 |     512 |        32 |            8 |       128 |        1024 |         1024 |      0 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.770 s | 3.57% |  2.770 s | 3.57% | 184.829 |   3.785 MB/s |  0.00% |      6x |   2.779 s |
|        1 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      0 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.786 s | 1.04% |  2.786 s | 1.04% | 367.583 |   7.528 MB/s |  0.00% |      6x |   2.867 s |
|        1 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      0 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.811 s | 1.25% |  2.811 s | 1.25% | 728.613 |  14.922 MB/s |  0.00% |      6x |   2.791 s |
|        1 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      0 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.849 s | 1.21% |  2.849 s | 1.21% |  1.438K |  29.446 MB/s |  0.00% |      6x |   2.830 s |
|        1 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      0 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.898 s | 2.80% |  2.898 s | 2.80% |  2.827K |  57.897 MB/s |  0.01% |      6x |   2.876 s |
|        1 |     512 |        32 |            8 |       128 |        1024 |         1024 |      1 |  4.000 MiB |  1.000 MiB |  1.000 MiB |  4.000 MiB |    512 |   2147483648 |           10 |      6x |  2.810 s | 1.28% |  2.809 s | 1.28% | 182.240 |   3.732 MB/s |  0.00% |      6x |   2.801 s |
|        1 |    1024 |        32 |            8 |       128 |        1024 |         1024 |      1 |  8.000 MiB |  2.000 MiB |  2.000 MiB |  8.000 MiB |   1024 |   8589934592 |           20 |      6x |  2.833 s | 2.00% |  2.833 s | 2.00% | 361.432 |   7.402 MB/s |  0.00% |      6x |   2.824 s |
|        1 |    2048 |        32 |            8 |       128 |        1024 |         1024 |      1 | 16.000 MiB |  4.000 MiB |  4.000 MiB | 16.000 MiB |   2048 |  34359738368 |           40 |      6x |  2.866 s | 2.90% |  2.866 s | 2.90% | 714.471 |  14.632 MB/s |  0.00% |      6x |   2.839 s |
|        1 |    4096 |        32 |            8 |       128 |        1024 |         1024 |      1 | 32.000 MiB |  8.000 MiB |  8.000 MiB | 32.000 MiB |   4096 | 137438953472 |           80 |      6x |  2.854 s | 1.14% |  2.854 s | 1.14% |  1.435K |  29.390 MB/s |  0.00% |      6x |   2.835 s |
|        1 |    8192 |        32 |            8 |       128 |        1024 |         1024 |      1 | 64.000 MiB | 16.000 MiB | 16.000 MiB | 64.000 MiB |   8192 | 549755813888 |          160 |      6x |  2.876 s | 1.86% |  2.876 s | 1.86% |  2.848K |  58.334 MB/s |  0.01% |      6x |   2.865 s |
==PROF== Report: /home/accel-sim-framework/util/tracer_nvbit/applications/benchmark_flash_attention/./test_ncu_reports/standard/window-.ncu-rep
# Calculate total execution time
END_TIME=$(date +%s)
DURATION=$((END_TIME - START_TIME))

# Convert to hours, minutes, seconds
HOURS=$((DURATION / 3600))
MINUTES=$(( (DURATION % 3600) / 60 ))
SECONDS=$((DURATION % 60))

echo ""

echo "=================================================================="
==================================================================
echo "                       BENCHMARK SUMMARY                          "
                       BENCHMARK SUMMARY                          
echo "=================================================================="
==================================================================
echo "Start time: $(date -d @$START_TIME)"
Start time: Thu Mar  6 15:59:07 UTC 2025
echo "End time:   $(date -d @$END_TIME)"
End time:   Thu Mar  6 16:23:58 UTC 2025

echo "----------------------------------------------------------------"
----------------------------------------------------------------
echo "Total execution time: $HOURS hours, $MINUTES minutes, $SECONDS seconds"
Total execution time: 0 hours, 24 minutes, 51 seconds
echo "                    = $DURATION seconds"
                    = 1491 seconds

----------------------"
echo "GPU used: CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES"
echo "NCU path: $ncu_path"
echo "All profiling data saved to: ./ncu_reports/"
./test2.sh: line 132: unexpected EOF while looking for matching `"'
