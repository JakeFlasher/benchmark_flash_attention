# Devices

## [0] `NVIDIA A30`
* SM Version: 800 (PTX Version: 800)
* Number of SMs: 56
* SM Default Clock Rate: 1440 MHz
* Global Memory: 23805 MiB Free / 24060 MiB Total
* Global Memory Bus Peak: 933 GB/sec (3072-bit DDR @1215MHz)
* Max Shared Memory: 164 KiB/SM, 48 KiB/Block
* L2 Cache Size: 24576 KiB
* Maximum Active Blocks: 32/SM
* Maximum Active Threads: 2048/SM, 1024/Block
* Available Registers: 65536/SM, 65536/Block
* ECC Enabled: Yes

# Log

```
Run:  [1/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.047083ms GPU, 0.054905ms CPU, 0.50s total GPU, 1.08s total wall, 10624x 
Run:  [2/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=64 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.050766ms GPU, 0.058317ms CPU, 0.50s total GPU, 1.01s total wall, 9856x 
Run:  [3/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=128 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.070194ms GPU, 0.077805ms CPU, 0.53s total GPU, 0.92s total wall, 7568x 
Run:  [4/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=256 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.112256ms GPU, 0.120978ms CPU, 0.50s total GPU, 0.73s total wall, 4464x 
Run:  [5/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=512 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.190933ms GPU, 0.202639ms CPU, 0.50s total GPU, 0.64s total wall, 2624x 
Run:  [6/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=1024 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.344139ms GPU, 0.354131ms CPU, 0.50s total GPU, 0.57s total wall, 1453x 
Run:  [7/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=2048 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 0.647459ms GPU, 0.668905ms CPU, 0.50s total GPU, 0.55s total wall, 773x 
Run:  [8/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=4096 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 1.257341ms GPU, 1.265364ms CPU, 0.50s total GPU, 0.52s total wall, 398x 
Run:  [9/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=8192 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 2.479535ms GPU, 2.486453ms CPU, 0.50s total GPU, 0.51s total wall, 202x 
Run:  [10/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=16384 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Pass: Cold: 4.925570ms GPU, 5.030266ms CPU, 0.50s total GPU, 0.52s total wall, 102x 
Run:  [11/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=32768 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
Run:  [12/12] run_mha_varlen_fwd [Device=0 num_seqs=64 seq_len=65536 num_heads=32 num_kv_heads=8 head_size=128 page_size=256]
Skip: seq_len too long to fit into the benchmark preset
```

# Benchmark Results

## run_mha_varlen_fwd

### [0] NVIDIA A30

| num_seqs | seq_len | num_heads | num_kv_heads | head_size | page_size |    Read     |    Write    | Samples |  CPU Time  |  Noise  |  GPU Time  | Noise  | GlobalMem BW | BWUtil |
|----------|---------|-----------|--------------|-----------|-----------|-------------|-------------|---------|------------|---------|------------|--------|--------------|--------|
|       64 |      32 |        32 |            8 |       128 |       256 |   8.500 MiB | 512.000 KiB |  10624x |  54.905 us |  97.99% |  47.083 us | 11.91% | 200.438 GB/s | 21.48% |
|       64 |      64 |        32 |            8 |       128 |       256 |  16.500 MiB | 512.000 KiB |   9856x |  58.317 us |  89.61% |  50.766 us |  4.79% | 351.139 GB/s | 37.63% |
|       64 |     128 |        32 |            8 |       128 |       256 |  32.500 MiB | 512.000 KiB |   7568x |  77.805 us |  57.80% |  70.194 us |  1.21% | 492.959 GB/s | 52.83% |
|       64 |     256 |        32 |            8 |       128 |       256 |  64.500 MiB | 512.000 KiB |   4464x | 120.978 us | 116.03% | 112.256 us |  1.59% | 607.161 GB/s | 65.07% |
|       64 |     512 |        32 |            8 |       128 |       256 | 128.500 MiB | 512.000 KiB |   2624x | 202.639 us |  95.40% | 190.933 us |  0.80% | 708.449 GB/s | 75.92% |
|       64 |    1024 |        32 |            8 |       128 |       256 | 256.500 MiB | 512.000 KiB |   1453x | 354.131 us |  19.53% | 344.139 us |  0.49% | 783.068 GB/s | 83.92% |
|       64 |    2048 |        32 |            8 |       128 |       256 | 512.500 MiB | 512.000 KiB |    773x | 668.905 us |  50.93% | 647.459 us |  0.37% | 830.816 GB/s | 89.04% |
|       64 |    4096 |        32 |            8 |       128 |       256 |   1.000 GiB | 512.000 KiB |    398x |   1.265 ms |   2.23% |   1.257 ms |  0.24% | 854.812 GB/s | 91.61% |
|       64 |    8192 |        32 |            8 |       128 |       256 |   2.000 GiB | 512.000 KiB |    202x |   2.486 ms |   0.33% |   2.480 ms |  0.18% | 866.506 GB/s | 92.86% |
|       64 |   16384 |        32 |            8 |       128 |       256 |   4.000 GiB | 512.000 KiB |    102x |   5.030 ms |  18.56% |   4.926 ms |  0.15% | 872.186 GB/s | 93.47% |
